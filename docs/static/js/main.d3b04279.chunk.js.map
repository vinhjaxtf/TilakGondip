{"version":3,"sources":["i18n.tsx","store/reducers/book.tsx","utils/otherUtil.tsx","store/reducers/manager.tsx","store/reducers/progressPanel.tsx","store/reducers/reader.tsx","store/reducers/viewArea.tsx","store/reducers/sidebar.tsx","store/reducers/backupPage.tsx","store/index.tsx","utils/readUtils/addTrash.tsx","store/actions/manager.tsx","store/actions/reader.tsx","store/actions/sidebar.tsx","constants/sideMenu.tsx","containers/sidebar/component.tsx","containers/sidebar/index.tsx","store/actions/backupPage.tsx","components/searchBox/component.tsx","components/searchBox/index.tsx","store/actions/book.tsx","model/Book.ts","utils/readUtils/recordRecent.tsx","constants/driveList.tsx","utils/mobiUtil.tsx","utils/bookUtil.tsx","utils/syncUtils/restoreUtil.tsx","utils/syncUtils/dropbox.tsx","utils/syncUtils/webdav.tsx","utils/syncUtils/common.tsx","utils/syncUtils/backupUtil.tsx","components/importLocal/component.tsx","components/importLocal/index.tsx","components/updateInfo/component.tsx","components/updateInfo/index.tsx","containers/header/component.tsx","containers/header/index.tsx","utils/readUtils/deleteUtil.tsx","utils/readUtils/shelfUtil.tsx","utils/readUtils/recordLocation.tsx","utils/readUtils/addFavorite.tsx","containers/deleteDialog/component.tsx","containers/deleteDialog/index.tsx","containers/editDialog/component.tsx","containers/editDialog/index.tsx","containers/addDialog/component.tsx","containers/addDialog/index.tsx","containers/sortDialog/component.tsx","containers/sortDialog/index.tsx","containers/messageBox/component.tsx","containers/messageBox/index.tsx","components/tokenDialog/component.tsx","components/tokenDialog/index.tsx","containers/backupDialog/component.tsx","containers/backupDialog/index.tsx","components/settingDialog/component.tsx","components/settingDialog/index.tsx","containers/actionDialog/component.tsx","containers/actionDialog/index.tsx","components/emptyCover/index.tsx","components/bookCardtem/component.tsx","components/bookCardtem/index.tsx","components/bookListItem/component.tsx","components/bookListItem/index.tsx","components/bookCoverItem/component.tsx","components/bookCoverItem/index.tsx","utils/readUtils/readingTime.tsx","utils/readUtils/sortUtil.tsx","components/deletePopup/component.tsx","components/deletePopup/index.tsx","constants/emptyList.tsx","containers/emptyPage/component.tsx","containers/emptyPage/index.tsx","components/viewMode/component.tsx","components/viewMode/index.tsx","containers/bookList/component.tsx","containers/bookList/index.tsx","containers/deletedBookList/component.tsx","containers/deletedBookList/index.tsx","store/actions/viewArea.tsx","utils/readUtils/tagUtil.tsx","components/deleteIcon/component.tsx","components/deleteIcon/index.tsx","components/cardList/component.tsx","components/cardList/index.tsx","components/noteTag/component.tsx","components/noteTag/index.tsx","containers/noteList/component.tsx","containers/noteList/index.tsx","containers/digestList/component.tsx","containers/digestList/index.tsx","containers/loadingPage/component.tsx","containers/loadingPage/index.tsx","router/routes.tsx","components/arrow/index.tsx","components/loadingDialog/index.tsx","components/downloadDesk/component.tsx","components/downloadDesk/index.tsx","pages/manager/component.tsx","pages/manager/index.tsx","store/actions/progressPanel.tsx","model/Note.ts","components/popupNote/component.tsx","components/popupNote/index.tsx","components/colorOption/component.tsx","components/colorOption/index.tsx","components/popupOption/component.tsx","components/popupOption/index.tsx","components/popupTrans/component.tsx","components/popupTrans/index.tsx","containers/popupMenu/component.tsx","containers/popupMenu/index.tsx","utils/readUtils/styleUtil.tsx","components/imageViewer/component.tsx","components/imageViewer/index.tsx","containers/viewArea/component.tsx","containers/viewArea/index.tsx","containers/background/component.tsx","containers/background/index.tsx","constants/themeList.tsx","components/themeList/component.tsx","components/themeList/index.tsx","components/sliderList/component.tsx","components/sliderList/index.tsx","constants/dropdownList.tsx","components/dropdownList/component.tsx","components/dropdownList/index.tsx","components/modeControl/component.tsx","components/modeControl/index.tsx","containers/settingPanel/component.tsx","containers/settingPanel/index.tsx","components/contentList/component.tsx","components/contentList/index.tsx","components/navList/component.tsx","components/navList/index.tsx","containers/navigationPanel/component.tsx","containers/navigationPanel/index.tsx","model/Bookmark.ts","containers/operationPanel/component.tsx","containers/operationPanel/index.tsx","containers/progressPanel/component.tsx","containers/progressPanel/index.tsx","utils/mouseEvent.tsx","containers/epubViewer/component.tsx","containers/epubViewer/index.tsx","pages/epubReader/component.tsx","pages/epubReader/index.tsx","pages/redirect/component.tsx","pages/redirect/index.tsx","router/index.tsx","serviceWorker.ts","index.tsx"],"names":["resources","en","translation","zh","cht","i18n","use","reactI18nextModule","init","lng","fallbackLng","keySeparator","interpolation","escapeValue","initState","isOpenEditDialog","isOpenDeleteDialog","isOpenAddDialog","isOpenActionDialog","isReading","dragItem","currentBook","currentEpub","OtherUtil","list","keyWord","arr","i","length","match","push","arr1","arr2","_arr","flag","j","books","keyword","document","querySelector","value","bookNameArr","AuthorNameArr","forEach","item","name","toLowerCase","author","bookResults","this","fuzzyQuery","authorResults","MergeArray","event","keyCode","target","notes","noteArr","textArr","text","noteResults","textResults","sortCode","orderCode","json","localStorage","getItem","JSON","stringify","sort","order","obj","parse","setItem","key","readerConfig","deletedBooks","searchResults","isSearch","isBookSort","isNoteSort","isSettingOpen","viewMode","isSortDisplay","isShowLoading","isDownloadDesk","isShowNew","bookSortCode","noteSortCode","getNoteSortCode","isMessage","message","percentage","locations","bookmarks","digests","chapters","currentChapter","flattenChapters","color","noteKey","originalText","readerMode","getReaderConfig","selection","isOpenMenu","menuMode","isChangeDirection","isShowBookmark","mode","shelfIndex","isDragToLove","isDragToDelete","isBackup","isOpenTokenDialog","rootReducer","combineReducers","book","state","action","type","payload","isRedirect","manager","reader","section","progressPanel","viewArea","isOpenHighlight","dialogLocation","sidebar","backupPage","store","createStore","compose","applyMiddleware","thunk","window","devToolsExtension","f","AddTrash","bookKey","bookArr","index","indexOf","splice","unshift","handleBooks","handleDeletedBooks","handleSearchResults","handleSearch","handleDownloadDesk","handleSetting","handleMessage","handleMessageBox","isShow","handleSortDisplay","handleLoadingDialog","handleBookSortCode","handleFetchBooks","isTrash","dispatch","localforage","err","a","keyArr","getAllTrash","handleKeyFilter","handleKeyRemove","handleFetchList","items","itemArr","handleBookmarks","handleNoteKey","handleFetchNotes","filter","handleFetchBookmarks","bookmarkArr","handleShelfIndex","handleMode","handleDragToLove","handleDragToDelete","sideMenu","icon","isElectron","require","Sidebar","props","handleSidebar","setState","history","handleHover","hoverIndex","URL","split","reverse","className","src","alt","map","id","onClick","onDrop","onMouseEnter","onMouseLeave","style","opacity","display","open","React","Component","withRouter","actionCreator","connect","withNamespaces","handleBackupDialog","handleTokenDialog","SearchBox","handleMouse","refs","searchBox","isNavSearch","search","handleSearchState","results","tabMode","MouseNoteSearch","MouseSearch","handleKey","KeyNoteSearch","KeySearch","q","doSearch","then","result","searchList","excerpt","replace","handleSearchList","Promise","all","spine","spineItems","load","bind","find","finally","unload","resolve","concat","apply","handleCancel","focus","position","ref","onKeyDown","onFocus","placeholder","t","width","height","paddingRight","right","handleEditDialog","handleDeleteDialog","handleAddDialog","handleActionDialog","handleReadingState","handleReadingBook","handleReadingEpub","epub","handleDragItem","Book","description","md5","cover","format","publisher","RecordRecent","config","callback_url","token_url","dropbox_client_id","googledrive_client_id","onedrive_client_id","driveList","url","ab2str","buf","ArrayBuffer","Uint8Array","TextDecoder","decode","domParser","DOMParser","Buffer","capacity","fragment_list","imageArray","cur_fragment","Fragment","byte","write","idx","fi","frag","size","get","s","total_buffer","offset","full","set","buffer","slice","MobiFile","data","view","header","palm_header","mobi_header","reclist","render_image","imgDoms","reject","imgDom","getAttribute","blob","read_image","imgReader","FileReader","onload","e","onerror","readAsDataURL","DataView","v","getUint8","getUint16","getUint32","_of","flags","pos","extra","res","buffer_get_varlen","l","byte_count","shift","text_end","record_count","buffers","read_text_record","total_size","copagesne_uint8array","extra_flags","begin","end","ex","get_record_extrasize","compression","char","next","distance","lz_length","buffer_size","uncompression_lz77","shrink","first_image_idx","Blob","load_pdbheader","load_reclist","load_record0","getStr","attr","version","ctime","mtime","btime","mod_num","appinfo_offset","sortinfo_offset","creator","uid","next_rec","record_num","record","load_record0_header","load_mobi_header","p_header","first_record","setoffset","skip","text_length","record_size","encryption_type","start_offset","identifier","header_length","mobi_type","text_encoding","generator_version","first_nonbook_index","full_name_offset","full_name_length","language","input_language","output_language","min_version","huff_rec_index","huff_rec_count","datp_rec_index","datp_rec_count","exth_flags","drm_offset","drm_count","drm_size","drm_flags","span","createElement","innerHTML","textContent","innerText","content","read_text","bookDoc","parseFromString","documentElement","lines","Array","from","querySelectorAll","parseContent","len","tagName","getElementsByTagName","join","handleImage","BookUtil","formData","FormData","append","ipcRenderer","sendSync","axios","post","headers","responseType","response","console","log","catch","error","dataPath","removeItem","fs","path","readFileSync","blobTemp","File","lastModified","Date","getTime","fetchBook","arrayBuffer","location","href","JSZip","RestoreUtil","restore","file","handleFinish","isSync","configArr","zip","mobileObject","loadAsync","files","async","addBook","setTimeout","Dropbox","DropboxUitl","showMessage","ACCESS_TOKEN","year","getFullYear","month","getMonth","day","getDate","dbx","accessToken","filesUpload","contents","filesDownload","fileBlob","lastModifiedDate","WebdavUitl","username","password","fileTemp","UploadFile","getParamsFromUrl","hashParams","r","hash","substring","exec","decodeURIComponent","moveData","driveIndex","deleteBooks","SyncUtil","oldPath","newPath","BackupUtil","backup","bookZip","folder","generateAsync","FileSaver","saveAs","DropboxUtil","WebdavUtil","pdfjsLib","ImportLocal","handleJump","RecentBooks","setRecent","RedirectBook","handleAddBook","isOpenFile","doIncrementalTest","extension","blobSlice","prototype","mozSlice","webkitSlice","chunks","Math","ceil","currentChunk","spark","SparkMD5","fileReader","Error","appendBinary","loadNext","handleBook","start","readAsBinaryString","call","bookName","substr","isRepeat","readAsArrayBuffer","getDocument","promise","pdfDoc_","pdfDoc","getMetadata","metadata","getPage","page","viewport","getViewport","scale","canvas","getElementById","context","getContext","viewBox","render","canvasContext","toDataURL","info","Title","Author","BookModel","file_content","mobiFile","iconv","encode","ePub","loaded","coverUrl","fetch","onloadend","title","setReaderConfig","filePath","body","getReader","ReadableStream","controller","pump","read","done","enqueue","close","stream","Response","acceptedFiles","handleDrag","accept","multiple","getRootProps","getInputProps","newOptions","loop","autoplay","animationData","animationNew","rendererSettings","preserveAspectRatio","successOptions","animationSuccess","UpdateInfo","renderList","shell","openExternal","isUpdated","handleClose","updateLog","handleNewDialog","navigator","newVersion","top","options","marginTop","marginBottom","copy","new","fix","Header","handleSortBooks","isOnlyLocal","isNewVersion","storageLocation","sourcePath","outPath","DeleteUtil","defaultShelf","New","Study","Work","Entertainment","ShelfUtil","shelfTitle","undefined","currentShelfTitle","Object","keys","RecordLocation","cfi","AddFavorite","DeleteDialog","handleDeleteOther","deleteBookmarks","deleteNotes","handleComfirm","clearShelf","deleteBook","setTrash","clear","deletefromAllShelf","EditDialog","isCheck","nameBox","authorBox","AddDialog","inputElement","shelfList","getShelf","shelfTitles","isNew","hasOwnProperty","setShelf","handleChange","onChange","renderShelfList","disabled","SortDialog","handleSort","code","isNote","handleNoteSortCode","handleNoteSort","setNoteSortCode","handleBookSort","setBookSortCode","handleOrder","boxShadow","MessageBox","TokenDialog","handleTokenComfirm","token","driveName","handleDavComfirm","fontSize","BackupDialog","currentStep","handleRestoreToLocal","preventDefault","handleDrive","currentDrive","DownloadFile","dialogProps","marginLeft","SettingDialog","changeLanguage","handleChangeTouch","isTouch","handleExpandContent","isExpandContent","handleAutoSync","isAutoSync","handleChangeOpen","isOpenBook","handleChangeLocation","dialog","remote","showOpenDialog","properties","filePaths","changeLocation","getElementsByClassName","children","setAttribute","background","float","transform","transition","ActionDialog","handleDeleteBook","handleEditBook","handleAddShelf","handleResoreBook","left","minHeight","overflow","parseInt","toLocaleString","Parser","emptyCover","backgroundColor","BookCardItem","handleMoreAction","x","clientX","clientWidth","clientHeight","clientY","handleLoveBook","setFavorite","isFavorite","handleCancelLoveBook","handleConfig","isOpenConfig","getAllFavorite","getAllRecent","nextProps","getCfi","actionProps","onMouseOver","onDragStart","onDragEnd","floor","BookListItem","isDeleteDialog","round","BookItem","BookCoverItem","bottom","ReadingTime","time","getBookName","getAuthorName","getBookKey","getBookIndex","nameArr","oldNameArr","indexArr","SortUtil","durationKeys","durationObj","getAllTime","sortable","b","getDurationArr","bookKeys","_","union","oldAuthorArr","authorArr","percentagenKeys","locationObj","getAllCfi","getPercentageArr","clone","dateArr","uniq","date","noteObj","note","findLastIndex","DeletePopup","handleDeletePopup","handleDeleteOpearion","emptyList","main","sub","EmptyPage","visibility","ViewMode","handleClick","bool","isClicked","BookList","subItem","handleIndexFilter","renderBookList","handleShelf","sortBooks","zIndex","handleShelfItem","handleDeleteShelf","removeShelf","toString","selected","isOpenDelete","favoriteBooks","to","currentShelfList","BackUtil","deletePopupProps","handleOpenMenu","handleMenuMode","handleChangeDirection","handleShowBookmark","handleSelection","TagUtil","tagArr","DeleteIcon","handleDelete","deleteItems","getAllTags","deleteFunc","itemKey","handleChangeTag","deleteIndex","CardList","handleBookName","handleShowDelete","deleteKey","recordCfi","cards","sortNotes","cardProps","chapter","NoteTag","tagToIndex","tag","temp","indextoTag","tagIndex","indexResult","handleTag","handleAddTag","isInput","setTags","handleInput","onBlur","NoteList","handleFilter","filterTag","noteProps","DigestList","LoadingPage","routes","component","DeletedBookList","Arrow","xmlns","fill","stroke","strokeWidth","cx","cy","y2","strokeLinecap","d","defaultOptions","LoadingDialog","downloadOptions","DownloadDesk","Manager","timer","isDrag","totalBooks","isAuthed","isError","isCopied","handleFetchBookSortCode","clearTimeout","isMobileOnly","onDragEnter","ele","getBookSortCode","handlePercentage","Note","chapterIndex","range","PopupNote","noteIndex","textArea","currentLocation","rendition","chapterHref","label","trim","iframe","doc","contentDocument","charRange","rangy","getSelection","saveCharacterRanges","createNote","ColorOption","handleChangeOptiion","isLine","border","handleColor","borderBottom","About","PopupOption","handleNote","posY","rect","_layout","y","posX","rightEdge","popupMenu","handleCopy","execCommand","empty","handleTrans","sel","handleOriginalText","handleDigest","digest","PopupTrans","translatedText","script","head","appendChild","handleCallback","trans_result","dst","PopupMenu","highlighter","showNote","isFirstShow","cfiRange","getHighlighter","createHighlighter","ignoreWhiteSpace","elementTagName","elementProperties","onclick","getRangeAt","getBoundingClientRect","showMenu","handleClickHighlighter","currentTarget","dataset","stopPropagation","onElementCreate","element","applier","createClassApplier","addClassApplier","isMobile","renderHighlighters","highlighters","highlightersByChapter","iWin","contentWindow","defaultView","removeAllHighlights","classes","restoreCharacterRanges","warn","highlightSelection","openMenu","isCollapsed","on","addEventListener","handleHighlight","PopupProps","styleUtil","css","getDefaultCss","colors","ImageViewer","showImage","handleLeaveReader","parentNode","showMessageBox","buttons","isShowImage","zoomIndex","rotateIndex","imageRatio","img","Image","direction","naturalWidth","naturalHeight","image","hideImage","handleZoomIn","handleZoomOut","handleSave","toLocaleDateString","handleClock","handleCounterClock","StyleUtil","addDefaultCss","ViewArea","isFirst","loading","percentageFromCfi","themes","default","popupMenuProps","handleEnterReader","Background","isSingle","prevPage","nextPage","isShowFooter","isShowHeader","isUseBackground","handleFetchLocations","displayed","i18nKey","count","parseFloat","startsWith","generate","backgroundList","theme","textList","ThemeList","handleChangeBgColor","currentBackgroundIndex","handleChooseBgColor","handleColorTextPicker","isShowTextPicker","handleColorBgPicker","isShowBgPicker","handleChooseTextColor","currentTextIndex","findIndex","textAlign","lineHeight","enableAlpha","margin","animation","SliderList","onValueChange","onValueInput","defaultValue","max","maxValue","min","minValue","step","onInput","onMouseUp","reload","dropdownList","option","appVersion","DropdownList","currentFontFamilyIndex","currentLineHeightIndex","handleView","ModeControl","handleChangeMode","SettingPanel","handleChangeAudio","isAudioOn","speechSynthesis","cancel","handleAudio","handleBold","isBold","cfibase","cfistart","cfiend","getRange","msg","SpeechSynthesisUtterance","speak","onend","elapsedTime","handleChangeBackground","handleFooter","handleHeader","handleLock","isSettingLocked","isSupported","ContentList","currentIndex","navigation","toc","renderContentList","level","subitems","NavList","currentData","currentTab","bookmarkProps","cursor","NavigationPanel","handleChangeTab","isNavLocked","renderSearchList","renderSearchPage","startIndex","pageList","total","searchProps","Bookmark","OperationPanel","timeStamp","speed","isFullScreen","isBookmark","currentPercentage","timeLeft","now","handleExitFullScreen","handleFullScreen","de","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","setInterval","screenTop","fullscreenElement","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","bookmark","setTime","abs","handleExit","handleAddBookmark","handleScreen","ProgressPanel","onProgressChange","cfiFromPercentage","onProgressInput","displayPercentage","previourChapter","currentChapterIndex","nextChapter","handleJumpChapter","handleJumpPage","currentPage","totalPage","onTouchEnd","Hammer","MouseEvent","isFirefox","userAgent","lock","arrowKeys","prev","mouseFirefox","detail","mouseChrome","wheelDelta","gesture","bindEvent","Reader","messageTimer","tickTimer","isOpenNavPanel","isOpenOperationPanel","isOpenProgressPanel","isOpenSettingPanel","handleFetchPercentage","handleFetchChapters","renderTo","flow","snap","spread","clearInterval","renditionProps","handleChapters","flatChapter","newChapter","EpubReader","Redirect","alert","params","access_token","mobileData","ReactNativeWebView","postMessage","hot","useEffect","_Redirect","Boolean","hostname","ReactDOM","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.d3b04279.chunk.js","sourcesContent":["import i18n from \"i18next\";\nimport { reactI18nextModule } from \"react-i18next\";\nimport translationEN from \"./assets/locales/en/translation.json\";\nimport translationCN from \"./assets/locales/cn/translation.json\";\nimport translationTW from \"./assets/locales/tw/translation.json\";\n\n// the translations\nconst resources = {\n  en: {\n    translation: translationEN,\n  },\n  zh: {\n    translation: translationCN,\n  },\n  cht: {\n    translation: translationTW,\n  },\n};\n\ni18n\n  .use(reactI18nextModule as any) // passes i18n down to react-i18next\n  .init({\n    resources,\n    lng: \"zh\",\n    fallbackLng: \"en\",\n    keySeparator: false, // we do not use keys in form messages.welcome\n    interpolation: {\n      escapeValue: false, // react already safes from xss\n    },\n  });\n\nexport default i18n;\n","const initState = {\r\n  isOpenEditDialog: false,\r\n  isOpenDeleteDialog: false,\r\n  isOpenAddDialog: false,\r\n  isOpenActionDialog: false,\r\n  isReading: false,\r\n  dragItem: \"\",\r\n  currentBook: {},\r\n  currentEpub: {},\r\n};\r\nexport function book(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_EDIT_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenEditDialog: action.payload,\r\n      };\r\n    case \"HANDLE_DELETE_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenDeleteDialog: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_ADD_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenAddDialog: action.payload,\r\n      };\r\n    case \"HANDLE_ACTION_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenActionDialog: action.payload,\r\n      };\r\n    case \"HANDLE_READING_STATE\":\r\n      return {\r\n        ...state,\r\n        isReading: action.payload,\r\n      };\r\n    case \"HANDLE_READING_BOOK\":\r\n      return {\r\n        ...state,\r\n        currentBook: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_READING_EPUB\":\r\n      return {\r\n        ...state,\r\n        currentEpub: action.payload,\r\n      };\r\n    case \"HANDLE_DRAG_ITEM\":\r\n      return {\r\n        ...state,\r\n        dragItem: action.payload,\r\n      };\r\n    case \"HANDLE_REDIRECT\":\r\n      return {\r\n        ...state,\r\n        isRedirect: true,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import BookModel from \"../model/Book\";\nimport NoteModel from \"../model/Note\";\n\nclass OtherUtil {\n  static fuzzyQuery(list: string[], keyWord: string) {\n    var arr: number[] = [];\n    for (var i = 0; i < list.length; i++) {\n      if (list[i].match(keyWord) != null) {\n        arr.push(i);\n      }\n    }\n    return arr;\n  }\n  static MergeArray(arr1: number[], arr2: number[]) {\n    var _arr: number[] = [];\n    for (let i = 0; i < arr1.length; i++) {\n      _arr.push(arr1[i]);\n    }\n    for (let i = 0; i < arr2.length; i++) {\n      var flag = true;\n      for (let j = 0; j < arr1.length; j++) {\n        if (arr2[i] === arr1[j]) {\n          flag = false;\n          break;\n        }\n      }\n      if (flag) {\n        _arr.push(arr2[i]);\n      }\n    }\n    return _arr;\n  }\n  static MouseSearch(books: BookModel[]) {\n    let keyword = (document.querySelector(\n      \".header-search-box\"\n    ) as HTMLInputElement).value;\n    let bookNameArr: string[] = [];\n    let AuthorNameArr: string[] = [];\n    if (!books) return [];\n    books.forEach((item) => {\n      bookNameArr.push(item.name.toLowerCase());\n      AuthorNameArr.push(item.author.toLowerCase());\n    });\n    let bookResults = this.fuzzyQuery(bookNameArr, keyword);\n    let authorResults = this.fuzzyQuery(AuthorNameArr, keyword);\n    let results = this.MergeArray(bookResults, authorResults);\n    return results;\n  }\n  static KeySearch(event: any, books: BookModel[]) {\n    if (event && event.keyCode === 13) {\n      let bookNameArr: string[] = [];\n      let AuthorNameArr: string[] = [];\n      if (!books) return [];\n\n      books.forEach((item) => {\n        bookNameArr.push(item.name.toLowerCase());\n        AuthorNameArr.push(item.author.toLowerCase());\n      });\n      let bookResults = this.fuzzyQuery(bookNameArr, event.target.value);\n      let authorResults = this.fuzzyQuery(AuthorNameArr, event.target.value);\n      let results = this.MergeArray(bookResults, authorResults);\n      return results;\n    }\n  }\n  static MouseNoteSearch(notes: NoteModel[]) {\n    let keyword = (document.querySelector(\n      \".header-search-box\"\n    ) as HTMLInputElement).value;\n    let noteArr: string[] = [];\n    let textArr: string[] = [];\n    notes.forEach((item: NoteModel) => {\n      noteArr.push(item.notes.toLowerCase());\n      textArr.push(item.text.toLowerCase());\n    });\n    let noteResults = this.fuzzyQuery(noteArr, keyword);\n    let textResults = this.fuzzyQuery(textArr, keyword);\n    let results = this.MergeArray(noteResults, textResults);\n    return results;\n  }\n  static KeyNoteSearch(event: any, notes: NoteModel[]) {\n    if (event && event.keyCode === 13) {\n      let noteArr: string[] = [];\n      let textArr: string[] = [];\n      notes.forEach((item: NoteModel) => {\n        noteArr.push(item.notes.toLowerCase());\n        textArr.push(item.text.toLowerCase());\n      });\n      let noteResults = this.fuzzyQuery(noteArr, event.target.value);\n      let textResults = this.fuzzyQuery(textArr, event.target.value);\n      let results = this.MergeArray(noteResults, textResults);\n      return results;\n    }\n  }\n  static setBookSortCode(sortCode: number, orderCode: number) {\n    let json =\n      localStorage.getItem(\"bookSortCode\") ||\n      JSON.stringify({ sort: 0, order: 1 });\n    let obj = json ? JSON.parse(json) : { sort: 0, order: 1 };\n    obj.sort = sortCode;\n    obj.order = orderCode;\n    localStorage.setItem(\"bookSortCode\", JSON.stringify(obj));\n  }\n\n  static getBookSortCode() {\n    let json =\n      localStorage.getItem(\"bookSortCode\") ||\n      JSON.stringify({ sort: 0, order: 1 });\n    let obj = JSON.parse(json) || { sort: 0, order: 1 };\n    return obj || null;\n  }\n  static setNoteSortCode(sort: number, order: number) {\n    let json =\n      localStorage.getItem(\"noteSortCode\") ||\n      JSON.stringify({ sort: 2, order: 2 });\n    let obj = json ? JSON.parse(json) : { sort: 2, order: 2 };\n    obj.sort = sort;\n    obj.order = order;\n    localStorage.setItem(\"noteSortCode\", JSON.stringify(obj));\n  }\n\n  static getNoteSortCode() {\n    let json =\n      localStorage.getItem(\"noteSortCode\") ||\n      JSON.stringify({ sort: 2, order: 2 });\n    let obj = JSON.parse(json) || { sort: 2, order: 2 };\n    return obj || null;\n  }\n  static getReaderConfig(key: string) {\n    let readerConfig = JSON.parse(localStorage.getItem(\"readerConfig\")!) || {};\n    return readerConfig[key];\n  }\n  static setReaderConfig(key: string, value: string) {\n    let readerConfig = JSON.parse(localStorage.getItem(\"readerConfig\")!) || {};\n    readerConfig[key] = value;\n    localStorage.setItem(\"readerConfig\", JSON.stringify(readerConfig));\n  }\n}\n\nexport default OtherUtil;\n","import OtherUtil from \"../../utils/otherUtil\";\r\nconst initState = {\r\n  books: null,\r\n  deletedBooks: [],\r\n  searchResults: [],\r\n  isSearch: false,\r\n  isBookSort: false,\r\n  isNoteSort: false,\r\n  isSettingOpen: false,\r\n  viewMode: \"card\",\r\n  isSortDisplay: false,\r\n  isShowLoading: false,\r\n  isDownloadDesk: false,\r\n  isShowNew: false,\r\n  bookSortCode: { sort: 0, order: 1 },\r\n  noteSortCode: OtherUtil.getNoteSortCode(),\r\n  isMessage: false,\r\n  message: \"Add Successfully\",\r\n};\r\nexport function manager(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_BOOKS\":\r\n      return {\r\n        ...state,\r\n        books: action.payload,\r\n      };\r\n    case \"HANDLE_DELETED_BOOKS\":\r\n      return {\r\n        ...state,\r\n        deletedBooks: action.payload,\r\n      };\r\n    case \"HANDLE_SEARCH_BOOKS\":\r\n      return {\r\n        ...state,\r\n        searchResults: action.payload,\r\n      };\r\n    case \"HANDLE_DOWNLOAD_DESK\":\r\n      return {\r\n        ...state,\r\n        isDownloadDesk: action.payload,\r\n      };\r\n    case \"HANDLE_SEARCH\":\r\n      return {\r\n        ...state,\r\n        isSearch: action.payload,\r\n      };\r\n    case \"HANDLE_SETTING\":\r\n      return {\r\n        ...state,\r\n        isSettingOpen: action.payload,\r\n      };\r\n    case \"HANDLE_BOOK_SORT\":\r\n      return {\r\n        ...state,\r\n        isBookSort: action.payload,\r\n      };\r\n    case \"HANDLE_NOTE_SORT\":\r\n      return {\r\n        ...state,\r\n        isNoteSort: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_VIEW_MODE\":\r\n      return {\r\n        ...state,\r\n        viewMode: action.payload,\r\n      };\r\n    case \"HANDLE_SORT_DISPLAY\":\r\n      return {\r\n        ...state,\r\n        isSortDisplay: action.payload,\r\n      };\r\n    case \"HANDLE_SHOW_LOADING\":\r\n      return {\r\n        ...state,\r\n        isShowLoading: action.payload,\r\n      };\r\n    case \"HANDLE_SHOW_NEW\":\r\n      return {\r\n        ...state,\r\n        isShowNew: action.payload,\r\n      };\r\n    case \"HANDLE_MESSAGE\":\r\n      return {\r\n        ...state,\r\n        message: action.payload,\r\n      };\r\n    case \"HANDLE_MESSAGE_BOX\":\r\n      return {\r\n        ...state,\r\n        isMessage: action.payload,\r\n      };\r\n    case \"HANDLE_SORT_CODE\":\r\n      return {\r\n        ...state,\r\n        bookSortCode: {\r\n          sort: action.payload.sort,\r\n          order: action.payload.order,\r\n        },\r\n      };\r\n    case \"HANDLE_NOTE_SORT_CODE\":\r\n      return {\r\n        ...state,\r\n        noteSortCode: {\r\n          sort: action.payload.sort,\r\n          order: action.payload.order,\r\n        },\r\n      };\r\n    case \"HANDLE_NOTES\":\r\n      return {\r\n        ...state,\r\n        notes: action.payload,\r\n      };\r\n    case \"HANDLE_BOOKMARKS\":\r\n      return {\r\n        ...state,\r\n        bookmarks: action.payload,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","const initState = {\r\n  percentage: null,\r\n  locations: null,\r\n};\r\nexport function progressPanel(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_PERCENTAGE\":\r\n      return {\r\n        ...state,\r\n        percentage: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_SECTION\":\r\n      return {\r\n        ...state,\r\n        section: action.payload,\r\n      };\r\n    case \"HANDLE_LOCATIONS\":\r\n      return {\r\n        ...state,\r\n        locations: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import OtherUtil from \"../../utils/otherUtil\";\r\nconst initState = {\r\n  bookmarks: [],\r\n  notes: [],\r\n  digests: [],\r\n  chapters: null,\r\n  currentChapter: \"\",\r\n  flattenChapters: null,\r\n  color: 0,\r\n  noteKey: \"\",\r\n  originalText: \"\",\r\n  readerMode: OtherUtil.getReaderConfig(\"readerMode\") || \"double\",\r\n};\r\nexport function reader(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_BOOKMARKS\":\r\n      return {\r\n        ...state,\r\n        bookmarks: action.payload,\r\n      };\r\n    case \"HANDLE_NOTES\":\r\n      return {\r\n        ...state,\r\n        notes: action.payload,\r\n      };\r\n    case \"HANDLE_ORIGINAL_TEXT\":\r\n      return {\r\n        ...state,\r\n        originalText: action.payload,\r\n      };\r\n    case \"HANDLE_COLOR\":\r\n      return {\r\n        ...state,\r\n        color: action.payload,\r\n      };\r\n    case \"HANDLE_NOTE_KEY\":\r\n      return {\r\n        ...state,\r\n        noteKey: action.payload,\r\n      };\r\n    case \"HANDLE_DIGESTS\":\r\n      return {\r\n        ...state,\r\n        digests: action.payload,\r\n      };\r\n    case \"HANDLE_SECTION\":\r\n      return {\r\n        ...state,\r\n        section: action.payload,\r\n      };\r\n    case \"HANDLE_CHAPTERS\":\r\n      return {\r\n        ...state,\r\n        chapters: action.payload,\r\n      };\r\n    case \"HANDLE_FLATTEN_CHAPTERS\":\r\n      return {\r\n        ...state,\r\n        flattenChapters: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","const initState = {\r\n  selection: null,\r\n  isOpenMenu: false,\r\n  menuMode: \"menu\",\r\n  isChangeDirection: false,\r\n  isShowBookmark: false,\r\n};\r\nexport function viewArea(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_OPEN_MENU\":\r\n      return {\r\n        ...state,\r\n        isOpenMenu: action.payload,\r\n      };\r\n    case \"HANDLE_OPEN_HIGHLIGHT\":\r\n      return {\r\n        ...state,\r\n        isOpenHighlight: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_SHOW_BOOKMARK\":\r\n      return {\r\n        ...state,\r\n        isShowBookmark: action.payload,\r\n      };\r\n    case \"HANDLE_SELECTION\":\r\n      return {\r\n        ...state,\r\n        selection: action.payload,\r\n      };\r\n    case \"HANDLE_DIALOG_LOCATION\":\r\n      return {\r\n        ...state,\r\n        dialogLocation: action.payload,\r\n      };\r\n    case \"HANDLE_MENU_MODE\":\r\n      return {\r\n        ...state,\r\n        menuMode: action.payload,\r\n      };\r\n    case \"HANDLE_CHANGE_DIRECTION\":\r\n      return {\r\n        ...state,\r\n        isChangeDirection: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","const initState = {\r\n  mode: \"home\",\r\n  shelfIndex: -1,\r\n  isDragToLove: false,\r\n  isDragToDelete: false,\r\n};\r\nexport function sidebar(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_MODE\":\r\n      return {\r\n        ...state,\r\n        mode: action.payload,\r\n      };\r\n    case \"HANDLE_SHELF_INDEX\":\r\n      return {\r\n        ...state,\r\n        shelfIndex: action.payload,\r\n      };\r\n    case \"HANDLE_DRAG_TO_LOVE\":\r\n      return {\r\n        ...state,\r\n        isDragToLove: action.payload,\r\n      };\r\n    case \"HANDLE_DRAG_TO_DELETE\":\r\n      return {\r\n        ...state,\r\n        isDragToDelete: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","const initState = {\r\n  isBackup: false,\r\n  isOpenTokenDialog: false,\r\n};\r\nexport function backupPage(\r\n  state = initState,\r\n  action: { type: string; payload: boolean }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_BACKUP\":\r\n      return {\r\n        ...state,\r\n        isBackup: action.payload,\r\n      };\r\n    case \"HANDLE_TOKEN_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenTokenDialog: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { createStore, applyMiddleware, compose, combineReducers } from \"redux\";\r\nimport thunk from \"redux-thunk\";\r\nimport { book } from \"./reducers/book\";\r\nimport { manager } from \"./reducers/manager\";\r\nimport { progressPanel } from \"./reducers/progressPanel\";\r\nimport { reader } from \"./reducers/reader\";\r\nimport { viewArea } from \"./reducers/viewArea\";\r\nimport { sidebar } from \"./reducers/sidebar\";\r\nimport { backupPage } from \"./reducers/backupPage\";\r\nimport BookModel from \"../model/Book\";\r\nimport NoteModel from \"../model/Note\";\r\nimport BookmarkModel from \"../model/Bookmark\";\r\nconst rootReducer = combineReducers({\r\n  book,\r\n  manager,\r\n  reader,\r\n  progressPanel,\r\n  viewArea,\r\n  sidebar,\r\n  backupPage,\r\n});\r\nconst store = createStore(\r\n  rootReducer,\r\n  compose(\r\n    applyMiddleware(thunk),\r\n    (window as any).devToolsExtension\r\n      ? (window as any).devToolsExtension()\r\n      : (f: any) => f\r\n  )\r\n);\r\nexport default store;\r\nexport type stateType = {\r\n  manager: {\r\n    books: BookModel[];\r\n    deletedBooks: BookModel[];\r\n    searchResults: number[];\r\n    isSearch: boolean;\r\n    isBookSort: boolean;\r\n    isSettingOpen: boolean;\r\n    viewMode: string;\r\n    isSortDisplay: boolean;\r\n    isShowLoading: boolean;\r\n    isShowNew: boolean;\r\n    isDownloadDesk: boolean;\r\n    bookSortCode: { sort: number; order: number };\r\n    noteSortCode: { sort: number; order: number };\r\n    isMessage: boolean;\r\n    message: string;\r\n  };\r\n  book: {\r\n    isOpenEditDialog: boolean;\r\n    isOpenDeleteDialog: boolean;\r\n    isOpenAddDialog: boolean;\r\n    isOpenActionDialog: boolean;\r\n    isReading: boolean;\r\n    dragItem: string;\r\n    currentBook: BookModel;\r\n    currentEpub: any;\r\n  };\r\n  backupPage: {\r\n    isBackup: boolean;\r\n    isOpenTokenDialog: boolean;\r\n  };\r\n  progressPanel: {\r\n    percentage: number;\r\n    locations: any[];\r\n  };\r\n  reader: {\r\n    bookmarks: BookmarkModel[];\r\n    notes: NoteModel[];\r\n    digests: NoteModel[];\r\n    color: number;\r\n    chapters: any[];\r\n    flattenChapters: any;\r\n    noteKey: string;\r\n    originalText: string;\r\n  };\r\n  sidebar: {\r\n    mode: string;\r\n    shelfIndex: number;\r\n    isDragToLove: boolean;\r\n    isDragToDelete: boolean;\r\n  };\r\n  viewArea: {\r\n    selection: string;\r\n    menuMode: string;\r\n    isOpenMenu: boolean;\r\n    isChangeDirection: boolean;\r\n    isShowBookmark: boolean;\r\n  };\r\n};\r\n","// 记录书本打开记录\nimport BookModel from \"../../model/Book\";\nclass AddTrash {\n  static setTrash(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"deletedBooks\") !== \"{}\" &&\n      localStorage.getItem(\"deletedBooks\")\n        ? JSON.parse(localStorage.getItem(\"deletedBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n      bookArr.unshift(bookKey);\n    } else {\n      bookArr.unshift(bookKey);\n    }\n\n    localStorage.setItem(\"deletedBooks\", JSON.stringify(bookArr));\n  }\n  static setAllTrash(books: BookModel[]) {\n    let bookArr: string[] = [];\n    books.forEach((item) => {\n      bookArr.push(item.key);\n    });\n    localStorage.setItem(\"deletedBooks\", JSON.stringify(bookArr));\n  }\n  static clear(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"deletedBooks\") !== \"{}\" &&\n      localStorage.getItem(\"deletedBooks\")\n        ? JSON.parse(localStorage.getItem(\"deletedBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n    }\n    localStorage.setItem(\"deletedBooks\", JSON.stringify(bookArr));\n  }\n  static getAllTrash() {\n    let bookArr =\n      localStorage.getItem(\"deletedBooks\") !== \"{}\" &&\n      localStorage.getItem(\"deletedBooks\")\n        ? JSON.parse(localStorage.getItem(\"deletedBooks\") || \"\")\n        : [];\n    return bookArr || [];\n  }\n}\n\nexport default AddTrash;\n","import localforage from \"localforage\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport BookModel from \"../../model/Book\";\r\nimport BookmarkModel from \"../../model/Bookmark\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport { Dispatch } from \"redux\";\r\nimport AddTrash from \"../../utils/readUtils/addTrash\";\r\n\r\nexport function handleNotes(notes: NoteModel[]) {\r\n  return { type: \"HANDLE_NOTES\", payload: notes };\r\n}\r\nexport function handleBooks(books: BookModel[]) {\r\n  return { type: \"HANDLE_BOOKS\", payload: books };\r\n}\r\nexport function handleDeletedBooks(deletedBooks: BookModel[]) {\r\n  return { type: \"HANDLE_DELETED_BOOKS\", payload: deletedBooks };\r\n}\r\nexport function handleSearchResults(searchResults: number[]) {\r\n  return { type: \"HANDLE_SEARCH_BOOKS\", payload: searchResults };\r\n}\r\nexport function handleSearch(isSearch: boolean) {\r\n  return { type: \"HANDLE_SEARCH\", payload: isSearch };\r\n}\r\nexport function handleDownloadDesk(isDownloadDesk: boolean) {\r\n  return { type: \"HANDLE_DOWNLOAD_DESK\", payload: isDownloadDesk };\r\n}\r\nexport function handleSetting(isSettingOpen: boolean) {\r\n  return { type: \"HANDLE_SETTING\", payload: isSettingOpen };\r\n}\r\nexport function handleViewMode(mode: string) {\r\n  return { type: \"HANDLE_VIEW_MODE\", payload: mode };\r\n}\r\nexport function handleMessage(message: string) {\r\n  return { type: \"HANDLE_MESSAGE\", payload: message };\r\n}\r\nexport function handleMessageBox(isShow: boolean) {\r\n  return { type: \"HANDLE_MESSAGE_BOX\", payload: isShow };\r\n}\r\nexport function handleSortDisplay(isSortDisplay: boolean) {\r\n  return { type: \"HANDLE_SORT_DISPLAY\", payload: isSortDisplay };\r\n}\r\nexport function handleLoadingDialog(isShowLoading: boolean) {\r\n  return { type: \"HANDLE_SHOW_LOADING\", payload: isShowLoading };\r\n}\r\nexport function handleNewDialog(isShowNew: boolean) {\r\n  return { type: \"HANDLE_SHOW_NEW\", payload: isShowNew };\r\n}\r\nexport function handleBookSort(isBookSort: boolean) {\r\n  return { type: \"HANDLE_BOOK_SORT\", payload: isBookSort };\r\n}\r\nexport function handleNoteSort(isNoteSort: boolean) {\r\n  return { type: \"HANDLE_NOTE_SORT\", payload: isNoteSort };\r\n}\r\nexport function handleBookSortCode(bookSortCode: {\r\n  sort: number;\r\n  order: number;\r\n}) {\r\n  return { type: \"HANDLE_SORT_CODE\", payload: bookSortCode };\r\n}\r\n\r\nexport function handleNoteSortCode(noteSortCode: {\r\n  sort: number;\r\n  order: number;\r\n}) {\r\n  return { type: \"HANDLE_NOTE_SORT_CODE\", payload: noteSortCode };\r\n}\r\nexport function handleBookmarks(bookmarks: BookmarkModel[]) {\r\n  return { type: \"HANDLE_BOOKMARKS\", payload: bookmarks };\r\n}\r\nexport function handleFetchBooks(isTrash = false) {\r\n  return (dispatch: Dispatch) => {\r\n    localforage.getItem(\"books\", async (err, value) => {\r\n      let bookArr: any = value;\r\n      let keyArr = AddTrash.getAllTrash();\r\n      if (isTrash) {\r\n        dispatch(handleDeletedBooks(handleKeyFilter(bookArr, keyArr)));\r\n      } else {\r\n        dispatch(handleBooks(handleKeyRemove(bookArr, keyArr)));\r\n      }\r\n    });\r\n  };\r\n}\r\nexport function handleFetchBookSortCode() {\r\n  return (dispatch: Dispatch) => {\r\n    let bookSortCode = OtherUtil.getBookSortCode();\r\n    dispatch(handleBookSortCode(bookSortCode));\r\n  };\r\n}\r\nexport function handleFetchList() {\r\n  return (dispatch: Dispatch) => {\r\n    let viewMode = OtherUtil.getReaderConfig(\"viewMode\") || \"card\";\r\n    dispatch(handleViewMode(viewMode));\r\n  };\r\n}\r\nconst handleKeyRemove = (items: any[], arr: string[]) => {\r\n  if (!items) return [];\r\n  let itemArr: any[] = [];\r\n  if (!arr[0]) {\r\n    return items;\r\n  }\r\n  for (let i = 0; i < items.length; i++) {\r\n    if (arr.indexOf(items[i].key) === -1) {\r\n      itemArr.push(items[i]);\r\n    }\r\n  }\r\n  return itemArr;\r\n};\r\nconst handleKeyFilter = (items: any[], arr: string[]) => {\r\n  if (!items) {\r\n    return [];\r\n  }\r\n  let itemArr: any[] = [];\r\n  for (let i = 0; i < items.length; i++) {\r\n    if (arr.indexOf(items[i].key) > -1) {\r\n      itemArr.push(items[i]);\r\n    }\r\n  }\r\n  return itemArr;\r\n};\r\n","import localforage from \"localforage\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport BookmarkModel from \"../../model/Bookmark\";\r\nimport AddTrash from \"../../utils/readUtils/addTrash\";\r\nexport function handleNotes(notes: NoteModel[]) {\r\n  return { type: \"HANDLE_NOTES\", payload: notes };\r\n}\r\nexport function handleOriginalText(originalText: string) {\r\n  return { type: \"HANDLE_ORIGINAL_TEXT\", payload: originalText };\r\n}\r\nexport function handleColor(color: number) {\r\n  return { type: \"HANDLE_COLOR\", payload: color };\r\n}\r\nexport function handleBookmarks(bookmarks: BookmarkModel[]) {\r\n  return { type: \"HANDLE_BOOKMARKS\", payload: bookmarks };\r\n}\r\nexport function handleDigests(digests: NoteModel[]) {\r\n  return { type: \"HANDLE_DIGESTS\", payload: digests };\r\n}\r\n\r\nexport function handleCurrentChapter(currentChapter: string) {\r\n  return { type: \"HANDLE_CURRENT_CHAPTER\", payload: currentChapter };\r\n}\r\nexport function handleChapters(chapters: any) {\r\n  return { type: \"HANDLE_CHAPTERS\", payload: chapters };\r\n}\r\nexport function handleFlattenChapters(flattenChapters: any) {\r\n  return { type: \"HANDLE_FLATTEN_CHAPTERS\", payload: flattenChapters };\r\n}\r\nexport function handleNoteKey(key: string) {\r\n  return { type: \"HANDLE_NOTE_KEY\", payload: key };\r\n}\r\nexport function handleFetchNotes() {\r\n  return (dispatch: (arg0: { type: string; payload: NoteModel[] }) => void) => {\r\n    localforage.getItem(\"notes\", (err, value) => {\r\n      let noteArr: any;\r\n      if (value === null || value === []) {\r\n        noteArr = [];\r\n      } else {\r\n        noteArr = value;\r\n      }\r\n      let keyArr = AddTrash.getAllTrash();\r\n      dispatch(handleNotes(handleKeyRemove(noteArr, keyArr)));\r\n      dispatch(\r\n        handleDigests(\r\n          handleKeyRemove(\r\n            noteArr.filter((item: NoteModel) => {\r\n              return item.notes === \"\";\r\n            }),\r\n            keyArr\r\n          )\r\n        )\r\n      );\r\n    });\r\n  };\r\n}\r\nexport function flatChapter(chapters: any) {\r\n  let newChapter: any = [];\r\n  for (let i = 0; i < chapters.length; i++) {\r\n    if (chapters[i].subitems[0]) {\r\n      newChapter.push(chapters[i]);\r\n      newChapter = newChapter.concat(flatChapter(chapters[i].subitems));\r\n    } else {\r\n      newChapter.push(chapters[i]);\r\n    }\r\n  }\r\n  return newChapter;\r\n}\r\n\r\nexport function handleFetchChapters(epub: any) {\r\n  return (dispatch: (arg0: { type: string; payload: any }) => void) => {\r\n    epub.loaded.navigation\r\n      .then((chapters: any) => {\r\n        dispatch(handleChapters(chapters.toc));\r\n        dispatch(handleFlattenChapters(flatChapter(chapters.toc)));\r\n      })\r\n      .catch(() => {\r\n        console.log(\"Error occurs\");\r\n      });\r\n  };\r\n}\r\nexport function handleFetchBookmarks() {\r\n  return (\r\n    dispatch: (arg0: { type: string; payload: BookmarkModel[] }) => void\r\n  ) => {\r\n    localforage.getItem(\"bookmarks\", (err, value) => {\r\n      let bookmarkArr: any;\r\n      if (value === null || value === []) {\r\n        bookmarkArr = [];\r\n      } else {\r\n        bookmarkArr = value;\r\n      }\r\n      let keyArr = AddTrash.getAllTrash();\r\n      dispatch(handleBookmarks(handleKeyRemove(bookmarkArr, keyArr)));\r\n    });\r\n  };\r\n}\r\nconst handleKeyRemove = (items: any[], arr: string[]) => {\r\n  let itemArr: any[] = [];\r\n  if (!arr[0]) {\r\n    return items;\r\n  }\r\n  for (let i = 0; i < items.length; i++) {\r\n    if (arr.indexOf(items[i].bookKey) === -1) {\r\n      itemArr.push(items[i]);\r\n    }\r\n  }\r\n  return itemArr;\r\n};\r\n","export function handleShelfIndex(shelfIndex: number) {\r\n  return { type: \"HANDLE_SHELF_INDEX\", payload: shelfIndex };\r\n}\r\n\r\nexport function handleMode(mode: string) {\r\n  return { type: \"HANDLE_MODE\", payload: mode };\r\n}\r\nexport function handleDragToLove(isDragToLove: boolean) {\r\n  return { type: \"HANDLE_DRAG_TO_LOVE\", payload: isDragToLove };\r\n}\r\nexport function handleDragToDelete(isDragToDelete: boolean) {\r\n  return { type: \"HANDLE_DRAG_TO_DELETE\", payload: isDragToDelete };\r\n}\r\n","export const sideMenu = [\r\n  {\r\n    name: \"All Books\",\r\n    icon: \"home\",\r\n    mode: \"home\",\r\n  },\r\n  {\r\n    name: \"My Favorites\",\r\n    icon: \"love\",\r\n    mode: \"favorite\",\r\n  },\r\n\r\n  {\r\n    name: \"My Notes\",\r\n    icon: \"idea\",\r\n    mode: \"note\",\r\n  },\r\n  {\r\n    name: \"My Digests\",\r\n    icon: \"digest\",\r\n    mode: \"digest\",\r\n  },\r\n  {\r\n    name: \"Deleted Books\",\r\n    icon: \"trash\",\r\n    mode: \"trash\",\r\n  },\r\n];\r\n","import React from \"react\";\r\nimport \"./sidebar.css\";\r\nimport { sideMenu } from \"../../constants/sideMenu\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { SidebarProps, SidebarState } from \"./interface\";\r\nimport { withRouter } from \"react-router-dom\";\r\nconst isElectron = require(\"is-electron\");\r\nclass Sidebar extends React.Component<SidebarProps, SidebarState> {\r\n  constructor(props: SidebarProps) {\r\n    super(props);\r\n    this.state = {\r\n      index: 0,\r\n      hoverIndex: -1,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    this.props.handleMode(\r\n      document.URL.split(\"/\").reverse()[0] === \"empty\"\r\n        ? \"home\"\r\n        : document.URL.split(\"/\").reverse()[0]\r\n    );\r\n  }\r\n  handleSidebar = (mode: string, index: number) => {\r\n    this.setState({ index: index });\r\n    this.props.history.push(`/manager/${mode}`);\r\n    this.props.handleMode(mode);\r\n    this.props.handleSearch(false);\r\n  };\r\n  handleHover = (index: number) => {\r\n    this.setState({ hoverIndex: index });\r\n  };\r\n  render() {\r\n    const renderSideMenu = () => {\r\n      return sideMenu.map((item, index) => {\r\n        return (\r\n          <li\r\n            key={item.name}\r\n            className={\r\n              this.state.index === index\r\n                ? \"active side-menu-item\"\r\n                : \"side-menu-item\"\r\n            }\r\n            id={`sidebar-${item.icon}`}\r\n            onClick={() => {\r\n              this.handleSidebar(item.mode, index);\r\n            }}\r\n            onDrop={() => {\r\n              index === 1 && this.props.handleDragToLove(true);\r\n              index === 5 && this.props.handleDragToDelete(true);\r\n            }}\r\n            onMouseEnter={() => {\r\n              this.handleHover(index);\r\n            }}\r\n            onMouseLeave={() => {\r\n              this.handleHover(-1);\r\n            }}\r\n          >\r\n            {this.state.index === index ? (\r\n              <div className=\"side-menu-selector-container\"></div>\r\n            ) : null}\r\n            {this.state.hoverIndex === index ? (\r\n              <div className=\"side-menu-hover-container\"></div>\r\n            ) : null}\r\n            <div\r\n              className={\r\n                this.state.index === index\r\n                  ? \"side-menu-selector active-selector\"\r\n                  : \"side-menu-selector \"\r\n              }\r\n            >\r\n              <span\r\n                className={\r\n                  this.state.index === index\r\n                    ? `icon-${item.icon} side-menu-icon  active-icon`\r\n                    : `icon-${item.icon} side-menu-icon`\r\n                }\r\n              ></span>\r\n              <Trans>{item.name}</Trans>\r\n              <p style={{ opacity: 0 }}>test</p>\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div className=\"sidebar\">\r\n        <img\r\n          src={\r\n            process.env.NODE_ENV === \"production\"\r\n              ? \"./assets/logo.png\"\r\n              : \"../../assets/logo.png\"\r\n          }\r\n          alt=\"\"\r\n          className=\"logo\"\r\n        />\r\n        <div className=\"side-menu-container-parent\">\r\n          <ul className=\"side-menu-container\">{renderSideMenu()}</ul>\r\n        </div>\r\n        <div\r\n          className=\"download-desktop-version\"\r\n          style={isElectron() ? { display: \"none\" } : {}}\r\n          onClick={() => {\r\n            window.open(\"https://koodo.960960.xyz/download\");\r\n          }}\r\n        >\r\n          <Trans>Download Desktop Version</Trans>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Sidebar);\r\n","import { handleMode } from \"../../store/actions/sidebar\";\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport Sidebar from \"./component\";\r\nimport { handleSearch } from \"../../store/actions/manager\";\r\nimport {\r\n  handleDragToLove,\r\n  handleDragToDelete,\r\n} from \"../../store/actions/sidebar\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return { mode: state.sidebar.mode };\r\n};\r\nconst actionCreator = {\r\n  handleMode,\r\n  handleSearch,\r\n  handleDragToLove,\r\n  handleDragToDelete,\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(Sidebar as any));\r\n","export function handleBackupDialog(mode: boolean) {\r\n  return { type: \"HANDLE_BACKUP\", payload: mode };\r\n}\r\nexport function handleTokenDialog(mode: boolean) {\r\n  return { type: \"HANDLE_TOKEN_DIALOG\", payload: mode };\r\n}\r\n","//搜索框\r\nimport React from \"react\";\r\nimport \"./searchBox.css\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { SearchBoxProps } from \"./interface\";\r\nclass SearchBox extends React.Component<SearchBoxProps> {\r\n  componentDidMount() {\r\n    if (this.props.isNavSearch) {\r\n      let searchBox: any = document.querySelector(\".header-search-box\");\r\n      searchBox && searchBox.focus();\r\n    }\r\n  }\r\n  handleMouse = () => {\r\n    let value = (this.refs.searchBox as any).value;\r\n    if (this.props.isNavSearch) {\r\n      value && this.search(value);\r\n    }\r\n    if (this.props.mode === \"nav\") {\r\n      this.props.handleSearchState(true);\r\n    }\r\n    let results =\r\n      this.props.tabMode === \"note\"\r\n        ? OtherUtil.MouseNoteSearch(\r\n            this.props.notes.filter((item) => item.notes !== \"\")\r\n          )\r\n        : this.props.tabMode === \"digest\"\r\n        ? OtherUtil.MouseNoteSearch(this.props.digests)\r\n        : OtherUtil.MouseSearch(this.props.books);\r\n    if (results) {\r\n      this.props.handleSearchResults(results);\r\n      this.props.handleSearch(true);\r\n    }\r\n  };\r\n  handleKey = (event: any) => {\r\n    if (event.keyCode !== 13) {\r\n      return;\r\n    }\r\n    let value = (this.refs.searchBox as any).value;\r\n    if (this.props.isNavSearch) {\r\n      value && this.search(value);\r\n    }\r\n    let results =\r\n      this.props.tabMode === \"note\"\r\n        ? OtherUtil.KeyNoteSearch(\r\n            event,\r\n            this.props.notes.filter((item) => item.notes !== \"\")\r\n          )\r\n        : this.props.tabMode === \"digest\"\r\n        ? OtherUtil.KeyNoteSearch(event, this.props.digests)\r\n        : OtherUtil.KeySearch(event, this.props.books);\r\n    if (results) {\r\n      this.props.handleSearchResults(results);\r\n      this.props.handleSearch(true);\r\n    }\r\n  };\r\n  search = (q: string) => {\r\n    this.doSearch(q).then((result) => {\r\n      let searchList = result.map((item: any) => {\r\n        item.excerpt = item.excerpt.replace(\r\n          q,\r\n          `<span class=\"content-search-text\">${q}</span>`\r\n        );\r\n        return item;\r\n      });\r\n      this.props.handleSearchList(searchList);\r\n    });\r\n  };\r\n  doSearch = (q: string) => {\r\n    return Promise.all(\r\n      this.props.currentEpub.spine.spineItems.map((item: any) =>\r\n        item\r\n          .load(this.props.currentEpub.load.bind(this.props.currentEpub))\r\n          .then(item.find.bind(item, q))\r\n          .finally(item.unload.bind(item))\r\n      )\r\n    ).then((results: any) => Promise.resolve([].concat.apply([], results)));\r\n  };\r\n  handleCancel = () => {\r\n    if (this.props.isNavSearch) {\r\n      this.props.handleSearchList(null);\r\n    }\r\n    this.props.handleSearch(false);\r\n    (document.querySelector(\".header-search-box\") as HTMLInputElement).value =\r\n      \"\";\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div style={{ position: \"relative\" }}>\r\n        <input\r\n          type=\"text\"\r\n          ref=\"searchBox\"\r\n          className=\"header-search-box\"\r\n          onKeyDown={(event) => {\r\n            this.handleKey(event);\r\n          }}\r\n          onFocus={() => {\r\n            this.props.mode === \"nav\" && this.props.handleSearchState(true);\r\n          }}\r\n          placeholder={\r\n            this.props.isNavSearch || this.props.mode === \"nav\"\r\n              ? this.props.t(\"Search the book\")\r\n              : this.props.tabMode === \"note\"\r\n              ? this.props.t(\"Search my notes\")\r\n              : this.props.tabMode === \"digest\"\r\n              ? this.props.t(\"Search my digests\")\r\n              : this.props.t(\"Search my library\")\r\n          }\r\n          style={\r\n            this.props.mode === \"nav\"\r\n              ? { width: this.props.width, height: this.props.height }\r\n              : { paddingRight: \"50px\" }\r\n          }\r\n        />\r\n        {this.props.isSearch ? (\r\n          <span\r\n            className=\"header-search-text\"\r\n            onClick={() => {\r\n              this.handleCancel();\r\n            }}\r\n            style={this.props.mode === \"nav\" ? { right: \"-9px\" } : {}}\r\n          >\r\n            <Trans>Cancel</Trans>\r\n          </span>\r\n        ) : (\r\n          <span\r\n            className=\"icon-search header-search-icon\"\r\n            onClick={() => {\r\n              this.handleMouse();\r\n            }}\r\n            style={this.props.mode === \"nav\" ? { right: \"5px\" } : {}}\r\n          ></span>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SearchBox;\r\n","import { connect } from \"react-redux\";\r\nimport { handleSearchResults, handleSearch } from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport SearchBox from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n    isSearch: state.manager.isSearch,\r\n    currentEpub: state.book.currentEpub,\r\n    tabMode: state.sidebar.mode,\r\n    shelfIndex: state.sidebar.shelfIndex,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSearchResults,\r\n  handleSearch,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(SearchBox as any));\r\n","import BookModel from \"../../model/Book\";\r\nexport function handleEditDialog(mode: boolean) {\r\n  return { type: \"HANDLE_EDIT_DIALOG\", payload: mode };\r\n}\r\nexport function handleDeleteDialog(mode: boolean) {\r\n  return { type: \"HANDLE_DELETE_DIALOG\", payload: mode };\r\n}\r\nexport function handleAddDialog(mode: boolean) {\r\n  return { type: \"HANDLE_ADD_DIALOG\", payload: mode };\r\n}\r\nexport function handleActionDialog(mode: boolean) {\r\n  return { type: \"HANDLE_ACTION_DIALOG\", payload: mode };\r\n}\r\nexport function handleReadingState(state: boolean) {\r\n  return { type: \"HANDLE_READING_STATE\", payload: state };\r\n}\r\nexport function handleReadingBook(book: BookModel) {\r\n  return { type: \"HANDLE_READING_BOOK\", payload: book };\r\n}\r\nexport function handleReadingEpub(epub: any) {\r\n  return { type: \"HANDLE_READING_EPUB\", payload: epub };\r\n}\r\nexport function handleDragItem(key: string) {\r\n  return { type: \"HANDLE_DRAG_ITEM\", payload: key };\r\n}\r\n","class Book {\r\n  key: string;\r\n  name: string;\r\n  author: string;\r\n  description: string;\r\n  md5: string;\r\n  cover: string;\r\n  format: string;\r\n  publisher: string;\r\n  constructor(\r\n    key: string,\r\n    name: string,\r\n    author: string,\r\n    description: string,\r\n    md5: string,\r\n    cover: string,\r\n    format: string,\r\n    publisher: string\r\n  ) {\r\n    this.key = key; // 数据库的键\r\n    this.name = name; // 书籍名\r\n    this.author = author; // 作者\r\n    this.description = description; // 书籍的描述\r\n    this.md5 = md5; //epub的md5值，防止重复导入\r\n    this.cover = cover;\r\n    this.format = format;\r\n    this.publisher = publisher;\r\n  }\r\n}\r\n\r\nexport default Book;\r\n","// 记录书本打开记录\nimport BookModel from \"../../model/Book\";\nclass RecordRecent {\n  static setRecent(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\n      localStorage.getItem(\"recentBooks\")\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n      bookArr.unshift(bookKey);\n    } else {\n      bookArr.unshift(bookKey);\n    }\n\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\n  }\n  static setAllRecent(books: BookModel[]) {\n    let bookArr: string[] = [];\n    books.forEach((item) => {\n      bookArr.push(item.key);\n    });\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\n  }\n\n  static clear(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\n      localStorage.getItem(\"recentBooks\")\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n    }\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\n  }\n  static getAllRecent() {\n    let bookArr =\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\n      localStorage.getItem(\"recentBooks\")\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\n        : [];\n    return bookArr || [];\n  }\n}\n\nexport default RecordRecent;\n","export const config = {\r\n  callback_url:\r\n    process.env.NODE_ENV === \"production\"\r\n      ? \"https://reader.960960.xyz\"\r\n      : \"http://localhost:3000\",\r\n  token_url:\r\n    process.env.NODE_ENV === \"production\"\r\n      ? \"http://localhost:3366\"\r\n      : \"http://localhost:3366\",\r\n  dropbox_client_id: \"e3zgg310xbizvaf\",\r\n  googledrive_client_id:\r\n    \"99440516227-ifr1ann33f2j610i3ri17ej0i51c7m6e.apps.googleusercontent.com\",\r\n  onedrive_client_id: \"ac96f9bf-94f2-49c0-8418-999b919bc236\",\r\n};\r\nexport const driveList = [\r\n  {\r\n    id: 1,\r\n    name: \"Local\",\r\n    icon: \"local\",\r\n    url: \"\",\r\n  },\r\n  {\r\n    id: 2,\r\n    name: \"Dropbox\",\r\n    icon: \"dropbox\",\r\n    url: `https://www.dropbox.com/oauth2/authorize?response_type=token&client_id=${config.dropbox_client_id}&redirect_uri=${config.callback_url}`,\r\n  },\r\n\r\n  {\r\n    id: 3,\r\n    name: \"Google Drive\",\r\n    icon: \"googledrive\",\r\n    url: \"\",\r\n  },\r\n  // {\r\n  //   id: 4,\r\n  //   name: \"OneDrive\",\r\n  //   icon: \"onedrive\",\r\n  //   url: `https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=${config.onedrive_client_id}&scope=files.readwrite offline_access&response_type=code&redirect_uri=${config.callback_url}`,\r\n  // },\r\n  {\r\n    id: 5,\r\n    name: \"WebDav\",\r\n    icon: \"webdav\",\r\n    url: \"\",\r\n  },\r\n];\r\n","function ab2str(buf) {\r\n  if (buf instanceof ArrayBuffer) {\r\n    buf = new Uint8Array(buf);\r\n  }\r\n  return new TextDecoder(\"utf-8\").decode(buf);\r\n}\r\n\r\nvar domParser = new DOMParser();\r\n\r\nclass Buffer {\r\n  capacity: any;\r\n  fragment_list: any;\r\n  imageArray: any;\r\n  cur_fragment: Fragment;\r\n  constructor(capacity) {\r\n    this.capacity = capacity;\r\n    this.fragment_list = [];\r\n    this.imageArray = [];\r\n    this.cur_fragment = new Fragment(capacity);\r\n    this.fragment_list.push(this.cur_fragment);\r\n  }\r\n  write(byte) {\r\n    var result = this.cur_fragment.write(byte);\r\n    if (!result) {\r\n      this.cur_fragment = new Fragment(this.capacity);\r\n      this.fragment_list.push(this.cur_fragment);\r\n      this.cur_fragment.write(byte);\r\n    }\r\n  }\r\n  get(idx) {\r\n    var fi = 0;\r\n    while (fi < this.fragment_list.length) {\r\n      var frag = this.fragment_list[fi];\r\n      if (idx < frag.size) {\r\n        return frag.get(idx);\r\n      }\r\n      idx -= frag.size;\r\n      fi += 1;\r\n    }\r\n    return null;\r\n  }\r\n  size() {\r\n    var s = 0;\r\n    for (var i = 0; i < this.fragment_list.length; i++) {\r\n      s += this.fragment_list[i].size;\r\n    }\r\n    return s;\r\n  }\r\n  shrink() {\r\n    var total_buffer = new Uint8Array(this.size());\r\n    var offset = 0;\r\n    for (var i = 0; i < this.fragment_list.length; i++) {\r\n      var frag = this.fragment_list[i];\r\n      if (frag.full()) {\r\n        total_buffer.set(frag.buffer, offset);\r\n      } else {\r\n        total_buffer.set(frag.buffer.slice(0, frag.size), offset);\r\n      }\r\n      offset += frag.size;\r\n    }\r\n    return total_buffer;\r\n  }\r\n}\r\n\r\nvar copagesne_uint8array = function (buffers) {\r\n  var total_size = 0;\r\n  for (let i = 0; i < buffers.length; i++) {\r\n    var buffer = buffers[i];\r\n    total_size += buffer.length;\r\n  }\r\n  var total_buffer = new Uint8Array(total_size);\r\n  var offset = 0;\r\n  for (let i = 0; i < buffers.length; i++) {\r\n    buffer = buffers[i];\r\n    total_buffer.set(buffer, offset);\r\n    offset += buffer.length;\r\n  }\r\n  return total_buffer;\r\n};\r\n\r\nclass Fragment {\r\n  buffer: Uint8Array;\r\n  capacity: any;\r\n  size: number;\r\n  constructor(capacity) {\r\n    this.buffer = new Uint8Array(capacity);\r\n    this.capacity = capacity;\r\n    this.size = 0;\r\n  }\r\n\r\n  write(byte) {\r\n    if (this.size >= this.capacity) {\r\n      return false;\r\n    }\r\n    this.buffer[this.size] = byte;\r\n    this.size += 1;\r\n    return true;\r\n  }\r\n  full() {\r\n    return this.size === this.capacity;\r\n  }\r\n  get(idx) {\r\n    return this.buffer[idx];\r\n  }\r\n}\r\n\r\nvar uncompression_lz77 = function (data) {\r\n  var length = data.length;\r\n  var offset = 0; // Current offset into data\r\n  var buffer = new Buffer(data.length);\r\n\r\n  while (offset < length) {\r\n    var char = data[offset];\r\n    offset += 1;\r\n\r\n    if (char === 0) {\r\n      buffer.write(char);\r\n    } else if (char <= 8) {\r\n      for (var i = offset; i < offset + char; i++) {\r\n        buffer.write(data[i]);\r\n      }\r\n      offset += char;\r\n    } else if (char <= 0x7f) {\r\n      buffer.write(char);\r\n    } else if (char <= 0xbf) {\r\n      var next = data[offset];\r\n      offset += 1;\r\n      var distance = (((char << 8) | next) >> 3) & 0x7ff;\r\n      var lz_length = (next & 0x7) + 3;\r\n\r\n      var buffer_size = buffer.size();\r\n      for (let i = 0; i < lz_length; i++) {\r\n        buffer.write(buffer.get(buffer_size - distance));\r\n        buffer_size += 1;\r\n      }\r\n    } else {\r\n      buffer.write(32);\r\n      buffer.write(char ^ 0x80);\r\n    }\r\n  }\r\n  return buffer;\r\n};\r\n\r\nclass MobiFile {\r\n  view: DataView;\r\n  buffer: ArrayBuffer;\r\n  offset: number;\r\n  header: any;\r\n  palm_header: any;\r\n  mobi_header: any;\r\n  reclist: any;\r\n  constructor(data) {\r\n    this.view = new DataView(data);\r\n    this.buffer = this.view.buffer;\r\n    this.offset = 0;\r\n    this.header = null;\r\n  }\r\n\r\n  parse() {}\r\n\r\n  getUint8() {\r\n    var v = this.view.getUint8(this.offset);\r\n    this.offset += 1;\r\n    return v;\r\n  }\r\n\r\n  getUint16() {\r\n    var v = this.view.getUint16(this.offset);\r\n    this.offset += 2;\r\n    return v;\r\n  }\r\n\r\n  getUint32() {\r\n    var v = this.view.getUint32(this.offset);\r\n    this.offset += 4;\r\n    return v;\r\n  }\r\n\r\n  getStr(size) {\r\n    var v = ab2str(this.buffer.slice(this.offset, this.offset + size));\r\n    this.offset += size;\r\n    return v;\r\n  }\r\n\r\n  skip(size) {\r\n    this.offset += size;\r\n  }\r\n\r\n  setoffset(_of) {\r\n    this.offset = _of;\r\n  }\r\n\r\n  get_record_extrasize(data, flags) {\r\n    var pos = data.length - 1;\r\n    var extra = 0;\r\n    for (var i = 15; i > 0; i--) {\r\n      if (flags & (1 << i)) {\r\n        var res = this.buffer_get_varlen(data, pos);\r\n        var size = res[0];\r\n        var l = res[1];\r\n        pos = res[2];\r\n        pos -= size - l;\r\n        extra += size;\r\n      }\r\n    }\r\n    if (flags & 1) {\r\n      var a = data[pos];\r\n      extra += (a & 0x3) + 1;\r\n    }\r\n    return extra;\r\n  }\r\n\r\n  // data should be uint8array\r\n  buffer_get_varlen(data, pos) {\r\n    var l = 0;\r\n    var size = 0;\r\n    var byte_count = 0;\r\n    var mask = 0x7f;\r\n    var stop_flag = 0x80;\r\n    var shift = 0;\r\n    for (var i = 0; ; i++) {\r\n      var byte = data[pos];\r\n      size |= (byte & mask) << shift;\r\n      shift += 7;\r\n      l += 1;\r\n      byte_count += 1;\r\n      pos -= 1;\r\n\r\n      var to_stop = byte & stop_flag;\r\n      if (byte_count >= 4 || to_stop > 0) {\r\n        break;\r\n      }\r\n    }\r\n    return [size, l, pos];\r\n  }\r\n  // 读出文本内容\r\n  read_text() {\r\n    var text_end = this.palm_header.record_count;\r\n    var buffers: any = [];\r\n    for (var i = 1; i <= text_end; i++) {\r\n      buffers.push(this.read_text_record(i));\r\n    }\r\n    var all = copagesne_uint8array(buffers);\r\n    return ab2str(all);\r\n  }\r\n\r\n  read_text_record(i) {\r\n    var flags = this.mobi_header.extra_flags;\r\n    var begin = this.reclist[i].offset;\r\n    var end = this.reclist[i + 1].offset;\r\n\r\n    var data = new Uint8Array(this.buffer.slice(begin, end));\r\n    var ex = this.get_record_extrasize(data, flags);\r\n\r\n    data = new Uint8Array(this.buffer.slice(begin, end - ex));\r\n    if (this.palm_header.compression === 2) {\r\n      var buffer = uncompression_lz77(data);\r\n      return buffer.shrink();\r\n    } else {\r\n      return data;\r\n    }\r\n  }\r\n  // 从buffer中读出image\r\n  read_image(idx) {\r\n    var first_image_idx = this.mobi_header.first_image_idx;\r\n    var begin = this.reclist[first_image_idx + idx].offset;\r\n    var end = this.reclist[first_image_idx + idx + 1].offset;\r\n    var data = new Uint8Array(this.buffer.slice(begin, end));\r\n    return new Blob([data.buffer]);\r\n  }\r\n\r\n  load() {\r\n    this.header = this.load_pdbheader();\r\n    this.reclist = this.load_reclist();\r\n    this.load_record0();\r\n  }\r\n\r\n  load_pdbheader() {\r\n    var header: any = {};\r\n    header.name = this.getStr(32);\r\n    header.attr = this.getUint16();\r\n    header.version = this.getUint16();\r\n    header.ctime = this.getUint32();\r\n    header.mtime = this.getUint32();\r\n    header.btime = this.getUint32();\r\n    header.mod_num = this.getUint32();\r\n    header.appinfo_offset = this.getUint32();\r\n    header.sortinfo_offset = this.getUint32();\r\n    header.type = this.getStr(4);\r\n    header.creator = this.getStr(4);\r\n    header.uid = this.getUint32();\r\n    header.next_rec = this.getUint32();\r\n    header.record_num = this.getUint16();\r\n    return header;\r\n  }\r\n\r\n  load_reclist() {\r\n    var reclist: any = [];\r\n    for (var i = 0; i < this.header.record_num; i++) {\r\n      var record: any = {};\r\n      record.offset = this.getUint32();\r\n      // TODO(zz) change\r\n      record.attr = this.getUint32();\r\n      reclist.push(record);\r\n    }\r\n    return reclist;\r\n  }\r\n  load_record0() {\r\n    this.palm_header = this.load_record0_header();\r\n    this.mobi_header = this.load_mobi_header();\r\n  }\r\n\r\n  load_record0_header() {\r\n    var p_header: any = {};\r\n    var first_record = this.reclist[0];\r\n    this.setoffset(first_record.offset);\r\n\r\n    p_header.compression = this.getUint16();\r\n    this.skip(2);\r\n    p_header.text_length = this.getUint32();\r\n    p_header.record_count = this.getUint16();\r\n    p_header.record_size = this.getUint16();\r\n    p_header.encryption_type = this.getUint16();\r\n    this.skip(2);\r\n\r\n    return p_header;\r\n  }\r\n\r\n  load_mobi_header() {\r\n    var mobi_header: any = {};\r\n\r\n    var start_offset = this.offset;\r\n\r\n    mobi_header.identifier = this.getUint32();\r\n    mobi_header.header_length = this.getUint32();\r\n    mobi_header.mobi_type = this.getUint32();\r\n    mobi_header.text_encoding = this.getUint32();\r\n    mobi_header.uid = this.getUint32();\r\n    mobi_header.generator_version = this.getUint32();\r\n\r\n    this.skip(40);\r\n\r\n    mobi_header.first_nonbook_index = this.getUint32();\r\n    mobi_header.full_name_offset = this.getUint32();\r\n    mobi_header.full_name_length = this.getUint32();\r\n\r\n    mobi_header.language = this.getUint32();\r\n    mobi_header.input_language = this.getUint32();\r\n    mobi_header.output_language = this.getUint32();\r\n    mobi_header.min_version = this.getUint32();\r\n    mobi_header.first_image_idx = this.getUint32();\r\n\r\n    mobi_header.huff_rec_index = this.getUint32();\r\n    mobi_header.huff_rec_count = this.getUint32();\r\n    mobi_header.datp_rec_index = this.getUint32();\r\n    mobi_header.datp_rec_count = this.getUint32();\r\n\r\n    mobi_header.exth_flags = this.getUint32();\r\n\r\n    this.skip(36);\r\n\r\n    mobi_header.drm_offset = this.getUint32();\r\n    mobi_header.drm_count = this.getUint32();\r\n    mobi_header.drm_size = this.getUint32();\r\n    mobi_header.drm_flags = this.getUint32();\r\n\r\n    this.skip(8);\r\n\r\n    // TODO (zz) fdst_index\r\n    this.skip(4);\r\n\r\n    this.skip(46);\r\n\r\n    mobi_header.extra_flags = this.getUint16();\r\n\r\n    this.setoffset(start_offset + mobi_header.header_length);\r\n\r\n    return mobi_header;\r\n  }\r\n  load_exth_header() {\r\n    // TODO\r\n    return {};\r\n  }\r\n  extractContent(s) {\r\n    var span = document.createElement(\"span\");\r\n    span.innerHTML = s;\r\n    return span.textContent || span.innerText;\r\n  }\r\n  render(handleMessage, handleMessageBox) {\r\n    return new Promise((resolve, reject) => {\r\n      this.load();\r\n      var content = this.read_text();\r\n      var bookDoc = domParser.parseFromString(content, \"text/html\")\r\n        .documentElement;\r\n      const lines: any = Array.from(bookDoc.querySelectorAll(\"p,b,font,h3\"));\r\n\r\n      let parseContent: any = [];\r\n      for (let i = 0, len = lines.length; i < len - 1; i++) {\r\n        parseContent.push(\r\n          lines[i].tagName === \"FONT\" ||\r\n            lines[i].tagName === \"B\" ||\r\n            lines[i].tagName === \"H3\"\r\n            ? \"*\" + lines[i].innerText\r\n            : lines[i].innerText\r\n        );\r\n        let imgDoms = lines[i].getElementsByTagName(\"img\");\r\n        if (imgDoms.length > 0) {\r\n          for (let i = 0; i < imgDoms.length; i++) {\r\n            parseContent.push(\"#image\");\r\n          }\r\n        }\r\n      }\r\n      const handleImage = async () => {\r\n        var imgDoms = bookDoc.getElementsByTagName(\"img\");\r\n        if (imgDoms.length > 500) {\r\n          handleMessage(\"Too many images\");\r\n          handleMessageBox(true);\r\n          resolve(parseContent.join(\"\\n    \\n\"));\r\n        }\r\n        parseContent.push(\"~image\");\r\n        for (let i = 0; i < imgDoms.length; i++) {\r\n          const src = await this.render_image(imgDoms, i);\r\n          parseContent.push(\r\n            src + \" \" + imgDoms[i].width + \" \" + imgDoms[i].height\r\n          );\r\n        }\r\n        resolve(parseContent.join(\"\\n    \\n\"));\r\n      };\r\n      handleImage();\r\n    });\r\n  }\r\n  render_image = (imgDoms, i) => {\r\n    return new Promise((resolve, reject) => {\r\n      var imgDom = imgDoms[i];\r\n      var idx = +imgDom.getAttribute(\"recindex\");\r\n      var blob = this.read_image(idx - 1);\r\n      var imgReader = new FileReader();\r\n      imgReader.onload = (e) => {\r\n        imgDom.src = e.target?.result;\r\n        resolve(e.target?.result);\r\n      };\r\n      imgReader.onerror = function (err) {\r\n        reject(err);\r\n      };\r\n      imgReader.readAsDataURL(blob);\r\n    });\r\n  };\r\n}\r\n\r\nexport default MobiFile;\r\n","import axios from \"axios\";\r\nimport { config } from \"../constants/driveList\";\r\nimport OtherUtil from \"./otherUtil\";\r\nimport isElectron from \"is-electron\";\r\nimport localforage from \"localforage\";\r\nimport BookModel from \"../model/Book\";\r\n\r\nclass BookUtil {\r\n  static addBook(key: string, buffer: ArrayBuffer) {\r\n    if (isElectron()) {\r\n      return new Promise<void>((resolve, reject) => {\r\n        let formData = new FormData();\r\n        formData.append(\"file\", new Blob([buffer]));\r\n        formData.append(\"key\", key);\r\n        formData.append(\r\n          \"dataPath\",\r\n          OtherUtil.getReaderConfig(\"storageLocation\")\r\n            ? OtherUtil.getReaderConfig(\"storageLocation\")\r\n            : window\r\n                .require(\"electron\")\r\n                .ipcRenderer.sendSync(\"storage-location\", \"ping\")\r\n        );\r\n        axios\r\n          .post(`${config.token_url}/add_book`, formData, {\r\n            headers: {\r\n              \"Content-Type\": \"multipart/form-data\",\r\n            },\r\n            responseType: \"blob\",\r\n          })\r\n          .then(function (response: any) {\r\n            console.log(response, \"添加成功\");\r\n            resolve();\r\n          })\r\n          .catch(function (error: any) {\r\n            console.error(error, \"添加失败\");\r\n            reject();\r\n          });\r\n      });\r\n    } else {\r\n      return localforage.setItem(key, buffer);\r\n    }\r\n  }\r\n  static deleteBook(key: string) {\r\n    if (isElectron()) {\r\n      return new Promise<void>((resolve, reject) => {\r\n        axios\r\n          .post(`${config.token_url}/delete_book`, {\r\n            key,\r\n            dataPath: OtherUtil.getReaderConfig(\"storageLocation\")\r\n              ? OtherUtil.getReaderConfig(\"storageLocation\")\r\n              : window\r\n                  .require(\"electron\")\r\n                  .ipcRenderer.sendSync(\"storage-location\", \"ping\"),\r\n          })\r\n          .then(function (response: any) {\r\n            console.log(response, \"删除成功\");\r\n            resolve();\r\n          })\r\n          .catch(function (error: any) {\r\n            console.error(error, \"删除失败\");\r\n            reject();\r\n          });\r\n      });\r\n    } else {\r\n      return localforage.removeItem(key);\r\n    }\r\n  }\r\n  static fetchBook(key: string) {\r\n    if (isElectron()) {\r\n      return new Promise<File>((resolve, reject) => {\r\n        // axios\r\n        //   .post(\r\n        //     `${config.token_url}/fetch_book`,\r\n        //     {\r\n        //       key,\r\n        //       dataPath: OtherUtil.getReaderConfig(\"storageLocation\")\r\n        //         ? OtherUtil.getReaderConfig(\"storageLocation\")\r\n        //         : window\r\n        //             .require(\"electron\")\r\n        //             .ipcRenderer.sendSync(\"storage-location\", \"ping\"),\r\n        //     },\r\n        //     {\r\n        //       responseType: \"blob\",\r\n        //     }\r\n        //   )\r\n        //   .then(function (response: any) {\r\n        //     console.log(response, \"删除成功\");\r\n        //     let blobTemp = new Blob([response.data], {\r\n        //       type: \"application/epub+zip\",\r\n        //     });\r\n        //     let fileTemp = new File([blobTemp], \"data.epub\", {\r\n        //       lastModified: new Date().getTime(),\r\n        //       type: blobTemp.type,\r\n        //     });\r\n        //     resolve(fileTemp);\r\n        //   })\r\n        //   .catch(function (error: any) {\r\n        //     console.error(error, \"删除失败\");\r\n        //     reject();\r\n        //   });\r\n        var fs = window.require(\"fs\");\r\n        var path = window.require(\"path\");\r\n        var data = fs.readFileSync(\r\n          path.join(\r\n            OtherUtil.getReaderConfig(\"storageLocation\")\r\n              ? OtherUtil.getReaderConfig(\"storageLocation\")\r\n              : window\r\n                  .require(\"electron\")\r\n                  .ipcRenderer.sendSync(\"storage-location\", \"ping\"),\r\n            `book`,\r\n            key\r\n          )\r\n        );\r\n        console.log(\r\n          path.join(\r\n            (OtherUtil.getReaderConfig(\"storageLocation\")\r\n              ? OtherUtil.getReaderConfig(\"storageLocation\")\r\n              : window\r\n                  .require(\"electron\")\r\n                  .ipcRenderer.sendSync(\"storage-location\", \"ping\")), \"book\",\r\n            key\r\n          )\r\n        );\r\n        let blobTemp = new Blob([data], { type: \"application/epub+zip\" });\r\n        let fileTemp = new File([blobTemp], \"data.epub\", {\r\n          lastModified: new Date().getTime(),\r\n          type: blobTemp.type,\r\n        });\r\n        resolve(fileTemp);\r\n      });\r\n    } else {\r\n      return localforage.getItem(key);\r\n    }\r\n  }\r\n  static async RedirectBook(book: BookModel) {\r\n    if (book.description === \"pdf\") {\r\n      if (isElectron()) {\r\n        const file: any = await this.fetchBook(book.key);\r\n        file.arrayBuffer().then(async (arrayBuffer) => {\r\n          await localforage.setItem(\"pdf\", arrayBuffer);\r\n          window.open(`./lib/pdf/viewer.html?file=pdf`);\r\n        });\r\n      } else {\r\n        window.open(`./lib/pdf/viewer.html?file=${book.key}`);\r\n      }\r\n    } else {\r\n      window.open(`${window.location.href.split(\"#\")[0]}#/epub/${book.key}`);\r\n    }\r\n  }\r\n}\r\n\r\nexport default BookUtil;\r\n","import localforage from \"localforage\";\r\nimport BookUtil from \"../bookUtil\";\r\n\r\nlet JSZip = (window as any).JSZip;\r\n\r\nclass RestoreUtil {\r\n  static restore = (\r\n    file: any,\r\n    handleFinish: (mobileData) => void,\r\n    isSync = false\r\n  ) => {\r\n    let configArr = [\r\n      \"notes\",\r\n      \"books\",\r\n      \"bookmarks\",\r\n      \"readerConfig\",\r\n      \"noteTags\",\r\n      \"bookSortCode\",\r\n      \"noteSortCode\",\r\n      \"readingTime\",\r\n      \"recentBooks\",\r\n      \"favoriteBooks\",\r\n      \"favoriteBooks\",\r\n      \"shelfList\",\r\n      \"pdfjs.history\",\r\n      \"recordLocation\",\r\n    ];\r\n    let zip = new JSZip();\r\n    let mobileObject: Object = {};\r\n    // more files !\r\n    configArr.forEach((item) => {\r\n      zip\r\n        .loadAsync(file)\r\n        .then((content: any) => {\r\n          // you now have every files contained in the loaded zip\r\n          return content.files[\r\n            isSync ? `${item}.json` : `config/${item}.json`\r\n          ].async(\"text\"); // a promise of \"Hello World\\n\"\r\n        })\r\n        .then((text: any) => {\r\n          if (text) {\r\n            if (item === \"notes\" || item === \"books\" || item === \"bookmarks\") {\r\n              localforage.setItem(item, JSON.parse(text));\r\n              mobileObject[item] = text;\r\n            } else {\r\n              localStorage.setItem(item, text);\r\n              mobileObject[item] = text;\r\n            }\r\n          }\r\n        })\r\n        .then(() => {\r\n          if (item === \"books\" && !isSync) {\r\n            localforage.getItem(\"books\").then((value: any) => {\r\n              let zip = new JSZip();\r\n              value &&\r\n                value.forEach((item: any) => {\r\n                  zip\r\n                    .loadAsync(file)\r\n                    .then((content: any) => {\r\n                      if (content.files[`book/${item.key}`]) {\r\n                        return content.files[`book/${item.key}`].async(\r\n                          \"arraybuffer\"\r\n                        );\r\n                      }\r\n\r\n                      if (item.description === \"pdf\") {\r\n                        return content.files[`book/${item.name}.pdf`].async(\r\n                          \"arraybuffer\"\r\n                        ); // a promise of \"Hello World\\n\"\r\n                      } else {\r\n                        return content.files[`book/${item.name}.epub`].async(\r\n                          \"arraybuffer\"\r\n                        ); // a promise of \"Hello World\\n\"\r\n                      }\r\n                    })\r\n                    .then(async (book: any) => {\r\n                      await BookUtil.addBook(item.key, book);\r\n                    })\r\n                    .catch((err: any) => {\r\n                      console.log(err, \"Error occurs\");\r\n                    });\r\n                });\r\n            });\r\n          }\r\n        })\r\n        .catch((err: any) => {\r\n          console.log(err, \"Error happen\");\r\n        });\r\n    });\r\n    setTimeout(() => {\r\n      handleFinish(JSON.stringify(mobileObject));\r\n    }, 1000);\r\n  };\r\n}\r\n\r\nexport default RestoreUtil;\r\n","import RestoreUtil from \"./restoreUtil\";\nimport OtherUtil from \"../otherUtil\";\n\nvar Dropbox = (window as any).Dropbox;\n\nclass DropboxUitl {\n  static UploadFile(\n    file: any,\n    handleFinish: () => void,\n    showMessage: (message: string) => void\n  ) {\n    var ACCESS_TOKEN = OtherUtil.getReaderConfig(\"dropbox_token\") || \"\";\n    let year = new Date().getFullYear(),\n      month = new Date().getMonth() + 1,\n      day = new Date().getDate();\n    var dbx = new Dropbox.Dropbox({ accessToken: ACCESS_TOKEN });\n    dbx\n      .filesUpload({\n        path: \"/Apps/KoodoReader/data.zip\",\n        contents: file,\n        mode: { \".tag\": \"overwrite\" },\n      })\n      .then(function (response: any) {\n        console.log(response, \"上传成功\");\n        dbx\n          .filesUpload({\n            path:\n              \"/Apps/KoodoReader/\" +\n              `${year}-${month <= 9 ? \"0\" + month : month}-${\n                day <= 9 ? \"0\" + day : day\n              }.zip`,\n            contents: file,\n            mode: { \".tag\": \"overwrite\" },\n          })\n          .then(function (response: any) {\n            console.log(response, \"上传成功\");\n            handleFinish();\n          })\n          .catch(function (error: any) {\n            console.error(error, \"上传失败\");\n            showMessage(\"Upload failed, check your connection\");\n          });\n      })\n      .catch(function (error: any) {\n        console.error(error, \"上传失败\");\n        showMessage(\"Upload failed, check your connection\");\n      });\n    return false;\n  }\n  static DownloadFile(\n    handleFinish: (mobileData: string) => void,\n    showMessage: (message: string) => void\n  ) {\n    var ACCESS_TOKEN = OtherUtil.getReaderConfig(\"dropbox_token\") || \"\";\n    var dbx = new Dropbox.Dropbox({ accessToken: ACCESS_TOKEN });\n    dbx\n      .filesDownload({\n        path: \"/Apps/KoodoReader/data.zip\",\n      })\n      .then(function (data: any) {\n        let file = data.fileBlob;\n        file.lastModifiedDate = new Date();\n        file.name = \"data.zip\";\n        RestoreUtil.restore(file, handleFinish);\n      })\n      .catch(function (error: any) {\n        showMessage(\"Download failed,network problem or no backup\");\n\n        console.error(error);\n      });\n\n    return false;\n  }\n}\n\nexport default DropboxUitl;\n","import RestoreUtil from \"./restoreUtil\";\r\nimport OtherUtil from \"../otherUtil\";\r\nimport axios from \"axios\";\r\nimport { config } from \"../../constants/driveList\";\r\n\r\nclass WebdavUitl {\r\n  static UploadFile = async (\r\n    file: any,\r\n    handleFinish: () => void,\r\n    showMessage: (message: string) => void\r\n  ) => {\r\n    let { url, username, password } = JSON.parse(\r\n      OtherUtil.getReaderConfig(\"webdav_token\") || \"\"\r\n    );\r\n    let formData = new FormData();\r\n    formData.append(\"file\", file);\r\n    formData.append(\"url\", url);\r\n    formData.append(\"username\", username);\r\n    formData.append(\"password\", password);\r\n\r\n    axios\r\n      .post(`${config.token_url}/webdav_upload`, formData, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n        responseType: \"blob\",\r\n      })\r\n      .then(function (response: any) {\r\n        console.log(response, \"上传成功\");\r\n        handleFinish();\r\n      })\r\n      .catch(function (error: any) {\r\n        console.error(error, \"上传失败\");\r\n        showMessage(\"Upload failed, check your connection\");\r\n      });\r\n\r\n    return false;\r\n  };\r\n  static DownloadFile(\r\n    handleFinish: () => void,\r\n    showMessage: (message: string) => void\r\n  ) {\r\n    let { url, username, password } = JSON.parse(\r\n      OtherUtil.getReaderConfig(\"webdav_token\") || \"\"\r\n    );\r\n    let formData = new FormData();\r\n    formData.append(\"url\", url);\r\n    formData.append(\"username\", username);\r\n    formData.append(\"password\", password);\r\n\r\n    axios\r\n      .post(`${config.token_url}/webdav_download`, formData, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n        responseType: \"blob\",\r\n      })\r\n      .then(function (res: any) {\r\n        let type = \"application/octet-stream\";\r\n        let blobTemp: any = new Blob([res.data], { type: type });\r\n        let fileTemp = new File([blobTemp], \"data.zip\", {\r\n          lastModified: new Date().getTime(),\r\n          type: blobTemp.type,\r\n        });\r\n\r\n        RestoreUtil.restore(fileTemp, handleFinish);\r\n      })\r\n      .catch(function (error: any) {\r\n        showMessage(\"Download failed,network problem or no backup\");\r\n        console.error(error);\r\n      });\r\n\r\n    return false;\r\n  }\r\n}\r\n\r\nexport default WebdavUitl;\r\n","import axios from \"axios\";\r\nimport { config } from \"../../constants/driveList\";\r\nimport OtherUtil from \"../otherUtil\";\r\nimport BookModel from \"../../model/Book\";\r\nimport localforage from \"localforage\";\r\n\r\nexport function getParamsFromUrl() {\r\n  var hashParams: any = {};\r\n  var e,\r\n    r = /([^&;=]+)=?([^&;]*)/g,\r\n    q =\r\n      window.location.hash.substring(2) ||\r\n      window.location.search.substring(1).split(\"#\")[0];\r\n\r\n  while ((e = r.exec(q))) {\r\n    hashParams[e[1]] = decodeURIComponent(e[2]);\r\n  }\r\n  return hashParams;\r\n}\r\nexport const moveData = (blob, driveIndex, books: BookModel[] = []) => {\r\n  let file = new File([blob], \"moveData.zip\", {\r\n    lastModified: new Date().getTime(),\r\n    type: blob.type,\r\n  });\r\n  let formData = new FormData();\r\n  formData.append(\"file\", file);\r\n  formData.append(\r\n    \"dataPath\",\r\n    OtherUtil.getReaderConfig(\"storageLocation\")\r\n      ? OtherUtil.getReaderConfig(\"storageLocation\")\r\n      : window\r\n          .require(\"electron\")\r\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\")\r\n  );\r\n  axios\r\n    .post(`${config.token_url}/move_data`, formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n      responseType: \"blob\",\r\n    })\r\n    .then(async (response: any) => {\r\n      if (driveIndex === 4) {\r\n        let deleteBooks = books.map((item) => {\r\n          return localforage.removeItem(item.key);\r\n        });\r\n        await Promise.all(deleteBooks);\r\n      }\r\n    })\r\n    .catch(function (error: any) {\r\n      console.error(error, \"移动失败\");\r\n    });\r\n};\r\nclass SyncUtil {\r\n  static changeLocation(\r\n    oldPath: string,\r\n    newPath: string,\r\n    handleMessage: (message: string) => void,\r\n    handleMessageBox: (isShow: boolean) => void\r\n  ) {\r\n    axios\r\n      .post(`${config.token_url}/change_location`, {\r\n        oldPath,\r\n        newPath,\r\n      })\r\n      .then(function (response: any) {\r\n        console.log(response, \"修改成功\");\r\n        handleMessage(\"Change Successfully\");\r\n        handleMessageBox(true);\r\n      })\r\n      .catch(function (error: any) {\r\n        console.log(error, \"修改失败\");\r\n        handleMessage(\"Change Failed\");\r\n        handleMessageBox(true);\r\n      });\r\n  }\r\n  static syncData() {}\r\n}\r\n\r\nexport default SyncUtil;\r\n","import FileSaver from \"file-saver\";\r\nimport BookModel from \"../../model/Book\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport BookmarkModel from \"../../model/Bookmark\";\r\nimport DropboxUtil from \"./dropbox\";\r\nimport WebdavUtil from \"./webdav\";\r\nimport localforage from \"localforage\";\r\nimport { moveData } from \"./common\";\r\nimport BookUtil from \"../bookUtil\";\r\n\r\nlet JSZip = (window as any).JSZip;\r\n\r\nclass BackupUtil {\r\n  static backup = async (\r\n    bookArr: BookModel[],\r\n    notes: NoteModel[],\r\n    bookmarks: BookmarkModel[],\r\n    handleFinish: () => void,\r\n    driveIndex: number,\r\n    showMessage: (message: string) => void\r\n  ) => {\r\n    let zip = new JSZip();\r\n    let books = bookArr;\r\n    //0表示备份到本地，1表示备份到dropbox,2表示备份到onedrive,3表示备份到dropbox, 4表示转移数据，5表示同步数据到本地\r\n    if (driveIndex !== 5) {\r\n      let bookZip = zip.folder(\"book\");\r\n      let data: any = [];\r\n      books &&\r\n        books.forEach((item) => {\r\n          data.push(\r\n            driveIndex === 4\r\n              ? localforage.getItem(item.key)\r\n              : BookUtil.fetchBook(item.key)\r\n          );\r\n        });\r\n      let results = await Promise.all(data);\r\n      for (let i = 0; i < books.length; i++) {\r\n        bookZip.file(`${books[i].key}`, results[i]);\r\n      }\r\n    }\r\n    let configZip = zip.folder(\"config\");\r\n    configZip\r\n      .file(\"notes.json\", JSON.stringify(notes))\r\n      .file(\"books.json\", JSON.stringify(books))\r\n      .file(\"bookmarks.json\", JSON.stringify(bookmarks))\r\n      .file(\"readerConfig.json\", localStorage.getItem(\"readerConfig\") || \"\")\r\n      .file(\r\n        \"bookSortCode.json\",\r\n        localStorage.getItem(\"bookSortCode\") ||\r\n          JSON.stringify({ sort: 0, order: 2 })\r\n      )\r\n      .file(\r\n        \"noteSortCode.json\",\r\n        localStorage.getItem(\"noteSortCode\") ||\r\n          JSON.stringify({ sort: 2, order: 2 })\r\n      )\r\n      .file(\"readingTime.json\", localStorage.getItem(\"readingTime\") || \"\")\r\n      .file(\"recentBooks.json\", localStorage.getItem(\"recentBooks\") || [])\r\n      .file(\"favoriteBooks.json\", localStorage.getItem(\"favoriteBooks\") || [])\r\n      .file(\"shelfList.json\", localStorage.getItem(\"shelfList\") || [])\r\n      .file(\"noteTags.json\", localStorage.getItem(\"noteTags\") || [])\r\n      .file(\"pdfjs.history.json\", localStorage.getItem(\"pdfjs.history\") || [])\r\n      .file(\r\n        \"recordLocation.json\",\r\n        localStorage.getItem(\"recordLocation\") || \"\"\r\n      );\r\n\r\n    let year = new Date().getFullYear(),\r\n      month = new Date().getMonth() + 1,\r\n      day = new Date().getDate();\r\n\r\n    zip\r\n      .generateAsync({ type: \"blob\" })\r\n      .then((blob: any) => {\r\n        switch (driveIndex) {\r\n          case 0:\r\n            handleFinish();\r\n            FileSaver.saveAs(\r\n              blob,\r\n              `${year}-${month <= 9 ? \"0\" + month : month}-${\r\n                day <= 9 ? \"0\" + day : day\r\n              }.zip`\r\n            );\r\n            break;\r\n          case 1:\r\n            DropboxUtil.UploadFile(blob, handleFinish, showMessage);\r\n            break;\r\n          case 2:\r\n            break;\r\n          case 3:\r\n            WebdavUtil.UploadFile(\r\n              new File([blob], \"data.zip\", {\r\n                lastModified: new Date().getTime(),\r\n                type: blob.type,\r\n              }),\r\n              handleFinish,\r\n              showMessage\r\n            );\r\n            break;\r\n          case 4:\r\n            moveData(blob, 4, books);\r\n\r\n            break;\r\n          case 5:\r\n            moveData(blob, 5);\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      })\r\n      .catch((err: any) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n}\r\n\r\nexport default BackupUtil;\r\n","//从本地导入书籍\r\nimport React from \"react\";\r\nimport \"./importLocal.css\";\r\nimport BookModel from \"../../model/Book\";\r\nimport localforage from \"localforage\";\r\nimport SparkMD5 from \"spark-md5\";\r\nimport { Trans } from \"react-i18next\";\r\nimport Dropzone from \"react-dropzone\";\r\nimport { ImportLocalProps, ImportLocalState } from \"./interface\";\r\nimport RecordRecent from \"../../utils/readUtils/recordRecent\";\r\nimport axios from \"axios\";\r\nimport { config } from \"../../constants/driveList\";\r\nimport MobiFile from \"../../utils/mobiUtil\";\r\nimport iconv from \"iconv-lite\";\r\nimport isElectron from \"is-electron\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport BookUtil from \"../../utils/bookUtil\";\r\nimport BackupUtil from \"../../utils/syncUtils/backupUtil\";\r\n\r\ndeclare var window: any;\r\nvar pdfjsLib = window[\"pdfjs-dist/build/pdf\"];\r\n\r\nclass ImportLocal extends React.Component<ImportLocalProps, ImportLocalState> {\r\n  constructor(props: ImportLocalProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOpenFile: false,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    if (isElectron()) {\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      ipcRenderer.sendSync(\"start-server\", \"ping\");\r\n      if (!OtherUtil.getReaderConfig(\"storageLocation\"))\r\n        OtherUtil.setReaderConfig(\r\n          \"storageLocation\",\r\n          ipcRenderer.sendSync(\"storage-location\", \"ping\")\r\n        );\r\n      var filePath = ipcRenderer.sendSync(\"get-file-data\");\r\n      if (filePath === null || filePath === \".\") {\r\n        console.log(\"There is no file\");\r\n      } else {\r\n        // Do something with the file.\r\n        fetch(filePath)\r\n          .then((response) => response.body)\r\n          .then((body) => {\r\n            const reader = body!.getReader();\r\n            return new ReadableStream({\r\n              start(controller) {\r\n                return pump();\r\n                function pump(): any {\r\n                  return reader.read().then(({ done, value }) => {\r\n                    // When no more data needs to be consumed, close the stream\r\n                    if (done) {\r\n                      controller.close();\r\n                      return;\r\n                    }\r\n                    // Enqueue the next data chunk into our target stream\r\n                    controller.enqueue(value);\r\n                    return pump();\r\n                  });\r\n                }\r\n              },\r\n            });\r\n          })\r\n          .then((stream) => new Response(stream))\r\n          .then((response) => response.blob())\r\n          .then((blob) => {\r\n            let fileTemp = new File([blob], filePath.split(\"\\\\\").reverse()[0], {\r\n              lastModified: new Date().getTime(),\r\n              type: blob.type,\r\n            });\r\n            this.setState({ isOpenFile: true }, () => {\r\n              this.doIncrementalTest(fileTemp);\r\n            });\r\n          })\r\n          .catch((err) => console.error(err));\r\n      }\r\n    }\r\n  }\r\n\r\n  handleJump = (book: BookModel) => {\r\n    RecentBooks.setRecent(book.key);\r\n    BookUtil.RedirectBook(book);\r\n  };\r\n  handleAddBook = (book: BookModel) => {\r\n    return new Promise<void>((resolve, reject) => {\r\n      let bookArr = [...this.props.books, ...this.props.deletedBooks];\r\n      if (bookArr == null) {\r\n        bookArr = [];\r\n      }\r\n      bookArr.push(book);\r\n      this.props.handleReadingBook(book);\r\n      RecordRecent.setRecent(book.key);\r\n      localforage\r\n        .setItem(\"books\", bookArr)\r\n        .then(() => {\r\n          this.props.handleFetchBooks();\r\n          this.props.handleMessage(\"Add Successfully\");\r\n          this.props.handleMessageBox(true);\r\n          setTimeout(() => {\r\n            this.state.isOpenFile && this.handleJump(book);\r\n            this.setState({ isOpenFile: false });\r\n            this.props.history.push(\"/manager/home\");\r\n          }, 1000);\r\n          setTimeout(() => {\r\n            this.props.handleLoadingDialog(false);\r\n          }, 1000);\r\n          if (isElectron()) {\r\n            BackupUtil.backup(\r\n              bookArr,\r\n              this.props.notes,\r\n              this.props.bookmarks,\r\n              () => {},\r\n              5,\r\n              () => {}\r\n            );\r\n          }\r\n          resolve();\r\n        })\r\n        .catch(() => {\r\n          setTimeout(() => {\r\n            this.props.handleLoadingDialog(false);\r\n          }, 1000);\r\n          reject();\r\n        });\r\n    });\r\n  };\r\n  //获取书籍md5\r\n  doIncrementalTest = (file: any) => {\r\n    let extension = file.name.split(\".\")[file.name.split(\".\").length - 1];\r\n    this.props.handleLoadingDialog(true);\r\n    if (\r\n      !isElectron() &&\r\n      (extension === \"txt\" || extension === \"mobi\" || extension === \"azw3\")\r\n    ) {\r\n      this.props.handleLoadingDialog(false);\r\n      console.log(\"Error occurs\");\r\n      this.props.handleDownloadDesk(true);\r\n      return new Promise<void>((resolve, reject) => {\r\n        reject();\r\n      });\r\n    }\r\n    return new Promise<void>((resolve, reject) => {\r\n      //这里假设直接将文件选择框的dom引用传入\r\n      //这里需要用到File的slice( )方法，以下是兼容写法\r\n\r\n      var blobSlice =\r\n          (File as any).prototype.slice ||\r\n          (File as any).prototype.mozSlice ||\r\n          (File as any).prototype.webkitSlice,\r\n        chunkSize = 2097152, // 以每片2MB大小来逐次读取\r\n        chunks = Math.ceil(file.size / chunkSize),\r\n        currentChunk = 0,\r\n        spark = new SparkMD5(), //创建SparkMD5的实例\r\n        fileReader = new FileReader();\r\n\r\n      fileReader.onload = async (e) => {\r\n        if (!e.target) {\r\n          reject();\r\n          setTimeout(() => {\r\n            this.props.handleLoadingDialog(false);\r\n          }, 1000);\r\n          throw new Error();\r\n        }\r\n        spark.appendBinary(e.target.result as any); // append array buffer\r\n        currentChunk += 1;\r\n        if (currentChunk < chunks) {\r\n          loadNext();\r\n        } else {\r\n          let md5 = spark.end(); // 完成计算，返回结果\r\n          await this.handleBook(file, md5);\r\n          resolve();\r\n        }\r\n      };\r\n\r\n      const loadNext = () => {\r\n        var start = currentChunk * chunkSize,\r\n          end = start + chunkSize >= file.size ? file.size : start + chunkSize;\r\n\r\n        fileReader.readAsBinaryString(blobSlice.call(file, start, end));\r\n      };\r\n\r\n      loadNext();\r\n    });\r\n  };\r\n  handleBook = (file: any, md5: string) => {\r\n    let extension = file.name.split(\".\")[file.name.split(\".\").length - 1];\r\n    let bookName = file.name.substr(0, file.name.length - extension.length - 1);\r\n    return new Promise<void>((resolve, reject) => {\r\n      //md5重复不导入\r\n      let isRepeat = false;\r\n      if ([...this.props.books, ...this.props.deletedBooks].length > 0) {\r\n        [...this.props.books, ...this.props.deletedBooks].forEach((item) => {\r\n          if (item.md5 === md5) {\r\n            isRepeat = true;\r\n            this.props.handleMessage(\"Duplicate Book\");\r\n            this.props.handleMessageBox(true);\r\n            resolve();\r\n          }\r\n        });\r\n      }\r\n      //解析图书，获取图书数据\r\n      if (!isRepeat) {\r\n        let reader = new FileReader();\r\n        reader.readAsArrayBuffer(file);\r\n        reader.onload = async (e) => {\r\n          if (!e.target) {\r\n            this.props.handleMessage(\"Import Failed\");\r\n            this.props.handleMessageBox(true);\r\n            setTimeout(() => {\r\n              this.props.handleLoadingDialog(false);\r\n            }, 1000);\r\n            reject();\r\n            throw new Error();\r\n          }\r\n          if (extension === \"pdf\") {\r\n            if (!e.target) {\r\n              setTimeout(() => {\r\n                this.props.handleLoadingDialog(false);\r\n              }, 1000);\r\n              reject();\r\n              throw new Error();\r\n            }\r\n            pdfjsLib\r\n              .getDocument({ data: e.target.result })\r\n              .promise.then((pdfDoc_: any) => {\r\n                let pdfDoc = pdfDoc_;\r\n                pdfDoc.getMetadata().then((metadata: any) => {\r\n                  pdfDoc.getPage(1).then((page: any) => {\r\n                    var scale = 1.5;\r\n                    var viewport = page.getViewport({\r\n                      scale: scale,\r\n                    });\r\n                    var canvas: any = document.getElementById(\"the-canvas\");\r\n                    var context = canvas.getContext(\"2d\");\r\n                    canvas.height =\r\n                      viewport.height ||\r\n                      viewport.viewBox[3]; /* viewport.height is NaN */\r\n                    canvas.width =\r\n                      viewport.width ||\r\n                      viewport.viewBox[2]; /* viewport.width is also NaN */\r\n                    var task = page.render({\r\n                      canvasContext: context,\r\n                      viewport: viewport,\r\n                    });\r\n                    task.promise.then(async () => {\r\n                      let cover: any = canvas.toDataURL(\"image/jpeg\");\r\n                      let key: string,\r\n                        name: string,\r\n                        author: string,\r\n                        publisher: string,\r\n                        description: string;\r\n                      [name, author, description, publisher] = [\r\n                        metadata.info.Title || bookName,\r\n                        metadata.info.Author || \"Unknown Authur\",\r\n                        \"pdf\",\r\n                        metadata.info.publisher,\r\n                      ];\r\n                      let format = \"PDF\";\r\n                      key = new Date().getTime() + \"\";\r\n                      let book = new BookModel(\r\n                        key,\r\n                        name,\r\n                        author,\r\n                        description,\r\n                        md5,\r\n                        cover,\r\n                        format,\r\n                        publisher\r\n                      );\r\n                      await this.handleAddBook(book);\r\n                      BookUtil.addBook(key, e.target!.result as ArrayBuffer);\r\n                      resolve();\r\n                    });\r\n                  });\r\n                });\r\n              })\r\n              .catch((err: any) => {\r\n                this.props.handleMessage(\"Import Failed\");\r\n                this.props.handleMessageBox(true);\r\n                console.log(\"Error occurs\");\r\n                setTimeout(() => {\r\n                  this.props.handleLoadingDialog(false);\r\n                }, 1000);\r\n                reject();\r\n              });\r\n          } else if (extension === \"mobi\" || extension === \"azw3\") {\r\n            var reader = new FileReader();\r\n            reader.onload = async (event) => {\r\n              const file_content = (event.target as any).result;\r\n              let mobiFile = new MobiFile(file_content);\r\n              let content: any = await mobiFile.render(\r\n                this.props.handleMessage,\r\n                this.props.handleMessageBox\r\n              );\r\n              let buf = iconv.encode(content, \"UTF-8\");\r\n              let blobTemp: any = new Blob([buf], { type: \"text/plain\" });\r\n              let fileTemp = new File([blobTemp], file.name + \".txt\", {\r\n                lastModified: new Date().getTime(),\r\n                type: blobTemp.type,\r\n              });\r\n              this.doIncrementalTest(fileTemp);\r\n            };\r\n            reader.readAsArrayBuffer(file);\r\n          } else if (extension === \"txt\") {\r\n            let formData = new FormData();\r\n            formData.append(\"file\", file);\r\n            axios\r\n              .post(`${config.token_url}/ebook_parser`, formData, {\r\n                headers: {\r\n                  \"Content-Type\": \"multipart/form-data\",\r\n                },\r\n                responseType: \"blob\",\r\n              })\r\n              .then((res) => {\r\n                console.log(res, \"res\");\r\n                let type = \"application/octet-stream\";\r\n                let blobTemp: any = new Blob([res.data], { type: type });\r\n                let fileTemp = new File([blobTemp], bookName + \".epub\", {\r\n                  lastModified: new Date().getTime(),\r\n                  type: blobTemp.type,\r\n                });\r\n\r\n                this.doIncrementalTest(fileTemp);\r\n              })\r\n              .catch((err) => {\r\n                this.props.handleMessage(\"Import Failed\");\r\n                this.props.handleMessageBox(true);\r\n                console.log(err, \"Error occurs\");\r\n                setTimeout(() => {\r\n                  this.props.handleLoadingDialog(false);\r\n                }, 1000);\r\n                reject();\r\n              });\r\n          } else {\r\n            let cover: any = \"\";\r\n            const epub = window.ePub(e.target.result);\r\n            epub.loaded.metadata\r\n              .then((metadata: any) => {\r\n                if (!e.target) {\r\n                  setTimeout(() => {\r\n                    this.props.handleLoadingDialog(false);\r\n                  }, 1000);\r\n                  reject();\r\n                  throw new Error();\r\n                }\r\n                epub\r\n                  .coverUrl()\r\n                  .then(async (url: string) => {\r\n                    if (url) {\r\n                      var reader = new FileReader();\r\n                      let blob = await fetch(url).then((r) => r.blob());\r\n                      reader.readAsDataURL(blob);\r\n                      reader.onloadend = async () => {\r\n                        cover = reader.result;\r\n                        let key: string,\r\n                          name: string,\r\n                          author: string,\r\n                          description: string,\r\n                          publisher: string;\r\n                        [name, author, description, publisher] = [\r\n                          metadata.title,\r\n                          metadata.creator,\r\n                          metadata.description,\r\n                          metadata.publisher,\r\n                        ];\r\n                        let format =\r\n                          publisher === \"mobi\"\r\n                            ? \"MOBI\"\r\n                            : publisher === \"azw3\"\r\n                            ? \"AZW3\"\r\n                            : publisher === \"txt\"\r\n                            ? \"TXT\"\r\n                            : \"EPUB\";\r\n                        key = new Date().getTime() + \"\";\r\n                        let book = new BookModel(\r\n                          key,\r\n                          name,\r\n                          author,\r\n                          description,\r\n                          md5,\r\n                          cover,\r\n                          format,\r\n                          publisher\r\n                        );\r\n                        await this.handleAddBook(book);\r\n                        BookUtil.addBook(key, e.target!.result as ArrayBuffer);\r\n                        resolve();\r\n                      };\r\n                    } else {\r\n                      cover = \"noCover\";\r\n                      let key: string,\r\n                        name: string,\r\n                        author: string,\r\n                        publisher: string,\r\n                        description: string;\r\n                      [name, author, description, publisher] = [\r\n                        metadata.title,\r\n                        metadata.creator,\r\n                        metadata.description,\r\n                        metadata.publisher,\r\n                      ];\r\n                      let format =\r\n                        publisher === \"mobi\"\r\n                          ? \"MOBI\"\r\n                          : publisher === \"azw3\"\r\n                          ? \"AZW3\"\r\n                          : publisher === \"txt\"\r\n                          ? \"TXT\"\r\n                          : \"EPUB\";\r\n                      key = new Date().getTime() + \"\";\r\n                      let book = new BookModel(\r\n                        key,\r\n                        name,\r\n                        author,\r\n                        description,\r\n                        md5,\r\n                        cover,\r\n                        format,\r\n                        publisher\r\n                      );\r\n                      await this.handleAddBook(book);\r\n                      BookUtil.addBook(key, e.target!.result as ArrayBuffer);\r\n                      resolve();\r\n                    }\r\n                  })\r\n                  .catch((err: any) => {\r\n                    console.log(err, \"err\");\r\n                    setTimeout(() => {\r\n                      this.props.handleLoadingDialog(false);\r\n                    }, 1000);\r\n                    reject();\r\n                  });\r\n              })\r\n              .catch(() => {\r\n                this.props.handleMessage(\"Import Failed\");\r\n                this.props.handleMessageBox(true);\r\n                console.log(\"Error occurs\");\r\n                setTimeout(() => {\r\n                  this.props.handleLoadingDialog(false);\r\n                }, 1000);\r\n                reject();\r\n              });\r\n          }\r\n        };\r\n      }\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Dropzone\r\n        onDrop={async (acceptedFiles) => {\r\n          this.props.handleDrag(false);\r\n          for (let i = 0; i < acceptedFiles.length; i++) {\r\n            let extension = acceptedFiles[i].name.split(\".\")[\r\n              acceptedFiles[i].name.split(\".\").length - 1\r\n            ];\r\n            if (\r\n              acceptedFiles.length > 1 &&\r\n              (extension === \"mobi\" ||\r\n                extension === \"txt\" ||\r\n                extension === \"azw3\")\r\n            ) {\r\n              this.props.handleMessage(\r\n                \"Batch import only support epub or pdf files\"\r\n              );\r\n              this.props.handleMessageBox(true);\r\n              return;\r\n            }\r\n\r\n            //异步解析文件\r\n            await this.doIncrementalTest(acceptedFiles[i]);\r\n          }\r\n          setTimeout(() => {\r\n            this.props.handleLoadingDialog(false);\r\n          }, 1000);\r\n        }}\r\n        accept={[\".epub\", \".pdf\", \".txt\", \".mobi\", \".azw3\"]}\r\n        multiple={true}\r\n      >\r\n        {({ getRootProps, getInputProps }) => (\r\n          <div className=\"import-from-local\" {...getRootProps()}>\r\n            <div className=\"animation-mask-local\"></div>\r\n            <span>\r\n              <Trans>Import from Local</Trans>\r\n            </span>\r\n\r\n            <input\r\n              type=\"file\"\r\n              id=\"import-book-box\"\r\n              className=\"import-book-box\"\r\n              name=\"file\"\r\n              {...getInputProps()}\r\n            />\r\n          </div>\r\n        )}\r\n      </Dropzone>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(ImportLocal);\r\n","//从本地导入书籍\r\nimport \"./importLocal.css\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleFetchBooks,\r\n  handleLoadingDialog,\r\n  handleDownloadDesk,\r\n} from \"../../store/actions/manager\";\r\nimport { handleReadingBook } from \"../../store/actions/book\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport ImportLocal from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    notes: state.reader.notes,\r\n    bookmarks: state.reader.bookmarks,\r\n    deletedBooks: state.manager.deletedBooks,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleFetchBooks,\r\n  handleReadingBook,\r\n  handleLoadingDialog,\r\n  handleDownloadDesk,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(ImportLocal as any));\r\n","//提示更新的文字\r\nimport React from \"react\";\r\nimport \"./updateInfo.css\";\r\nimport { UpdateInfoProps, UpdateInfoState } from \"./interface\";\r\nimport { version } from \"../../../package.json\";\r\nimport { Trans } from \"react-i18next\";\r\nimport axios from \"axios\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationNew from \"../../assets/new.json\";\r\nimport animationSuccess from \"../../assets/success.json\";\r\nimport copy from \"copy-text-to-clipboard\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nconst isElectron = require(\"is-electron\");\r\nconst newOptions = {\r\n  loop: false,\r\n  autoplay: true,\r\n  animationData: animationNew,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\nconst successOptions = {\r\n  loop: false,\r\n  autoplay: true,\r\n  animationData: animationSuccess,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\ndeclare var window: any;\r\n\r\nclass UpdateInfo extends React.Component<UpdateInfoProps, UpdateInfoState> {\r\n  constructor(props: UpdateInfoProps) {\r\n    super(props);\r\n    this.state = {\r\n      updateLog: \"\",\r\n      isUpdated: false,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    !this.props.currentBook.key &&\r\n      axios\r\n        .get(`https://koodo.960960.xyz/api/update?name=${navigator.language}`)\r\n        .then((res) => {\r\n          console.log(res);\r\n          const newVersion = res.data.log.version;\r\n\r\n          if (version !== newVersion) {\r\n            this.setState({ updateLog: res.data.log });\r\n            this.props.handleNewDialog(true);\r\n          } else if (\r\n            OtherUtil.getReaderConfig(\"version\") !== newVersion &&\r\n            OtherUtil.getReaderConfig(\"isFirst\")\r\n          ) {\r\n            this.setState({ isUpdated: true });\r\n            this.props.handleNewDialog(true);\r\n            OtherUtil.setReaderConfig(\"version\", newVersion);\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n  }\r\n  renderList = (arr: any[]) => {\r\n    return arr.map((item, index) => {\r\n      return (\r\n        <li className=\"update-dialog-list\" key={index}>\r\n          <span style={{ color: \"black\" }}>{index + 1 + \". \"}</span>\r\n          <span>{item}</span>\r\n        </li>\r\n      );\r\n    });\r\n  };\r\n  handleJump = () => {\r\n    isElectron() &&\r\n      window\r\n        .require(\"electron\")\r\n        .shell.openExternal(\r\n          this.state.isUpdated\r\n            ? \"https://koodo.960960.xyz/log\"\r\n            : \"https://koodo.960960.xyz/download\"\r\n        );\r\n  };\r\n  handleClose = () => {\r\n    this.setState({ updateLog: \"\", isUpdated: false });\r\n    this.props.handleNewDialog(false);\r\n  };\r\n  render() {\r\n    return (\r\n      <>\r\n        {(this.state.updateLog || this.state.isUpdated) && (\r\n          <div\r\n            className=\"new-version\"\r\n            style={\r\n              this.state.isUpdated\r\n                ? { height: \"240px\", top: \"calc(50vh - 120px)\" }\r\n                : {}\r\n            }\r\n          >\r\n            <div className=\"new-version-title\">\r\n              {this.state.isUpdated ? (\r\n                <Trans>Update Complete</Trans>\r\n              ) : (\r\n                <>\r\n                  <Trans>Update to</Trans>\r\n                  {\" \" + this.state.updateLog.version}\r\n                </>\r\n              )}\r\n            </div>\r\n            <div\r\n              className=\"setting-close-container\"\r\n              onClick={() => {\r\n                this.handleClose();\r\n              }}\r\n            >\r\n              <span className=\"icon-close setting-close\"></span>\r\n            </div>\r\n            {this.state.isUpdated && (\r\n              <div className=\"update-info-text\">\r\n                <Trans>You successfully update to</Trans>\r\n                {\" \" + version}\r\n              </div>\r\n            )}\r\n            <div className=\"update-dialog-info\" style={{ height: 420 }}>\r\n              <div className=\"new-version-animation\">\r\n                {this.state.isUpdated ? (\r\n                  <Lottie\r\n                    options={successOptions}\r\n                    height={80}\r\n                    width={80}\r\n                    style={{ marginTop: \"10px\", marginBottom: \"10px\" }}\r\n                  />\r\n                ) : (\r\n                  <Lottie options={newOptions} height={220} width={220} />\r\n                )}\r\n              </div>\r\n              <div\r\n                className=\"new-version-open\"\r\n                onClick={() => {\r\n                  this.handleJump();\r\n                }}\r\n                style={this.state.isUpdated ? { marginTop: \"10px\" } : {}}\r\n              >\r\n                {this.state.isUpdated ? (\r\n                  <>\r\n                    <Trans>Changelog</Trans>\r\n                  </>\r\n                ) : (\r\n                  <Trans>Open link in browser</Trans>\r\n                )}\r\n              </div>\r\n              {this.state.updateLog && (\r\n                <>\r\n                  <div\r\n                    className=\"new-version-copy\"\r\n                    onClick={() => {\r\n                      copy(\"https://koodo.960960.xyz/download\");\r\n                      this.props.handleMessage(\"Copy Successfully\");\r\n                      this.props.handleMessageBox(true);\r\n                    }}\r\n                  >\r\n                    <Trans>Copy Link</Trans>\r\n                  </div>\r\n\r\n                  <p className=\"update-dialog-new-title\">\r\n                    <Trans>What's New</Trans>\r\n                  </p>\r\n                  <ul className=\"update-dialog-new-container\">\r\n                    {this.renderList(this.state.updateLog.new)}\r\n                  </ul>\r\n                  <p className=\"update-dialog-fix-title\">\r\n                    <Trans>What's been fixed</Trans>\r\n                  </p>\r\n                  <ul className=\"update-dialog-fix-container\">\r\n                    {this.renderList(this.state.updateLog.fix)}\r\n                  </ul>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UpdateInfo;\r\n","//左下角的图标外链\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleNewDialog,\r\n} from \"../../store/actions/manager\";\r\nimport UpdateInfo from \"./component\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    books: state.manager.books,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleNewDialog,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(UpdateInfo as any));\r\n","//header 页面\r\nimport React from \"react\";\r\nimport \"./header.css\";\r\nimport SearchBox from \"../../components/searchBox\";\r\nimport ImportLocal from \"../../components/importLocal\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { HeaderProps, HeaderState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport UpdateInfo from \"../../components/updateInfo\";\r\nimport RestoreUtil from \"../../utils/syncUtils/restoreUtil\";\r\nimport BackupUtil from \"../../utils/syncUtils/backupUtil\";\r\n\r\nconst isElectron = require(\"is-electron\");\r\n\r\nclass Header extends React.Component<HeaderProps, HeaderState> {\r\n  constructor(props: HeaderProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOnlyLocal: false,\r\n      language: OtherUtil.getReaderConfig(\"lang\"),\r\n      isNewVersion: false,\r\n    };\r\n  }\r\n  handleSortBooks = () => {\r\n    if (this.props.isSortDisplay) {\r\n      this.props.handleSortDisplay(false);\r\n    } else {\r\n      this.props.handleSortDisplay(true);\r\n    }\r\n  };\r\n  async componentDidMount() {\r\n    if (isElectron()) {\r\n      const fs = window.require(\"fs\");\r\n      const path = window.require(\"path\");\r\n      const { zip } = window.require(\"zip-a-folder\");\r\n      let storageLocation = OtherUtil.getReaderConfig(\"storageLocation\")\r\n        ? OtherUtil.getReaderConfig(\"storageLocation\")\r\n        : window\r\n            .require(\"electron\")\r\n            .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n      let sourcePath = path.join(storageLocation, \"config\");\r\n      let outPath = path.join(storageLocation, \"config.zip\");\r\n      await zip(sourcePath, outPath);\r\n      var data = fs.readFileSync(outPath);\r\n      let blobTemp = new Blob([data], { type: \"application/epub+zip\" });\r\n      let fileTemp = new File([blobTemp], \"config.zip\", {\r\n        lastModified: new Date().getTime(),\r\n        type: blobTemp.type,\r\n      });\r\n\r\n      OtherUtil.getReaderConfig(\"isAutoSync\") === \"yes\" &&\r\n        RestoreUtil.restore(\r\n          fileTemp,\r\n          () => {\r\n            isElectron() &&\r\n              BackupUtil.backup(\r\n                this.props.books,\r\n                this.props.notes,\r\n                this.props.bookmarks,\r\n                () => {},\r\n                5,\r\n                () => {}\r\n              );\r\n          },\r\n          true\r\n        );\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"header\">\r\n        <div className=\"header-search-container\">\r\n          <SearchBox />\r\n        </div>\r\n\r\n        <div\r\n          className=\"header-sort-container\"\r\n          onMouseEnter={() => {\r\n            this.handleSortBooks();\r\n          }}\r\n        >\r\n          <span className=\"header-sort-text\">\r\n            <Trans>Sort</Trans>\r\n          </span>\r\n          <span className=\"icon-sort header-sort-icon\"></span>\r\n        </div>\r\n        <div className=\"setting-icon-container\">\r\n          <span\r\n            className=\"icon-setting setting-icon\"\r\n            onClick={() => {\r\n              this.props.handleSetting(true);\r\n            }}\r\n          ></span>\r\n        </div>\r\n\r\n        <div\r\n          className=\"import-from-cloud\"\r\n          onClick={() => {\r\n            this.props.handleBackupDialog(true);\r\n          }}\r\n        >\r\n          <div className=\"animation-mask\"></div>\r\n          <Trans>Backup and Restore</Trans>\r\n        </div>\r\n        <ImportLocal {...{ handleDrag: this.props.handleDrag }} />\r\n        {isElectron() && <UpdateInfo />}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Header;\r\n","//header 页面\r\nimport { connect } from \"react-redux\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport {\r\n  handleSortDisplay,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleSetting,\r\n} from \"../../store/actions/manager\";\r\nimport { handleBackupDialog } from \"../../store/actions/backupPage\";\r\nimport { stateType } from \"../../store\";\r\nimport Header from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isSearch: state.manager.isSearch,\r\n    bookmarks: state.reader.bookmarks,\r\n    books: state.manager.books,\r\n    notes: state.reader.notes,\r\n    isSortDisplay: state.manager.isSortDisplay,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSortDisplay,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleBackupDialog,\r\n  handleSetting,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(Header as any));\r\n","import BookModel from \"../../model/Book\";\nimport NoteModel from \"../../model/Note\";\nimport BookmarkModel from \"../../model/Bookmark\";\nclass DeleteUtil {\n  static deleteBook(books: BookModel[], bookKey: string) {\n    books = books.filter((item) => item.key !== bookKey);\n    return books;\n  }\n  static deleteBookmarks(bookmarks: BookmarkModel[], bookKey: string) {\n    bookmarks = bookmarks.filter((item) => item.bookKey !== bookKey);\n    return bookmarks;\n  }\n  static deleteNotes(notes: NoteModel[], bookKey: string) {\n    notes = notes.filter((item) => item.bookKey !== bookKey);\n    return notes;\n  }\n}\n\nexport default DeleteUtil;\n","// 记录书本打开记录\r\nconst defaultShelf = {\r\n  New: null,\r\n  Study: [],\r\n  Work: [],\r\n  Entertainment: [],\r\n};\r\nclass ShelfUtil {\r\n  static setShelf(shelfTitle: string, bookKey: string) {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    if (obj[shelfTitle] === undefined) {\r\n      obj[shelfTitle] = [];\r\n    }\r\n    if (obj[shelfTitle].indexOf(bookKey) === -1) {\r\n      obj[shelfTitle].unshift(bookKey);\r\n    }\r\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\r\n  }\r\n\r\n  static getShelf() {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    return obj;\r\n  }\r\n  static clearShelf(shelfIndex: number, bookKey: string) {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    let shelfTitle = Object.keys(obj);\r\n    let currentShelfTitle = shelfTitle[shelfIndex];\r\n    let index = obj[currentShelfTitle].indexOf(bookKey);\r\n    obj[currentShelfTitle].splice(index, 1);\r\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\r\n  }\r\n  static deletefromAllShelf(bookKey: string) {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    let shelfTitle = Object.keys(obj);\r\n    shelfTitle.splice(0, 1);\r\n    shelfTitle.forEach((item) => {\r\n      let index = obj[item].indexOf(bookKey);\r\n      if (index > -1) {\r\n        obj[item].splice(index, 1);\r\n      }\r\n    });\r\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\r\n  }\r\n  static removeShelf(shelfTitle: string) {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    delete obj[shelfTitle];\r\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\r\n  }\r\n}\r\n\r\nexport default ShelfUtil;\r\n","// 阅读期间自动记录当前阅读位置\nclass RecordLocation {\n  static recordCfi(bookKey: string, cfi: string, percentage: number) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json!) || {};\n    obj[bookKey] = { cfi: cfi, percentage: percentage };\n    localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\n  }\n\n  static getCfi(bookKey: string) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json!) || {};\n    return obj[bookKey] || {};\n  }\n  static getAllCfi() {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json!) || {};\n    return obj;\n  }\n  static clear(bookKey: string) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json!) || {};\n    delete obj[bookKey];\n    localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\n  }\n}\n\nexport default RecordLocation;\n","// 记录书本打开记录\nimport BookModel from \"../../model/Book\";\nclass AddFavorite {\n  static setFavorite(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\n      localStorage.getItem(\"favoriteBooks\")\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n      bookArr.unshift(bookKey);\n    } else {\n      bookArr.unshift(bookKey);\n    }\n\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\n  }\n  static setAllFavorite(books: BookModel[]) {\n    let bookArr: string[] = [];\n    books.forEach((item) => {\n      bookArr.push(item.key);\n    });\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\n  }\n  static clear(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\n      localStorage.getItem(\"favoriteBooks\")\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n    }\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\n  }\n  static getAllFavorite() {\n    let bookArr =\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\n      localStorage.getItem(\"favoriteBooks\")\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\n        : [];\n    return bookArr || [];\n  }\n}\n\nexport default AddFavorite;\n","import React from \"react\";\r\nimport \"./deleteDialog.css\";\r\nimport DeleteUtil from \"../../utils/readUtils/deleteUtil\";\r\nimport localforage from \"localforage\";\r\nimport ShelfUtil from \"../../utils/readUtils/shelfUtil\";\r\nimport RecordRecent from \"../../utils/readUtils/recordRecent\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { DeleteDialogProps } from \"./interface\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport AddTrash from \"../../utils/readUtils/addTrash\";\r\nimport BookUtil from \"../../utils/bookUtil\";\r\n\r\nclass DeleteDialog extends React.Component<DeleteDialogProps> {\r\n  handleCancel = () => {\r\n    this.props.handleDeleteDialog(false);\r\n  };\r\n  handleDeleteOther = (key: string) => {\r\n    if (this.props.bookmarks[0]) {\r\n      let bookmarkArr = DeleteUtil.deleteBookmarks(this.props.bookmarks, key);\r\n      if (bookmarkArr.length === 0) {\r\n        localforage.removeItem(\"bookmarks\");\r\n      } else {\r\n        localforage.setItem(\"bookmarks\", bookmarkArr);\r\n      }\r\n    }\r\n    if (this.props.notes) {\r\n      let noteArr = DeleteUtil.deleteNotes(this.props.notes, key);\r\n      if (noteArr.length === 0) {\r\n        localforage.removeItem(\"notes\");\r\n      } else {\r\n        localforage.setItem(\"notes\", noteArr);\r\n      }\r\n    }\r\n  };\r\n  handleComfirm = async () => {\r\n    //从列表删除和从图书库删除判断\r\n    if (this.props.mode === \"shelf\") {\r\n      ShelfUtil.clearShelf(this.props.shelfIndex, this.props.currentBook.key);\r\n    } else if (this.props.mode === \"trash\") {\r\n      let keyArr = AddTrash.getAllTrash();\r\n      for (let i = 0; i < keyArr.length; i++) {\r\n        await this.deleteBook(keyArr[i]);\r\n      }\r\n\r\n      if (this.props.books.length === 1) {\r\n        this.props.history.push(\"/manager/empty\");\r\n      }\r\n      this.props.handleFetchBooks();\r\n      this.props.handleFetchBookmarks();\r\n      this.props.handleFetchNotes();\r\n    } else {\r\n      AddTrash.setTrash(this.props.currentBook.key);\r\n      //从喜爱的图书中删除\r\n      AddFavorite.clear(this.props.currentBook.key);\r\n      this.props.handleFetchBooks();\r\n    }\r\n    this.props.handleDeleteDialog(false);\r\n    this.props.handleMessage(\"Delete Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  deleteBook = (key: string) => {\r\n    return new Promise<void>((resolve, reject) => {\r\n      this.props.books &&\r\n        localforage\r\n          .setItem(\"books\", DeleteUtil.deleteBook(this.props.books, key))\r\n          .then(async () => {\r\n            await BookUtil.deleteBook(key);\r\n            //从喜爱的图书中删除\r\n            AddFavorite.clear(key);\r\n            //从回收的图书中删除\r\n            AddTrash.clear(key);\r\n            //从书架删除\r\n            ShelfUtil.deletefromAllShelf(key);\r\n            //从阅读记录删除\r\n            RecordRecent.clear(key);\r\n            //删除阅读历史\r\n            RecordLocation.clear(key);\r\n            //删除书签，笔记，书摘，高亮\r\n            this.handleDeleteOther(key);\r\n            resolve();\r\n          })\r\n          .catch(() => {\r\n            reject();\r\n          });\r\n    });\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"delete-dialog-container\">\r\n        {this.props.mode === \"shelf\" ? (\r\n          <div className=\"delete-dialog-title\">\r\n            <Trans>Delete from Shelf</Trans>\r\n          </div>\r\n        ) : this.props.mode === \"trash\" ? (\r\n          <div className=\"delete-dialog-title\">\r\n            <Trans>Delete All Books</Trans>\r\n          </div>\r\n        ) : (\r\n          <div className=\"delete-dialog-title\">\r\n            <Trans>Delete This Book</Trans>\r\n          </div>\r\n        )}\r\n        {this.props.mode === \"trash\" ? null : (\r\n          <div className=\"delete-dialog-book\">\r\n            <div className=\"delete-dialog-book-title\">\r\n              {this.props.currentBook.name}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {this.props.mode === \"shelf\" ? (\r\n          <div className=\"delete-dialog-other-option\">\r\n            <Trans>This action won't delete the original book</Trans>\r\n          </div>\r\n        ) : this.props.mode === \"trash\" ? (\r\n          <div className=\"delete-dialog-other-option\" style={{ top: \"80px\" }}>\r\n            <Trans>\r\n              This action will remove all the books in recycle bin,together with\r\n              their notes, bookmarks and digests\r\n            </Trans>\r\n          </div>\r\n        ) : (\r\n          <div className=\"delete-dialog-other-option\">\r\n            <Trans>\r\n              This action will move this book and its the notes, bookmarks and\r\n              digests of this book to the recycle bin\r\n            </Trans>\r\n          </div>\r\n        )}\r\n        <div\r\n          className=\"delete-dialog-cancel\"\r\n          onClick={() => {\r\n            this.handleCancel();\r\n          }}\r\n        >\r\n          <Trans>Cancel</Trans>\r\n        </div>\r\n        <div\r\n          className=\"delete-dialog-comfirm\"\r\n          onClick={() => {\r\n            this.handleComfirm();\r\n          }}\r\n        >\r\n          <Trans>Delete</Trans>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(DeleteDialog);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleFetchBooks,\r\n  handleMessageBox,\r\n  handleMessage,\r\n} from \"../../store/actions/manager\";\r\nimport {\r\n  handleDeleteDialog,\r\n  handleActionDialog,\r\n} from \"../../store/actions/book\";\r\nimport {\r\n  handleFetchBookmarks,\r\n  handleFetchNotes,\r\n} from \"../../store/actions/reader\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport DeleteDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n    mode: state.sidebar.mode,\r\n    shelfIndex: state.sidebar.shelfIndex,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchBooks,\r\n  handleDeleteDialog,\r\n  handleFetchBookmarks,\r\n  handleFetchNotes,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleActionDialog,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(DeleteDialog as any));\r\n","//编辑图书对话框\nimport React from \"react\";\nimport \"./editDialog.css\";\nimport localforage from \"localforage\";\nimport { Trans } from \"react-i18next\";\nimport { EditDialogProps, EditDialogState } from \"./interface\";\n\nclass EditDialog extends React.Component<EditDialogProps, EditDialogState> {\n  constructor(props: EditDialogProps) {\n    super(props);\n    this.state = { isCheck: false };\n  }\n  componentDidMount() {\n    const nameBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-name-box\"\n    ) as HTMLInputElement;\n    const authorBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-author-box\"\n    ) as HTMLInputElement;\n    nameBox.value = this.props.currentBook.name;\n    authorBox.value = this.props.currentBook.author;\n  }\n\n  handleCancel = () => {\n    this.props.handleEditDialog(false);\n  };\n  handleComfirm = () => {\n    const nameBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-name-box\"\n    ) as HTMLInputElement;\n    let name = nameBox.value;\n    const authorBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-author-box\"\n    ) as HTMLInputElement;\n    let author = authorBox.value;\n    let { books } = this.props;\n    books.forEach((item) => {\n      if (item.key === this.props.currentBook.key) {\n        item.name = name;\n        item.author = author;\n        return false;\n      }\n    });\n    localforage.setItem(\"books\", books).then(() => {\n      this.props.handleEditDialog(false);\n      this.props.handleFetchBooks();\n    });\n    this.props.handleMessage(\"Edit Successfully\");\n    this.props.handleMessageBox(true);\n    this.props.handleActionDialog(false);\n  };\n  render() {\n    return (\n      <div className=\"edit-dialog-container\">\n        <div className=\"edit-dialog-title\">\n          <Trans>Edit Book</Trans>\n        </div>\n        <div className=\"edit-dialog-book-name-container\">\n          <div className=\"edit-dialog-book-name-text\">\n            <Trans>Book Name</Trans>\n          </div>\n          <input className=\"edit-dialog-book-name-box\" />\n        </div>\n        <div className=\"edit-dialog-book-author-container\">\n          <div className=\"edit-dialog-book-author-text\">\n            <Trans>Author</Trans>\n          </div>\n          <input className=\"edit-dialog-book-author-box\" />\n        </div>\n        <div\n          className=\"edit-dialog-cancel\"\n          onClick={() => {\n            this.handleCancel();\n          }}\n        >\n          <Trans>Cancel</Trans>\n        </div>\n        <div\n          className=\"edit-dialog-comfirm\"\n          onClick={() => {\n            this.handleComfirm();\n          }}\n        >\n          <Trans>Confirm</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default EditDialog;\n","//编辑图书对话框\r\nimport { connect } from \"react-redux\";\r\nimport \"./editDialog.css\";\r\nimport {\r\n  handleFetchBooks,\r\n  handleMessageBox,\r\n  handleMessage,\r\n} from \"../../store/actions/manager\";\r\nimport { handleEditDialog, handleActionDialog } from \"../../store/actions/book\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport EditDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchBooks,\r\n  handleEditDialog,\r\n  handleActionDialog,\r\n  handleMessageBox,\r\n  handleMessage,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(EditDialog as any));\r\n","//添加图书到书架的对话框\r\nimport React, { Component } from \"react\";\r\nimport \"./addDialog.css\";\r\nimport ShelfUtil from \"../../utils/readUtils/shelfUtil\";\r\nimport { Trans, NamespacesConsumer } from \"react-i18next\";\r\nimport { AddDialogProps, AddDialogState } from \"./interface\";\r\n\r\nclass AddDialog extends Component<AddDialogProps, AddDialogState> {\r\n  constructor(props: AddDialogProps) {\r\n    super(props);\r\n    this.state = { isNew: true, shelfTitle: \"\" };\r\n  }\r\n\r\n  handleCancel = () => {\r\n    this.props.handleAddDialog(false);\r\n  };\r\n  handleComfirm = () => {\r\n    const inputElement: HTMLInputElement = document.querySelector(\r\n      \".add-dialog-new-shelf-box\"\r\n    ) as HTMLInputElement;\r\n    let shelfTitle: string = this.state.shelfTitle;\r\n    let shelfList = ShelfUtil.getShelf();\r\n    let shelfTitles = Object.keys(ShelfUtil.getShelf());\r\n    let shelfIndex = this.state.isNew\r\n      ? shelfTitles.length\r\n      : shelfTitles.indexOf(inputElement.value);\r\n    if (this.state.isNew) {\r\n      shelfTitle = inputElement.value;\r\n      if (shelfList.hasOwnProperty(shelfTitle)) {\r\n        this.props.handleMessage(\"Duplicate Shelf\");\r\n        this.props.handleMessageBox(true);\r\n        return;\r\n      }\r\n    }\r\n    //未填书架名提醒\r\n    if (!shelfTitle) {\r\n      this.props.handleMessage(\"Empty Shelf Title\");\r\n      this.props.handleMessageBox(true);\r\n      return;\r\n    }\r\n    //判断书架中是否已有该图书\r\n    if (\r\n      shelfList[`${shelfTitle}`] &&\r\n      shelfList[`${shelfTitle}`].indexOf(this.props.currentBook.key) > -1\r\n    ) {\r\n      this.props.handleMessage(\"Duplicate Book\");\r\n      this.props.handleMessageBox(true);\r\n      return;\r\n    }\r\n\r\n    ShelfUtil.setShelf(shelfTitle, this.props.currentBook.key);\r\n    this.props.handleAddDialog(false);\r\n    this.props.handleMessage(\"Add Successfully\");\r\n    this.props.handleMessageBox(true);\r\n    this.props.handleActionDialog(false);\r\n    this.props.handleMode(\"shelf\");\r\n    this.props.handleShelfIndex(shelfIndex);\r\n  };\r\n  //如果是添加到已存在的书架就diable新建图书的input框\r\n  handleChange = (shelfTitle: string) => {\r\n    if (shelfTitle === \"New\") {\r\n      this.setState({ isNew: true });\r\n    } else {\r\n      this.setState({ shelfTitle });\r\n      this.setState({ isNew: false });\r\n    }\r\n  };\r\n  render() {\r\n    const renderShelfList = () => {\r\n      let shelfList = ShelfUtil.getShelf();\r\n      let shelfTitle = Object.keys(shelfList);\r\n      return shelfTitle.map((item) => {\r\n        return (\r\n          <NamespacesConsumer>\r\n            {(t) => (\r\n              <option\r\n                value={item}\r\n                key={item}\r\n                className=\"add-dialog-shelf-list-option\"\r\n              >\r\n                {t(item)}\r\n              </option>\r\n            )}\r\n          </NamespacesConsumer>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div className=\"add-dialog-container\">\r\n        <div className=\"add-dialog-title\">\r\n          <Trans>Add to Shelf</Trans>\r\n        </div>\r\n        <div className=\"add-dialog-shelf-list-container\">\r\n          <div className=\"add-dialog-shelf-list-text\">\r\n            <Trans>Select</Trans>\r\n          </div>\r\n          <select\r\n            className=\"add-dialog-shelf-list-box\"\r\n            onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\r\n              this.handleChange(event.target.value);\r\n            }}\r\n          >\r\n            {renderShelfList()}\r\n          </select>\r\n        </div>\r\n        <div className=\"add-dialog-new-shelf-container\">\r\n          <div className=\"add-dialog-new-shelf-text\">\r\n            <Trans>New Shelf</Trans>\r\n          </div>\r\n          <input\r\n            className=\"add-dialog-new-shelf-box\"\r\n            disabled={!this.state.isNew}\r\n          />\r\n        </div>\r\n        <div\r\n          className=\"add-dialog-cancel\"\r\n          onClick={() => {\r\n            this.handleCancel();\r\n          }}\r\n        >\r\n          <Trans>Cancel</Trans>\r\n        </div>\r\n        <div\r\n          className=\"add-dialog-comfirm\"\r\n          onClick={() => {\r\n            this.handleComfirm();\r\n          }}\r\n        >\r\n          <Trans>Confirm</Trans>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AddDialog;\r\n","//添加图书到书架的对话框\r\nimport { connect } from \"react-redux\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport { handleAddDialog, handleActionDialog } from \"../../store/actions/book\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport AddDialog from \"./component\";\r\nimport { handleMode, handleShelfIndex } from \"../../store/actions/sidebar\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleAddDialog,\r\n  handleActionDialog,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleMode,\r\n  handleShelfIndex,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(AddDialog as any));\r\n","//排序弹窗\r\nimport React from \"react\";\r\nimport \"./sortDialog.css\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { SortDialogProps, SortDialogState } from \"./interface\";\r\n\r\nclass SortDialog extends React.Component<SortDialogProps, SortDialogState> {\r\n  constructor(props: SortDialogProps) {\r\n    super(props);\r\n    this.state = {\r\n      isNote: this.props.mode === \"note\" || this.props.mode === \"digest\",\r\n    };\r\n  }\r\n  handleSort = (code: number) => {\r\n    if (this.state.isNote) {\r\n      let noteSortCode = this.props.noteSortCode;\r\n      noteSortCode.sort = code;\r\n      this.props.handleNoteSortCode(noteSortCode);\r\n      this.props.handleNoteSort(true);\r\n      OtherUtil.setNoteSortCode(code, this.props.noteSortCode.order);\r\n    } else {\r\n      let bookSortCode = this.props.bookSortCode;\r\n      bookSortCode.sort = code;\r\n      this.props.handleBookSortCode(bookSortCode);\r\n      this.props.handleBookSort(true);\r\n      OtherUtil.setBookSortCode(code, this.props.bookSortCode.order);\r\n    }\r\n  };\r\n  handleOrder = (code: number) => {\r\n    if (this.state.isNote) {\r\n      let noteSortCode = this.props.noteSortCode;\r\n      noteSortCode.order = code;\r\n      this.props.handleNoteSort(true);\r\n      OtherUtil.setNoteSortCode(this.props.noteSortCode.sort, code);\r\n      this.props.handleNoteSortCode(noteSortCode);\r\n    } else {\r\n      let bookSortCode = this.props.bookSortCode;\r\n      bookSortCode.order = code;\r\n      this.props.handleBookSort(true);\r\n      OtherUtil.setBookSortCode(this.props.bookSortCode.sort, code);\r\n      this.props.handleBookSortCode(bookSortCode);\r\n    }\r\n  };\r\n  handleSortBooks = () => {\r\n    if (this.props.isSortDisplay) {\r\n      this.props.handleSortDisplay(false);\r\n    } else {\r\n      this.props.handleSortDisplay(true);\r\n    }\r\n  };\r\n  render() {\r\n    let sortCode = this.state.isNote\r\n      ? this.props.noteSortCode\r\n      : this.props.bookSortCode;\r\n    return (\r\n      <div\r\n        className=\"sort-dialog-container\"\r\n        onMouseLeave={() => {\r\n          this.handleSortBooks();\r\n        }}\r\n        style={\r\n          this.props.isSortDisplay\r\n            ? { boxShadow: \"0px 0px 5px rgba(0, 0, 0, 0.18)\" }\r\n            : { height: \"20px\" }\r\n        }\r\n        // style={this.state.isNote ? { height: \"120px\" } : {}}\r\n      >\r\n        {this.state.isNote ? (\r\n          <ul className=\"sort-by-category\">\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                this.handleSort(1);\r\n              }}\r\n              style={\r\n                sortCode.sort === 1 ? { color: \"rgba(75, 75, 75, 1)\" } : {}\r\n              }\r\n            >\r\n              <Trans>Sort by Name</Trans>\r\n            </li>\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                this.handleSort(2);\r\n              }}\r\n              style={\r\n                sortCode.sort === 2 ? { color: \"rgba(75, 75, 75, 1)\" } : {}\r\n              }\r\n            >\r\n              <Trans>Sort by Date</Trans>\r\n            </li>\r\n          </ul>\r\n        ) : (\r\n          <ul className=\"sort-by-category\">\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                this.handleSort(0);\r\n              }}\r\n              style={\r\n                sortCode.sort === 0 ? { color: \"rgba(75, 75, 75, 1)\" } : {}\r\n              }\r\n            >\r\n              <Trans>Sort by Recent</Trans>\r\n            </li>\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                this.handleSort(1);\r\n              }}\r\n              style={\r\n                sortCode.sort === 1 ? { color: \"rgba(75, 75, 75, 1)\" } : {}\r\n              }\r\n            >\r\n              <Trans>Sort by Name</Trans>\r\n            </li>\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                this.handleSort(2);\r\n              }}\r\n              style={\r\n                sortCode.sort === 2 ? { color: \"rgba(75, 75, 75, 1)\" } : {}\r\n              }\r\n            >\r\n              <Trans>Sort by Date</Trans>\r\n            </li>\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                this.handleSort(3);\r\n              }}\r\n              style={\r\n                sortCode.sort === 3 ? { color: \"rgba(75, 75, 75, 1)\" } : {}\r\n              }\r\n            >\r\n              <Trans>Sort by Duration</Trans>\r\n            </li>\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                this.handleSort(4);\r\n              }}\r\n              style={\r\n                sortCode.sort === 4 ? { color: \"rgba(75, 75, 75, 1)\" } : {}\r\n              }\r\n            >\r\n              <Trans>Sort by Author</Trans>\r\n            </li>\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                this.handleSort(5);\r\n              }}\r\n              style={\r\n                sortCode.sort === 5 ? { color: \"rgba(75, 75, 75, 1)\" } : {}\r\n              }\r\n            >\r\n              <Trans>Sort by Percentage</Trans>\r\n            </li>\r\n          </ul>\r\n        )}\r\n        <div className=\"sort-dialog-seperator\"></div>\r\n        <ul className=\"sort-by-order\">\r\n          <li\r\n            className=\"sort-by-order-list\"\r\n            onClick={() => {\r\n              this.handleOrder(1);\r\n            }}\r\n            style={sortCode.order === 1 ? { color: \"rgba(75, 75, 75, 1)\" } : {}}\r\n          >\r\n            <Trans>Ascending Order</Trans>\r\n          </li>\r\n          <li\r\n            className=\"sort-by-order-list\"\r\n            onClick={() => {\r\n              this.handleOrder(2);\r\n            }}\r\n            style={sortCode.order === 2 ? { color: \"rgba(75, 75, 75, 1)\" } : {}}\r\n          >\r\n            <Trans>Descending Order</Trans>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SortDialog;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleBookSortCode,\r\n  handleNoteSortCode,\r\n  handleSortDisplay,\r\n  handleBookSort,\r\n  handleNoteSort,\r\n} from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport SortDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    bookSortCode: state.manager.bookSortCode,\r\n    noteSortCode: state.manager.noteSortCode,\r\n    mode: state.sidebar.mode,\r\n    isSortDisplay: state.manager.isSortDisplay,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleBookSortCode,\r\n  handleSortDisplay,\r\n  handleNoteSortCode,\r\n  handleBookSort,\r\n  handleNoteSort,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(SortDialog as any));\r\n","//消息提示\nimport React from \"react\";\nimport \"./messageBox.css\";\nimport { Trans } from \"react-i18next\";\nimport { MessageBoxProps } from \"./interface\";\n\nclass MessageBox extends React.Component<MessageBoxProps> {\n  render() {\n    return (\n      <div className=\"message-box-container-parent\">\n        <div className=\"message-box-container\">\n          <span className=\"icon-success  message-box-icon\"></span>\n          <div className=\"message-content\">\n            <Trans>{this.props.message}</Trans>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default MessageBox;\n","//消息提示\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport MessageBox from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    message: state.manager.message,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(MessageBox as any));\r\n","//绑定网盘的弹窗\r\nimport React, { Component } from \"react\";\r\nimport \"./tokenDialog.css\";\r\nimport copy from \"copy-text-to-clipboard\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { TokenDialogProps, TokenDialogState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\n\r\nclass TokenDialog extends Component<TokenDialogProps, TokenDialogState> {\r\n  constructor(props: TokenDialogProps) {\r\n    super(props);\r\n    this.state = { isNew: false };\r\n  }\r\n\r\n  handleCancel = () => {\r\n    this.props.handleTokenDialog(false);\r\n  };\r\n  handleTokenComfirm = () => {\r\n    let token: string = (document.querySelector(\r\n      \".token-dialog-token-box\"\r\n    ) as HTMLTextAreaElement).value;\r\n    OtherUtil.setReaderConfig(`${this.props.driveName}_token`, token);\r\n    this.props.handleTokenDialog(false);\r\n    this.props.handleMessage(\"Add Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleDavComfirm = () => {\r\n    let url: string = (document.querySelector(\r\n      \".token-dialog-url-box\"\r\n    ) as HTMLTextAreaElement).value;\r\n    let username: string = (document.querySelector(\r\n      \".token-dialog-username-box\"\r\n    ) as HTMLTextAreaElement).value;\r\n    let password: string = (document.querySelector(\r\n      \".token-dialog-password-box\"\r\n    ) as HTMLTextAreaElement).value;\r\n    OtherUtil.setReaderConfig(\r\n      `${this.props.driveName}_token`,\r\n      JSON.stringify({ url, username, password })\r\n    );\r\n    this.props.handleTokenDialog(false);\r\n    this.props.handleMessage(\"Add Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"token-dialog-container\">\r\n        <div className=\"token-dialog-box\">\r\n          <div className=\"token-dialog-title\">\r\n            <Trans>Bind</Trans>\r\n            &nbsp;\r\n            {this.props.driveName}&nbsp;\r\n            <Trans>Token</Trans>\r\n          </div>\r\n          {this.props.driveName === \"webdav\" ? (\r\n            <>\r\n              <div\r\n                className=\"token-dialog-info-text\"\r\n                style={\r\n                  OtherUtil.getReaderConfig(\"lang\") === \"en\"\r\n                    ? { fontSize: \"14px\" }\r\n                    : {}\r\n                }\r\n              >\r\n                <Trans>Webdav Info</Trans>\r\n              </div>\r\n              <input\r\n                type=\"text\"\r\n                name=\"username\"\r\n                placeholder={this.props.t(\"Server Address\")}\r\n                id=\"token-dialog-url-box\"\r\n                className=\"token-dialog-url-box\"\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                name=\"username\"\r\n                placeholder={this.props.t(\"Username\")}\r\n                id=\"token-dialog-username-box\"\r\n                className=\"token-dialog-username-box\"\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                name=\"username\"\r\n                placeholder={this.props.t(\"Password\")}\r\n                id=\"token-dialog-password-box\"\r\n                className=\"token-dialog-password-box\"\r\n              />\r\n            </>\r\n          ) : (\r\n            <>\r\n              <div\r\n                className=\"token-dialog-info-text\"\r\n                style={\r\n                  OtherUtil.getReaderConfig(\"lang\") === \"en\"\r\n                    ? { fontSize: \"14px\" }\r\n                    : {}\r\n                }\r\n              >\r\n                <Trans>Token Info</Trans>\r\n              </div>\r\n              <div\r\n                className=\"token-dialog-link-text\"\r\n                onClick={() => {\r\n                  copy(this.props.url);\r\n                  this.props.handleMessage(\"Copy Successfully\");\r\n                  this.props.handleMessageBox(true);\r\n                }}\r\n              >\r\n                <Trans>Copy Link</Trans>\r\n              </div>\r\n              <textarea className=\"token-dialog-token-box\" />\r\n            </>\r\n          )}\r\n\r\n          <div\r\n            className=\"token-dialog-cancel\"\r\n            onClick={() => {\r\n              this.handleCancel();\r\n            }}\r\n          >\r\n            <Trans>Cancel</Trans>\r\n          </div>\r\n          <div\r\n            className=\"token-dialog-comfirm\"\r\n            onClick={() => {\r\n              if (this.props.driveName === \"webdav\") {\r\n                this.handleDavComfirm();\r\n              } else {\r\n                this.handleTokenComfirm();\r\n              }\r\n            }}\r\n          >\r\n            <Trans>Confirm</Trans>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TokenDialog;\r\n","//添加图书到书架的对话框\r\nimport { connect } from \"react-redux\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport { handleTokenDialog } from \"../../store/actions/backupPage\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport TokenDialog from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleTokenDialog,\r\n  handleMessageBox,\r\n  handleMessage,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(TokenDialog as any));\r\n","//备份和恢复页面\r\nimport React from \"react\";\r\nimport \"./backupDialog.css\";\r\nimport { driveList } from \"../../constants/driveList\";\r\nimport BackupUtil from \"../../utils/syncUtils/backupUtil\";\r\nimport RestoreUtil from \"../../utils/syncUtils/restoreUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nimport DropboxUtil from \"../../utils/syncUtils/dropbox\";\r\nimport WebdavUtil from \"../../utils/syncUtils/webdav\";\r\nimport { BackupDialogProps, BackupDialogState } from \"./interface\";\r\nimport TokenDialog from \"../../components/tokenDialog\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport isElectron from \"is-electron\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationSuccess from \"../../assets/success.json\";\r\n\r\nconst successOptions = {\r\n  loop: false,\r\n  autoplay: true,\r\n  animationData: animationSuccess,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\nclass BackupDialog extends React.Component<\r\n  BackupDialogProps,\r\n  BackupDialogState\r\n> {\r\n  constructor(props: BackupDialogProps) {\r\n    super(props);\r\n    this.state = {\r\n      currentStep: 0,\r\n      isBackup: \"\",\r\n      currentDrive: 0,\r\n    };\r\n  }\r\n  handleClose = () => {\r\n    this.props.handleBackupDialog(false);\r\n  };\r\n\r\n  handleFinish = () => {\r\n    this.setState({ currentStep: 2 });\r\n    this.props.handleLoadingDialog(false);\r\n    isElectron() &&\r\n      BackupUtil.backup(\r\n        this.props.books,\r\n        this.props.notes,\r\n        this.props.bookmarks,\r\n        () => {},\r\n        5,\r\n        () => {}\r\n      );\r\n  };\r\n  handleRestoreToLocal = (event: any) => {\r\n    event.preventDefault();\r\n    RestoreUtil.restore(event.target.files[0], this.handleFinish);\r\n  };\r\n  showMessage = (message: string) => {\r\n    this.props.handleMessage(message);\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleDrive = (index: number) => {\r\n    this.setState({ currentDrive: index }, () => {\r\n      switch (index) {\r\n        case 0:\r\n          BackupUtil.backup(\r\n            this.props.books,\r\n            this.props.notes,\r\n            this.props.bookmarks,\r\n            this.handleFinish,\r\n            0,\r\n            this.showMessage\r\n          );\r\n          break;\r\n        case 1:\r\n          if (!OtherUtil.getReaderConfig(\"dropbox_token\")) {\r\n            this.props.handleTokenDialog(true);\r\n            break;\r\n          }\r\n\r\n          if (this.state.isBackup === \"yes\") {\r\n            this.showMessage(\"Uploading\");\r\n            this.props.handleLoadingDialog(true);\r\n\r\n            BackupUtil.backup(\r\n              this.props.books,\r\n              this.props.notes,\r\n              this.props.bookmarks,\r\n              this.handleFinish,\r\n              1,\r\n              this.showMessage\r\n            );\r\n          } else {\r\n            this.props.handleLoadingDialog(true);\r\n            this.showMessage(\"Downloading\");\r\n            DropboxUtil.DownloadFile(this.handleFinish, this.showMessage);\r\n          }\r\n\r\n          break;\r\n        case 2:\r\n          this.showMessage(\"Coming Soon\");\r\n          break;\r\n\r\n        case 3:\r\n          if (!isElectron()) {\r\n            this.props.handleDownloadDesk(true);\r\n            break;\r\n          }\r\n          if (!OtherUtil.getReaderConfig(\"webdav_token\")) {\r\n            this.props.handleTokenDialog(true);\r\n            break;\r\n          }\r\n          if (this.state.isBackup === \"yes\") {\r\n            this.showMessage(\"Uploading\");\r\n            this.props.handleLoadingDialog(true);\r\n\r\n            BackupUtil.backup(\r\n              this.props.books,\r\n              this.props.notes,\r\n              this.props.bookmarks,\r\n              this.handleFinish,\r\n              3,\r\n              this.showMessage\r\n            );\r\n          } else {\r\n            this.showMessage(\"Downloading\");\r\n            this.props.handleLoadingDialog(true);\r\n\r\n            WebdavUtil.DownloadFile(this.handleFinish, this.showMessage);\r\n          }\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    });\r\n  };\r\n  render() {\r\n    const renderDrivePage = () => {\r\n      return driveList.map((item, index) => {\r\n        return (\r\n          <li\r\n            key={item.id}\r\n            className=\"backup-page-list-item\"\r\n            onClick={() => {\r\n              this.handleDrive(index);\r\n            }}\r\n            style={index !== 2 ? { opacity: 1 } : {}}\r\n          >\r\n            <div className=\"backup-page-list-item-container\">\r\n              <span\r\n                className={`icon-${item.icon} backup-page-list-icon`}\r\n              ></span>\r\n              {OtherUtil.getReaderConfig(\"dropbox_token\") && index === 1 ? (\r\n                <div\r\n                  className=\"backup-page-list-title\"\r\n                  onClick={() => {\r\n                    OtherUtil.setReaderConfig(\"dropbox_token\", \"\");\r\n                    this.showMessage(\"Unauthorize Successfully\");\r\n                  }}\r\n                  style={{ color: \"rgb(0, 120, 212)\" }}\r\n                >\r\n                  <Trans>Unauthorize</Trans>\r\n                </div>\r\n              ) : OtherUtil.getReaderConfig(\"webdav_token\") && index === 3 ? (\r\n                <div\r\n                  className=\"backup-page-list-title\"\r\n                  onClick={() => {\r\n                    OtherUtil.setReaderConfig(\"webdav_token\", \"\");\r\n                    this.showMessage(\"Unauthorize Successfully\");\r\n                  }}\r\n                  style={{ color: \"rgb(0, 120, 212)\" }}\r\n                >\r\n                  <Trans>Unauthorize</Trans>\r\n                </div>\r\n              ) : (\r\n                <div className=\"backup-page-list-title\">\r\n                  <Trans>{item.name}</Trans>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    const dialogProps = {\r\n      driveName: driveList[this.state.currentDrive!].icon,\r\n      url: driveList[this.state.currentDrive!].url,\r\n    };\r\n    return (\r\n      <div className=\"backup-page-container\">\r\n        {this.props.isOpenTokenDialog ? <TokenDialog {...dialogProps} /> : null}\r\n        {this.state.currentStep === 0 ? (\r\n          <div className=\"backup-page-title\">\r\n            <Trans>Do you want to backup or restore?</Trans>\r\n          </div>\r\n        ) : this.state.currentStep === 1 && this.state.isBackup === \"yes\" ? (\r\n          <div className=\"backup-page-title\">\r\n            <Trans>Where to keep your data?</Trans>\r\n          </div>\r\n        ) : this.state.currentStep === 1 && this.state.isBackup === \"no\" ? (\r\n          <div className=\"backup-page-title\">\r\n            <Trans>Where is your data?</Trans>\r\n          </div>\r\n        ) : null}\r\n        {this.state.currentStep === 0 ? (\r\n          <div className=\"backup-page-option\">\r\n            <div\r\n              className={\r\n                this.state.isBackup === \"yes\"\r\n                  ? \"backup-page-backup active\"\r\n                  : \"backup-page-backup\"\r\n              }\r\n              onClick={() => {\r\n                this.setState({ isBackup: \"yes\" });\r\n              }}\r\n            >\r\n              <span className=\"icon-backup\"></span>\r\n              <div>\r\n                <Trans>I want to backup</Trans>\r\n              </div>\r\n            </div>\r\n\r\n            <div\r\n              className={\r\n                this.state.isBackup === \"no\"\r\n                  ? \"backup-page-backup active\"\r\n                  : \"backup-page-backup\"\r\n              }\r\n              onClick={() => {\r\n                this.setState({ isBackup: \"no\" });\r\n              }}\r\n            >\r\n              <span className=\"icon-restore\"></span>\r\n              <div>\r\n                <Trans>I want to restore</Trans>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : this.state.currentStep === 1 ? (\r\n          <div className=\"backup-page-drive-container\">\r\n            <div>{renderDrivePage()}</div>\r\n            {this.state.isBackup === \"no\" ? (\r\n              <input\r\n                type=\"file\"\r\n                id=\"restore-file\"\r\n                accept=\"application/zip\"\r\n                className=\"restore-file\"\r\n                name=\"file\"\r\n                multiple={false}\r\n                onChange={(event) => {\r\n                  this.handleRestoreToLocal(event);\r\n                }}\r\n              />\r\n            ) : null}\r\n          </div>\r\n        ) : (\r\n          <div className=\"backup-page-finish-container\">\r\n            <div className=\"backup-page-finish\">\r\n              <Lottie options={successOptions} height={80} width={80} />\r\n              <div className=\"backup-page-finish-text\">\r\n                <Trans>\r\n                  {this.state.isBackup === \"yes\"\r\n                    ? \"Backup Successfully\"\r\n                    : \"Restore Successfully\"}\r\n                </Trans>\r\n              </div>\r\n              {this.state.isBackup ? null : (\r\n                <div style={{ opacity: 0.6 }}>\r\n                  <Trans>Try refresh or restart</Trans>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {this.state.isBackup === \"yes\" && this.state.currentStep === 0 ? (\r\n          <div className=\"backup-page-backup-selector\"></div>\r\n        ) : null}\r\n        {this.state.isBackup === \"no\" && this.state.currentStep === 0 ? (\r\n          <div\r\n            className=\"backup-page-backup-selector\"\r\n            style={{ marginLeft: \"252px\" }}\r\n          ></div>\r\n        ) : null}\r\n        <div\r\n          className=\"backup-page-close-icon\"\r\n          onClick={() => {\r\n            this.handleClose();\r\n          }}\r\n        >\r\n          <span className=\"icon-close \"></span>\r\n        </div>\r\n\r\n        {this.state.currentStep === 1 ? (\r\n          <div\r\n            className=\"backup-page-next\"\r\n            onClick={() => {\r\n              this.setState({ currentStep: 0 });\r\n            }}\r\n          >\r\n            <Trans>Last Step</Trans>\r\n          </div>\r\n        ) : this.state.currentStep === 0 ? (\r\n          <div\r\n            className=\"backup-page-next\"\r\n            onClick={() => {\r\n              this.setState({ currentStep: 1 });\r\n            }}\r\n            style={this.state.isBackup ? {} : { display: \"none\" }}\r\n          >\r\n            <Trans>Next Step</Trans>\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default BackupDialog;\r\n","//备份和恢复页面\r\nimport {\r\n  handleBackupDialog,\r\n  handleTokenDialog,\r\n} from \"../../store/actions/backupPage\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleLoadingDialog,\r\n  handleDownloadDesk,\r\n} from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport BackupDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n    isOpenTokenDialog: state.backupPage.isOpenTokenDialog,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleBackupDialog,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleTokenDialog,\r\n  handleLoadingDialog,\r\n  handleDownloadDesk,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(BackupDialog as any));\r\n","//左下角的图标外链\r\nimport React from \"react\";\r\nimport \"./settingDialog.css\";\r\nimport { SettingInfoProps, SettingInfoState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport i18n from \"../../i18n\";\r\nimport { version } from \"../../../package.json\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport SyncUtil from \"../../utils/syncUtils/common\";\r\nconst isElectron = require(\"is-electron\");\r\n\r\nclass SettingDialog extends React.Component<\r\n  SettingInfoProps,\r\n  SettingInfoState\r\n> {\r\n  constructor(props: SettingInfoProps) {\r\n    super(props);\r\n    this.state = {\r\n      language: OtherUtil.getReaderConfig(\"lang\"),\r\n      isTouch: OtherUtil.getReaderConfig(\"isTouch\") === \"yes\",\r\n      isOpenBook: OtherUtil.getReaderConfig(\"isOpenBook\") === \"yes\",\r\n      isExpandContent: OtherUtil.getReaderConfig(\"isExpandContent\") === \"yes\",\r\n      isAutoSync: OtherUtil.getReaderConfig(\"isAutoSync\") === \"yes\",\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    const lng = OtherUtil.getReaderConfig(\"lang\");\r\n    if (lng) {\r\n      this.setState({\r\n        language: lng,\r\n      });\r\n    }\r\n    document\r\n      .querySelector(\".lang-setting-dropdown\")\r\n      ?.children[\r\n        [\"zh\", \"cht\", \"en\"].indexOf(OtherUtil.getReaderConfig(\"lang\") || \"zh\")\r\n      ].setAttribute(\"selected\", \"selected\");\r\n  }\r\n\r\n  changeLanguage = (lng: string) => {\r\n    i18n.changeLanguage(lng);\r\n    this.setState({ language: lng });\r\n    OtherUtil.setReaderConfig(\"lang\", lng);\r\n  };\r\n  handleChangeTouch = () => {\r\n    this.setState({ isTouch: !this.state.isTouch });\r\n    OtherUtil.setReaderConfig(\"isTouch\", this.state.isTouch ? \"no\" : \"yes\");\r\n    this.state.isTouch\r\n      ? this.props.handleMessage(\"Turn Off Successfully\")\r\n      : this.props.handleMessage(\"Turn On Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleJump = (url: string) => {\r\n    isElectron()\r\n      ? window.require(\"electron\").shell.openExternal(url)\r\n      : window.open(url);\r\n  };\r\n\r\n  handleExpandContent = () => {\r\n    this.setState({ isExpandContent: !this.state.isExpandContent });\r\n    OtherUtil.setReaderConfig(\r\n      \"isExpandContent\",\r\n      this.state.isExpandContent ? \"no\" : \"yes\"\r\n    );\r\n    this.state.isExpandContent\r\n      ? this.props.handleMessage(\"Turn Off Successfully\")\r\n      : this.props.handleMessage(\"Turn On Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleAutoSync = () => {\r\n    this.setState({ isAutoSync: !this.state.isAutoSync });\r\n    OtherUtil.setReaderConfig(\r\n      \"isAutoSync\",\r\n      this.state.isAutoSync ? \"no\" : \"yes\"\r\n    );\r\n    this.state.isAutoSync\r\n      ? this.props.handleMessage(\"Turn Off Successfully\")\r\n      : this.props.handleMessage(\"Turn On Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleChangeOpen = () => {\r\n    this.setState({ isOpenBook: !this.state.isOpenBook });\r\n    OtherUtil.setReaderConfig(\r\n      \"isOpenBook\",\r\n      this.state.isOpenBook ? \"no\" : \"yes\"\r\n    );\r\n    this.state.isOpenBook\r\n      ? this.props.handleMessage(\"Turn Off Successfully\")\r\n      : this.props.handleMessage(\"Turn On Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleChangeLocation = async () => {\r\n    const { dialog } = window.require(\"electron\").remote;\r\n    var path = await dialog.showOpenDialog({\r\n      properties: [\"openDirectory\"],\r\n    });\r\n    const { ipcRenderer } = window.require(\"electron\");\r\n    path.filePaths[0] &&\r\n      SyncUtil.changeLocation(\r\n        OtherUtil.getReaderConfig(\"storageLocation\")\r\n          ? OtherUtil.getReaderConfig(\"storageLocation\")\r\n          : ipcRenderer.sendSync(\"storage-location\", \"ping\"),\r\n        path.filePaths[0],\r\n        this.props.handleMessage,\r\n        this.props.handleMessageBox\r\n      );\r\n    OtherUtil.setReaderConfig(\"storageLocation\", path.filePaths[0]);\r\n    document.getElementsByClassName(\r\n      \"setting-dialog-location-title\"\r\n    )[0].innerHTML = path.filePaths[0];\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"setting-dialog-container\">\r\n        <p className=\"setting-dialog-title\">\r\n          <Trans>Setting</Trans>\r\n        </p>\r\n        <p className=\"setting-subtitle\">\r\n          <Trans>Version</Trans>\r\n          {version}\r\n        </p>\r\n        <div\r\n          className=\"setting-close-container\"\r\n          onClick={() => {\r\n            this.props.handleSetting(false);\r\n          }}\r\n        >\r\n          <span className=\"icon-close setting-close\"></span>\r\n        </div>\r\n\r\n        <div className=\"setting-dialog-info\">\r\n          <div className=\"setting-dialog-new-title\">\r\n            {this.state.isTouch ? (\r\n              <Trans>Turn off touch screen mode</Trans>\r\n            ) : (\r\n              <Trans>Turn on touch screen mode</Trans>\r\n            )}\r\n\r\n            <span\r\n              className=\"single-control-switch\"\r\n              onClick={() => {\r\n                this.handleChangeTouch();\r\n              }}\r\n              style={\r\n                this.state.isTouch\r\n                  ? { background: \"rgba(46, 170, 220)\", float: \"right\" }\r\n                  : { float: \"right\" }\r\n              }\r\n            >\r\n              <span\r\n                className=\"single-control-button\"\r\n                style={\r\n                  this.state.isTouch\r\n                    ? {\r\n                        transform: \"translateX(20px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                    : {\r\n                        transform: \"translateX(0px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                }\r\n              ></span>\r\n            </span>\r\n          </div>\r\n          <div className=\"setting-dialog-new-title\">\r\n            <Trans>Auto open latest book</Trans>\r\n            <span\r\n              className=\"single-control-switch\"\r\n              onClick={() => {\r\n                this.handleChangeOpen();\r\n              }}\r\n              style={\r\n                this.state.isOpenBook\r\n                  ? { background: \"rgba(46, 170, 220)\", float: \"right\" }\r\n                  : { float: \"right\" }\r\n              }\r\n            >\r\n              <span\r\n                className=\"single-control-button\"\r\n                style={\r\n                  this.state.isOpenBook\r\n                    ? {\r\n                        transform: \"translateX(20px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                    : {\r\n                        transform: \"translateX(0px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                }\r\n              ></span>\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"setting-dialog-new-title\">\r\n            <Trans>Default expand all content</Trans>\r\n            <span\r\n              className=\"single-control-switch\"\r\n              onClick={() => {\r\n                this.handleExpandContent();\r\n              }}\r\n              style={\r\n                this.state.isExpandContent\r\n                  ? { background: \"rgba(46, 170, 220)\", float: \"right\" }\r\n                  : { float: \"right\" }\r\n              }\r\n            >\r\n              <span\r\n                className=\"single-control-button\"\r\n                style={\r\n                  this.state.isExpandContent\r\n                    ? {\r\n                        transform: \"translateX(20px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                    : {\r\n                        transform: \"translateX(0px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                }\r\n              ></span>\r\n            </span>\r\n          </div>\r\n          {isElectron() && (\r\n            <div className=\"setting-dialog-new-title\">\r\n              <Trans>Sync data from storage</Trans>\r\n              <span\r\n                className=\"single-control-switch\"\r\n                onClick={() => {\r\n                  this.handleAutoSync();\r\n                }}\r\n                style={\r\n                  this.state.isAutoSync\r\n                    ? { background: \"rgba(46, 170, 220)\", float: \"right\" }\r\n                    : { float: \"right\" }\r\n                }\r\n              >\r\n                <span\r\n                  className=\"single-control-button\"\r\n                  style={\r\n                    this.state.isAutoSync\r\n                      ? {\r\n                          transform: \"translateX(20px)\",\r\n                          transition: \"transform 0.5s ease\",\r\n                        }\r\n                      : {\r\n                          transform: \"translateX(0px)\",\r\n                          transition: \"transform 0.5s ease\",\r\n                        }\r\n                  }\r\n                ></span>\r\n              </span>\r\n            </div>\r\n          )}\r\n          {isElectron() && (\r\n            <>\r\n              <div className=\"setting-dialog-new-title\">\r\n                <Trans>Change storage location</Trans>\r\n\r\n                <span\r\n                  className=\"change-location-button\"\r\n                  onClick={() => {\r\n                    this.handleChangeLocation();\r\n                  }}\r\n                >\r\n                  <Trans>Change location</Trans>\r\n                </span>\r\n              </div>\r\n              <div className=\"setting-dialog-location-title\">\r\n                {OtherUtil.getReaderConfig(\"storageLocation\")\r\n                  ? OtherUtil.getReaderConfig(\"storageLocation\")\r\n                  : window\r\n                      .require(\"electron\")\r\n                      .ipcRenderer.sendSync(\"storage-location\", \"ping\")}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          <div className=\"setting-dialog-new-title\">\r\n            <Trans>语言 / Language</Trans>\r\n            <select\r\n              name=\"\"\r\n              className=\"lang-setting-dropdown\"\r\n              onChange={(event) => {\r\n                this.changeLanguage(event.target.value);\r\n              }}\r\n            >\r\n              <option value=\"zh\" className=\"lang-setting-option\">\r\n                简体中文\r\n              </option>\r\n              <option value=\"cht\" className=\"lang-setting-option\">\r\n                繁體中文\r\n              </option>\r\n              <option value=\"en\" className=\"lang-setting-option\">\r\n                English\r\n              </option>\r\n            </select>\r\n          </div>\r\n          <div className=\"about-this-project\">\r\n            <div\r\n              className=\"setting-dialog-subtitle\"\r\n              onClick={() => {\r\n                this.handleJump(\"https://github.com/troyeguo/koodo-reader\");\r\n              }}\r\n            >\r\n              <Trans>Project link</Trans>\r\n            </div>\r\n            <div\r\n              className=\"setting-dialog-subtitle\"\r\n              onClick={() => {\r\n                this.handleJump(\"https://koodo.960960.xyz/\");\r\n              }}\r\n            >\r\n              <Trans>Official website</Trans>\r\n            </div>\r\n            <div\r\n              className=\"setting-dialog-subtitle\"\r\n              onClick={() => {\r\n                this.handleJump(\"https://960960.xyz\");\r\n              }}\r\n            >\r\n              <Trans>About author</Trans>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SettingDialog;\r\n","//左下角的图标外链\r\nimport { connect } from \"react-redux\";\r\nimport SettingDialog from \"./component\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport {\r\n  handleSetting,\r\n  handleMessageBox,\r\n  handleMessage,\r\n} from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {};\r\n};\r\nconst actionCreator = { handleSetting, handleMessageBox, handleMessage };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(SettingDialog as any));\r\n","//对图书操作的菜单\r\nimport React from \"react\";\r\nimport \"./actionDialog.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { ActionDialogProps } from \"./interface\";\r\nimport AddTrash from \"../../utils/readUtils/addTrash\";\r\nimport FileSaver from \"file-saver\";\r\nimport localforage from \"localforage\";\r\nimport Parser from \"html-react-parser\";\r\nclass ActionDialog extends React.Component<ActionDialogProps> {\r\n  handleDeleteBook = () => {\r\n    this.props.handleReadingBook(this.props.currentBook);\r\n    this.props.handleDeleteDialog(true);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleEditBook = () => {\r\n    this.props.handleEditDialog(true);\r\n    this.props.handleReadingBook(this.props.currentBook);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleAddShelf = () => {\r\n    this.props.handleAddDialog(true);\r\n    this.props.handleReadingBook(this.props.currentBook);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleResoreBook = () => {\r\n    AddTrash.clear(this.props.currentBook.key);\r\n    this.props.handleActionDialog(false);\r\n    this.props.handleMessage(\"Restore Successfully\");\r\n    this.props.handleMessageBox(true);\r\n    this.props.handleFetchBooks();\r\n  };\r\n  render() {\r\n    if (this.props.mode === \"trash\") {\r\n      return (\r\n        <div\r\n          className=\"action-dialog-container\"\r\n          onMouseLeave={() => {\r\n            this.props.handleActionDialog(false);\r\n          }}\r\n          style={{\r\n            left: this.props.left,\r\n            top: this.props.top,\r\n            minHeight: \"40px\",\r\n          }}\r\n        >\r\n          <div className=\"action-dialog-actions-container\">\r\n            <div\r\n              className=\"action-dialog-add\"\r\n              onClick={() => {\r\n                this.handleResoreBook();\r\n              }}\r\n            >\r\n              <span className=\"icon-clockwise view-icon\"></span>\r\n              <span className=\"action-name\">\r\n                <Trans>Restore</Trans>\r\n              </span>\r\n              <p className=\"action-name\"></p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div\r\n        className=\"action-dialog-container\"\r\n        onMouseLeave={() => {\r\n          this.props.handleActionDialog(false);\r\n        }}\r\n        style={{ left: this.props.left, top: this.props.top }}\r\n      >\r\n        <div className=\"action-dialog-actions-container\">\r\n          <div\r\n            className=\"action-dialog-add\"\r\n            onClick={() => {\r\n              this.handleAddShelf();\r\n            }}\r\n          >\r\n            <span className=\"icon-shelf view-icon\"></span>\r\n            <p className=\"action-name\">\r\n              <Trans>Add</Trans>\r\n            </p>\r\n            <p className=\"action-name\"></p>\r\n          </div>\r\n          <div\r\n            className=\"action-dialog-delete\"\r\n            onClick={() => {\r\n              this.handleDeleteBook();\r\n            }}\r\n          >\r\n            <span className=\"icon-trash view-icon\"></span>\r\n            <p className=\"action-name\">\r\n              <Trans>Delete</Trans>\r\n            </p>\r\n            <p className=\"action-name\"></p>\r\n          </div>\r\n          <div\r\n            className=\"action-dialog-edit\"\r\n            onClick={() => {\r\n              this.handleEditBook();\r\n            }}\r\n          >\r\n            <span className=\"icon-edit view-icon\"></span>\r\n            <p className=\"action-name\">\r\n              <Trans>Edit</Trans>\r\n            </p>\r\n            <p className=\"action-name\"></p>\r\n          </div>\r\n          <div\r\n            className=\"action-dialog-edit\"\r\n            onClick={() => {\r\n              localforage\r\n                .getItem(this.props.currentBook.key)\r\n                .then((result: any) => {\r\n                  this.props.handleMessage(\"Export Successfully\");\r\n                  this.props.handleMessageBox(true);\r\n                  FileSaver.saveAs(\r\n                    new Blob([result]),\r\n                    this.props.currentBook.name +\r\n                      `${\r\n                        this.props.currentBook.description === \"pdf\"\r\n                          ? \".pdf\"\r\n                          : \".epub\"\r\n                      }`\r\n                  );\r\n                });\r\n            }}\r\n          >\r\n            <span className=\"icon-export view-icon\"></span>\r\n            <p className=\"action-name\">\r\n              <Trans>Export</Trans>\r\n            </p>\r\n            <p className=\"action-name\"></p>\r\n          </div>\r\n        </div>\r\n        <div className=\"sort-dialog-seperator\"></div>\r\n\r\n        <div className=\"action-dialog-book-info\">\r\n          <div>\r\n            <p className=\"action-dialog-book-publisher\">\r\n              <Trans>Book Name</Trans>:\r\n            </p>\r\n            <p\r\n              className=\"action-dialog-book-title\"\r\n              style={{ overflow: \"scroll\" }}\r\n            >\r\n              {this.props.currentBook.name}\r\n            </p>\r\n            <p className=\"action-dialog-book-publisher\">\r\n              <Trans>Author</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-title\">\r\n              <Trans>{this.props.currentBook.author}</Trans>\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"action-dialog-book-publisher\">\r\n              <Trans>Publisher</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-title\">\r\n              {this.props.currentBook.publisher}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"action-dialog-book-added\">\r\n              <Trans>Added at</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-title\">\r\n              {new Date(parseInt(this.props.currentBook.key))\r\n                .toLocaleString()\r\n                .replace(/:\\d{1,2}$/, \" \")}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"action-dialog-book-desc\">\r\n              <Trans>Description</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-detail\">\r\n              {Parser(this.props.currentBook.description)}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ActionDialog;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleEditDialog,\r\n  handleDeleteDialog,\r\n  handleAddDialog,\r\n  handleActionDialog,\r\n  handleReadingBook,\r\n} from \"../../store/actions/book\";\r\nimport {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleFetchBooks,\r\n} from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport ActionDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    mode: state.sidebar.mode,\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleEditDialog,\r\n  handleAddDialog,\r\n  handleDeleteDialog,\r\n  handleReadingBook,\r\n  handleActionDialog,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(ActionDialog as any));\r\n","import React from \"react\";\r\nimport \"./emptyCover.css\";\r\n\r\nconst emptyCover = (props) => {\r\n  return (\r\n    <div className=\"empty-cover\" style={{ transform: `scale(${props.scale})` }}>\r\n      <div\r\n        className=\"cover-banner\"\r\n        style={{\r\n          backgroundColor:\r\n            props.format === \"PDF\"\r\n              ? \"rgba(55, 170, 81, 0.7)\"\r\n              : props.format === \"TXT\"\r\n              ? \"rgba(251, 191, 16)\"\r\n              : props.format === \"EPUB\"\r\n              ? \"rgba(33, 165, 241)\"\r\n              : props.format === \"MOBI\"\r\n              ? \"rgba(255, 108, 110)\"\r\n              : props.format === \"AZW3\"\r\n              ? \"rgba(55, 170, 81, 0.7)\"\r\n              : \"rgba(255, 108, 110)\",\r\n        }}\r\n      >\r\n        {props.format || \"BOOK\"}\r\n      </div>\r\n      <div className=\"cover-title\">{props.title}</div>\r\n      <div className=\"cover-footer\">Koodo Reader</div>\r\n    </div>\r\n  );\r\n};\r\nexport default emptyCover;\r\n","//卡片模式下的图书显示\r\nimport React from \"react\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport \"./bookCardItem.css\";\r\nimport { BookCardProps, BookCardState } from \"./interface\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport ActionDialog from \"../../containers/actionDialog\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport isElectron from \"is-electron\";\r\nimport EmptyCover from \"../emptyCover\";\r\nimport BookUtil from \"../../utils/bookUtil\";\r\ndeclare var window: any;\r\n\r\nclass BookCardItem extends React.Component<BookCardProps, BookCardState> {\r\n  epub: any;\r\n  constructor(props: BookCardProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOpenConfig: false,\r\n      isFavorite:\r\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\r\n      left: 0,\r\n      top: 0,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    let filePath = \"\";\r\n    //控制是否自动打开本书\r\n    if (isElectron()) {\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      filePath = ipcRenderer.sendSync(\"get-file-data\");\r\n    }\r\n\r\n    if (\r\n      OtherUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\r\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\r\n      !this.props.currentBook.key &&\r\n      !filePath\r\n    ) {\r\n      BookUtil.RedirectBook(this.props.book);\r\n    }\r\n    this.props.handleReadingBook(this.props.book);\r\n  }\r\n  componentWillReceiveProps(nextProps: BookCardProps) {\r\n    if (nextProps.isDragToLove !== this.props.isDragToLove) {\r\n      if (\r\n        nextProps.isDragToLove &&\r\n        this.props.dragItem === this.props.book.key\r\n      ) {\r\n        this.handleLoveBook();\r\n        this.props.handleDragToLove(false);\r\n      }\r\n    }\r\n    if (nextProps.isDragToDelete !== this.props.isDragToDelete) {\r\n      if (\r\n        nextProps.isDragToDelete &&\r\n        this.props.dragItem === this.props.book.key\r\n      ) {\r\n        this.handleDeleteBook();\r\n        this.props.handleDragToDelete(false);\r\n      }\r\n    }\r\n  }\r\n  handleMoreAction = (event: any) => {\r\n    const e = event || window.event;\r\n    let x = e.clientX;\r\n    if (x > document.body.clientWidth - 300) {\r\n      x = x - 180;\r\n    }\r\n    this.setState(\r\n      {\r\n        left: x - 200,\r\n        top:\r\n          document.body.clientHeight - e.clientY > 400\r\n            ? document.body.clientHeight - 310 - e.clientY\r\n            : 200,\r\n      },\r\n      () => {\r\n        this.props.handleActionDialog(true);\r\n        this.props.handleReadingBook(this.props.book);\r\n      }\r\n    );\r\n  };\r\n  handleDeleteBook = () => {\r\n    this.props.handleReadingBook(this.props.book);\r\n    this.props.handleDeleteDialog(true);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleLoveBook = () => {\r\n    AddFavorite.setFavorite(this.props.book.key);\r\n    this.setState({ isFavorite: true });\r\n    this.props.handleMessage(\"Add Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleCancelLoveBook = () => {\r\n    AddFavorite.clear(this.props.book.key);\r\n    this.setState({ isFavorite: false });\r\n    this.props.handleMessage(\"Cancel Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  //控制按钮的弹出\r\n  handleConfig = (mode: boolean) => {\r\n    this.setState({ isOpenConfig: mode });\r\n  };\r\n  handleJump = () => {\r\n    RecentBooks.setRecent(this.props.book.key);\r\n\r\n    BookUtil.RedirectBook(this.props.book);\r\n  };\r\n  render() {\r\n    let percentage = RecordLocation.getCfi(this.props.book.key)\r\n      ? RecordLocation.getCfi(this.props.book.key).percentage\r\n      : 0;\r\n    const actionProps = { left: this.state.left, top: this.state.top };\r\n    return (\r\n      <>\r\n        <div\r\n          className=\"book-list-item\"\r\n          onMouseOver={() => {\r\n            this.handleConfig(true);\r\n          }}\r\n          onMouseLeave={() => {\r\n            this.handleConfig(false);\r\n          }}\r\n        >\r\n          {this.props.book.cover &&\r\n          this.props.book.cover !== \"noCover\" &&\r\n          this.props.book.publisher !== \"mobi\" &&\r\n          this.props.book.publisher !== \"azw3\" &&\r\n          this.props.book.publisher !== \"txt\" ? (\r\n            <img\r\n              className=\"book-item-cover\"\r\n              src={this.props.book.cover}\r\n              alt=\"\"\r\n              onClick={() => {\r\n                this.handleJump();\r\n              }}\r\n              onDragStart={() => {\r\n                this.props.handleDragItem(this.props.book.key);\r\n              }}\r\n              onDragEnd={() => {\r\n                this.props.handleDragItem(\"\");\r\n              }}\r\n            />\r\n          ) : (\r\n            <div\r\n              className=\"book-item-cover\"\r\n              onClick={() => {\r\n                this.handleJump();\r\n              }}\r\n              onDragStart={() => {\r\n                this.props.handleDragItem(this.props.book.key);\r\n              }}\r\n              onDragEnd={() => {\r\n                this.props.handleDragItem(\"\");\r\n              }}\r\n            >\r\n              <EmptyCover\r\n                {...{\r\n                  format: this.props.book.format,\r\n                  title: this.props.book.name,\r\n                  scale: 1,\r\n                }}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          <p className=\"book-item-title\">{this.props.book.name}</p>\r\n\r\n          {this.state.isFavorite ? (\r\n            <span\r\n              className=\"icon-love book-loved-icon\"\r\n              onClick={() => {\r\n                this.handleCancelLoveBook();\r\n              }}\r\n            ></span>\r\n          ) : null}\r\n\r\n          {this.state.isOpenConfig ? (\r\n            <>\r\n              {this.props.book.format !== \"PDF\" && (\r\n                <div className=\"reading-progress-icon\">\r\n                  <div style={{ position: \"relative\", left: \"4px\" }}>\r\n                    {percentage\r\n                      ? Math.floor(percentage * 100) < 10\r\n                        ? \"0\" + Math.floor(percentage * 100)\r\n                        : Math.floor(percentage * 100) === 100\r\n                        ? \"完\"\r\n                        : Math.floor(percentage * 100)\r\n                      : \"00\"}\r\n                    <span className=\"reading-percentage-char\">%</span>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <span\r\n                className=\"icon-more book-more-action\"\r\n                onClick={(event) => {\r\n                  this.handleMoreAction(event);\r\n                }}\r\n              ></span>\r\n              <span\r\n                className=\"icon-love book-love-icon\"\r\n                onClick={() => {\r\n                  this.handleLoveBook();\r\n                }}\r\n              ></span>\r\n            </>\r\n          ) : null}\r\n        </div>\r\n\r\n        {this.props.isOpenActionDialog &&\r\n        this.props.book.key === this.props.currentBook.key ? (\r\n          <div className=\"action-dialog-parent\">\r\n            <ActionDialog {...actionProps} />\r\n          </div>\r\n        ) : null}\r\n      </>\r\n    );\r\n  }\r\n}\r\nexport default withRouter(BookCardItem);\r\n","//卡片模式下的图书显示\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  handleActionDialog,\r\n  handleReadingBook,\r\n  handleDragItem,\r\n  handleDeleteDialog,\r\n} from \"../../store/actions/book\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport {\r\n  handleDragToLove,\r\n  handleDragToDelete,\r\n} from \"../../store/actions/sidebar\";\r\nimport Book from \"./component\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isOpenActionDialog: state.book.isOpenActionDialog,\r\n    isDragToLove: state.sidebar.isDragToLove,\r\n    isDragToDelete: state.sidebar.isDragToDelete,\r\n    dragItem: state.book.dragItem,\r\n    currentBook: state.book.currentBook,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingBook,\r\n  handleActionDialog,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleDragItem,\r\n  handleDragToLove,\r\n  handleDragToDelete,\r\n  handleDeleteDialog,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(Book);\r\n","//控制列表模式下的图书显示\r\nimport React from \"react\";\r\nimport \"./bookListItem.css\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport { BookItemProps, BookItemState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport AddTrash from \"../../utils/readUtils/addTrash\";\r\nimport EmptyCover from \"../emptyCover\";\r\nimport BookUtil from \"../../utils/bookUtil\";\r\n\r\nclass BookListItem extends React.Component<BookItemProps, BookItemState> {\r\n  epub: any;\r\n  constructor(props: BookItemProps) {\r\n    super(props);\r\n    this.state = {\r\n      isDeleteDialog: false,\r\n      isFavorite:\r\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    //控制是否自动打开本书\r\n    if (\r\n      OtherUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\r\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\r\n      !this.props.currentBook.key\r\n    ) {\r\n      BookUtil.RedirectBook(this.props.book);\r\n    }\r\n    this.props.handleReadingBook(this.props.book);\r\n  }\r\n  componentWillReceiveProps(nextProps: BookItemProps) {\r\n    if (nextProps.isDragToLove !== this.props.isDragToLove) {\r\n      if (\r\n        nextProps.isDragToLove &&\r\n        this.props.dragItem === this.props.book.key\r\n      ) {\r\n        this.handleLoveBook();\r\n        this.props.handleDragToLove(false);\r\n      }\r\n    }\r\n    if (nextProps.isDragToDelete !== this.props.isDragToDelete) {\r\n      if (\r\n        nextProps.isDragToDelete &&\r\n        this.props.dragItem === this.props.book.key\r\n      ) {\r\n        this.handleDeleteBook();\r\n        this.props.handleDragToDelete(false);\r\n      }\r\n    }\r\n  }\r\n  handleDeleteBook = () => {\r\n    this.props.handleDeleteDialog(true);\r\n    this.props.handleReadingBook(this.props.book);\r\n  };\r\n  handleEditBook = () => {\r\n    this.props.handleEditDialog(true);\r\n    this.props.handleReadingBook(this.props.book);\r\n  };\r\n  handleAddShelf = () => {\r\n    this.props.handleAddDialog(true);\r\n    this.props.handleReadingBook(this.props.book);\r\n  };\r\n  handleLoveBook = () => {\r\n    AddFavorite.setFavorite(this.props.book.key);\r\n    this.setState({ isFavorite: true });\r\n    this.props.handleMessage(\"Add Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleCancelLoveBook = () => {\r\n    AddFavorite.clear(this.props.book.key);\r\n    this.setState({ isFavorite: false });\r\n    this.props.handleMessage(\"Cancel Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleResoreBook = () => {\r\n    AddTrash.clear(this.props.currentBook.key);\r\n    this.props.handleMessage(\"Restore Successfully\");\r\n    this.props.handleMessageBox(true);\r\n    this.props.handleFetchBooks();\r\n  };\r\n  handleJump = () => {\r\n    RecentBooks.setRecent(this.props.book.key);\r\n    BookUtil.RedirectBook(this.props.book);\r\n  };\r\n  render() {\r\n    let percentage = RecordLocation.getCfi(this.props.book.key)\r\n      ? RecordLocation.getCfi(this.props.book.key).percentage\r\n      : 0;\r\n\r\n    return (\r\n      <div className=\"book-list-item-container\">\r\n        {this.props.book.cover &&\r\n        this.props.book.cover !== \"noCover\" &&\r\n        this.props.book.publisher !== \"mobi\" &&\r\n        this.props.book.publisher !== \"azw3\" &&\r\n        this.props.book.publisher !== \"txt\" ? (\r\n          <img\r\n            className=\"book-item-list-cover\"\r\n            src={this.props.book.cover}\r\n            alt=\"\"\r\n            onClick={() => {\r\n              this.handleJump();\r\n            }}\r\n            onDragStart={() => {\r\n              this.props.handleDragItem(this.props.book.key);\r\n            }}\r\n            onDragEnd={() => {\r\n              this.props.handleDragItem(\"\");\r\n            }}\r\n          />\r\n        ) : (\r\n          <div\r\n            className=\"book-item-list-cover\"\r\n            onClick={() => {\r\n              this.handleJump();\r\n            }}\r\n            onDragStart={() => {\r\n              this.props.handleDragItem(this.props.book.key);\r\n            }}\r\n            onDragEnd={() => {\r\n              this.props.handleDragItem(\"\");\r\n            }}\r\n          >\r\n            <EmptyCover\r\n              {...{\r\n                format: this.props.book.format,\r\n                title: this.props.book.name,\r\n                scale: 0.54,\r\n              }}\r\n            />\r\n          </div>\r\n        )}\r\n        <p\r\n          className=\"book-item-list-title\"\r\n          onClick={() => {\r\n            this.handleJump();\r\n          }}\r\n        >\r\n          {this.props.book.name}\r\n        </p>\r\n\r\n        <p className=\"book-item-list-author\">\r\n          <Trans>\r\n            {this.props.book.author ? this.props.book.author : \"Unknown Authur\"}\r\n          </Trans>\r\n        </p>\r\n        <p className=\"book-item-list-percentage\">\r\n          {percentage ? Math.round(percentage * 100) : 0}%\r\n        </p>\r\n        {this.props.mode === \"trash\" ? (\r\n          <div className=\"book-item-list-config\">\r\n            <span\r\n              className=\"icon-clockwise list-icon\"\r\n              onClick={() => {\r\n                this.handleResoreBook();\r\n              }}\r\n            ></span>\r\n          </div>\r\n        ) : (\r\n          <div className=\"book-item-list-config\">\r\n            {this.state.isFavorite ? (\r\n              <span\r\n                className=\"icon-love list-icon\"\r\n                onClick={() => {\r\n                  this.handleCancelLoveBook();\r\n                }}\r\n                style={{ color: \"#f87356\" }}\r\n              ></span>\r\n            ) : (\r\n              <span\r\n                className=\"icon-love list-icon\"\r\n                onClick={() => {\r\n                  this.handleLoveBook();\r\n                }}\r\n              ></span>\r\n            )}\r\n\r\n            <span\r\n              className=\"icon-shelf list-icon\"\r\n              onClick={() => {\r\n                this.handleAddShelf();\r\n              }}\r\n              color=\"rgba(75,75,75,1)\"\r\n            ></span>\r\n            <span\r\n              className=\"icon-trash list-icon\"\r\n              onClick={() => {\r\n                this.handleDeleteBook();\r\n              }}\r\n            ></span>\r\n            <span\r\n              className=\"icon-edit list-icon\"\r\n              onClick={() => {\r\n                this.handleEditBook();\r\n              }}\r\n            ></span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(BookListItem);\r\n","//控制列表模式下的图书显示\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  handleEditDialog,\r\n  handleDeleteDialog,\r\n  handleAddDialog,\r\n  handleReadingBook,\r\n  handleDragItem,\r\n} from \"../../store/actions/book\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleFetchBooks,\r\n} from \"../../store/actions/manager\";\r\nimport {\r\n  handleDragToLove,\r\n  handleDragToDelete,\r\n} from \"../../store/actions/sidebar\";\r\nimport { stateType } from \"../../store\";\r\nimport BookItem from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isReading: state.book.isReading,\r\n    percentage: state.progressPanel.percentage,\r\n    currentBook: state.book.currentBook,\r\n    isDragToLove: state.sidebar.isDragToLove,\r\n    isDragToDelete: state.sidebar.isDragToDelete,\r\n    dragItem: state.book.dragItem,\r\n    mode: state.sidebar.mode,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingBook,\r\n  handleEditDialog,\r\n  handleDeleteDialog,\r\n  handleAddDialog,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleDragItem,\r\n  handleDragToLove,\r\n  handleDragToDelete,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(BookItem as any));\r\n","//卡片模式下的图书显示\r\nimport React from \"react\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport \"./bookCoverItem.css\";\r\nimport { BookCoverProps, BookCoverState } from \"./interface\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport ActionDialog from \"../../containers/actionDialog\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport isElectron from \"is-electron\";\r\nimport EmptyCover from \"../emptyCover\";\r\nimport Parser from \"html-react-parser\";\r\nimport { Trans } from \"react-i18next\";\r\nimport BookUtil from \"../../utils/bookUtil\";\r\n\r\ndeclare var window: any;\r\n\r\nclass BookCoverItem extends React.Component<BookCoverProps, BookCoverState> {\r\n  epub: any;\r\n  constructor(props: BookCoverProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOpenConfig: false,\r\n      isFavorite:\r\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\r\n      left: 0,\r\n      top: 0,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    let filePath = \"\";\r\n    //控制是否自动打开本书\r\n    if (isElectron()) {\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      filePath = ipcRenderer.sendSync(\"get-file-data\");\r\n    }\r\n\r\n    if (\r\n      OtherUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\r\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\r\n      !this.props.currentBook.key &&\r\n      !filePath\r\n    ) {\r\n      BookUtil.RedirectBook(this.props.book);\r\n    }\r\n    this.props.handleReadingBook(this.props.book);\r\n  }\r\n  componentWillReceiveProps(nextProps: BookCoverProps) {\r\n    if (nextProps.isDragToLove !== this.props.isDragToLove) {\r\n      if (\r\n        nextProps.isDragToLove &&\r\n        this.props.dragItem === this.props.book.key\r\n      ) {\r\n        this.handleLoveBook();\r\n        this.props.handleDragToLove(false);\r\n      }\r\n    }\r\n    if (nextProps.isDragToDelete !== this.props.isDragToDelete) {\r\n      if (\r\n        nextProps.isDragToDelete &&\r\n        this.props.dragItem === this.props.book.key\r\n      ) {\r\n        this.handleDeleteBook();\r\n        this.props.handleDragToDelete(false);\r\n      }\r\n    }\r\n  }\r\n  handleMoreAction = (event: any) => {\r\n    const e = event || window.event;\r\n    let x = e.clientX;\r\n    if (x > document.body.clientWidth - 300) {\r\n      x = x - 180;\r\n    }\r\n    this.setState(\r\n      {\r\n        left: x - 200,\r\n        top:\r\n          document.body.clientHeight - e.clientY > 260\r\n            ? document.body.clientHeight - 420 - e.clientY\r\n            : e.clientY - 300,\r\n      },\r\n      () => {\r\n        this.props.handleActionDialog(true);\r\n        this.props.handleReadingBook(this.props.book);\r\n      }\r\n    );\r\n  };\r\n  handleDeleteBook = () => {\r\n    this.props.handleReadingBook(this.props.book);\r\n    this.props.handleDeleteDialog(true);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleLoveBook = () => {\r\n    AddFavorite.setFavorite(this.props.book.key);\r\n    this.setState({ isFavorite: true });\r\n    this.props.handleMessage(\"Add Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleCancelLoveBook = () => {\r\n    AddFavorite.clear(this.props.book.key);\r\n    this.setState({ isFavorite: false });\r\n    this.props.handleMessage(\"Cancel Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  //控制按钮的弹出\r\n  handleConfig = (mode: boolean) => {\r\n    this.setState({ isOpenConfig: mode });\r\n  };\r\n  handleJump = () => {\r\n    RecentBooks.setRecent(this.props.book.key);\r\n\r\n    BookUtil.RedirectBook(this.props.book);\r\n  };\r\n  render() {\r\n    let percentage = RecordLocation.getCfi(this.props.book.key)\r\n      ? RecordLocation.getCfi(this.props.book.key).percentage\r\n      : 0;\r\n    const actionProps = { left: this.state.left, top: this.state.top };\r\n    return (\r\n      <>\r\n        <div\r\n          className=\"book-list-cover-item\"\r\n          onMouseOver={() => {\r\n            this.handleConfig(true);\r\n          }}\r\n          onMouseLeave={() => {\r\n            this.handleConfig(false);\r\n          }}\r\n        >\r\n          {this.props.book.cover &&\r\n          this.props.book.cover !== \"noCover\" &&\r\n          this.props.book.publisher !== \"mobi\" &&\r\n          this.props.book.publisher !== \"azw3\" &&\r\n          this.props.book.publisher !== \"txt\" ? (\r\n            <img\r\n              className=\"book-cover-item-cover\"\r\n              src={this.props.book.cover}\r\n              alt=\"\"\r\n              onClick={() => {\r\n                this.handleJump();\r\n              }}\r\n              onDragStart={() => {\r\n                this.props.handleDragItem(this.props.book.key);\r\n              }}\r\n              onDragEnd={() => {\r\n                this.props.handleDragItem(\"\");\r\n              }}\r\n            />\r\n          ) : (\r\n            <div\r\n              className=\"book-cover-item-cover\"\r\n              onClick={() => {\r\n                this.handleJump();\r\n              }}\r\n              onDragStart={() => {\r\n                this.props.handleDragItem(this.props.book.key);\r\n              }}\r\n              onDragEnd={() => {\r\n                this.props.handleDragItem(\"\");\r\n              }}\r\n            >\r\n              <EmptyCover\r\n                {...{\r\n                  format: this.props.book.format,\r\n                  title: this.props.book.name,\r\n                  scale: 1.15,\r\n                }}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          <p className=\"book-cover-item-title\">{this.props.book.name}</p>\r\n          <p className=\"book-cover-item-author\">\r\n            <Trans>Author</Trans>:&nbsp;\r\n            <Trans>{this.props.book.author}</Trans>\r\n          </p>\r\n          <p className=\"book-cover-item-author\">\r\n            <Trans>Publisher</Trans>:&nbsp;\r\n            <Trans>{this.props.book.publisher}</Trans>\r\n          </p>\r\n          <div className=\"book-cover-item-desc\">\r\n            <Trans>Description</Trans>:&nbsp;\r\n            {this.props.book.description ? (\r\n              Parser(this.props.book.description)\r\n            ) : (\r\n              <Trans>Empty</Trans>\r\n            )}\r\n          </div>\r\n          {this.state.isFavorite ? (\r\n            <span\r\n              className=\"icon-love book-loved-icon\"\r\n              onClick={() => {\r\n                this.handleCancelLoveBook();\r\n              }}\r\n              style={{ right: \"274px\", bottom: \"25px\" }}\r\n            ></span>\r\n          ) : null}\r\n\r\n          {this.state.isOpenConfig ? (\r\n            <>\r\n              {this.props.book.format !== \"PDF\" && (\r\n                <div\r\n                  className=\"reading-progress-icon\"\r\n                  style={{ right: \"270px\" }}\r\n                >\r\n                  <div style={{ position: \"relative\", left: \"4px\" }}>\r\n                    {percentage\r\n                      ? Math.floor(percentage * 100) < 10\r\n                        ? \"0\" + Math.floor(percentage * 100)\r\n                        : Math.floor(percentage * 100) === 100\r\n                        ? \"完\"\r\n                        : Math.floor(percentage * 100)\r\n                      : \"00\"}\r\n                    <span className=\"reading-percentage-char\">%</span>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <span\r\n                className=\"icon-more book-more-action\"\r\n                onClick={(event) => {\r\n                  this.handleMoreAction(event);\r\n                }}\r\n                style={{ right: \"270px\" }}\r\n              ></span>\r\n              <span\r\n                className=\"icon-love book-love-icon\"\r\n                onClick={() => {\r\n                  this.handleLoveBook();\r\n                }}\r\n                style={{ right: \"275px\", bottom: \"25px\" }}\r\n              ></span>\r\n            </>\r\n          ) : null}\r\n        </div>\r\n        {this.props.isOpenActionDialog &&\r\n        this.props.book.key === this.props.currentBook.key ? (\r\n          <ActionDialog {...actionProps} />\r\n        ) : null}\r\n      </>\r\n    );\r\n  }\r\n}\r\nexport default withRouter(BookCoverItem);\r\n","//卡片模式下的图书显示\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  handleActionDialog,\r\n  handleReadingBook,\r\n  handleDragItem,\r\n  handleDeleteDialog,\r\n} from \"../../store/actions/book\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport {\r\n  handleDragToLove,\r\n  handleDragToDelete,\r\n} from \"../../store/actions/sidebar\";\r\nimport BookCoverItem from \"./component\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isOpenActionDialog: state.book.isOpenActionDialog,\r\n    isDragToLove: state.sidebar.isDragToLove,\r\n    isDragToDelete: state.sidebar.isDragToDelete,\r\n    dragItem: state.book.dragItem,\r\n    currentBook: state.book.currentBook,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingBook,\r\n  handleActionDialog,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleDragItem,\r\n  handleDragToLove,\r\n  handleDragToDelete,\r\n  handleDeleteDialog,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(BookCoverItem);\r\n","// 记录书本打开记录\nclass ReadingTime {\n  static setTime(bookKey: string, time: number) {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!) || {};\n    obj[bookKey] = time;\n    localStorage.setItem(\"readingTime\", JSON.stringify(obj));\n  }\n\n  static getTime(bookKey: string) {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!) || {};\n    return obj[bookKey] || 0;\n  }\n  static getAllTime() {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!) || {};\n    return obj || [];\n  }\n  static clearTime(bookKey: string) {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!) || {};\n    delete obj[bookKey];\n    localStorage.setItem(\"readingTime\", JSON.stringify(obj));\n  }\n}\n\nexport default ReadingTime;\n","import BookModel from \"../../model/Book\";\nimport NoteModel from \"../../model/Note\";\nimport ReadingTime from \"./readingTime\";\nimport RecordLocation from \"./recordLocation\";\nimport _ from \"underscore\";\n//获取所有图书的书名\nconst getBookName = (books: BookModel[]) => {\n  return books.map((item) => item.name);\n};\n//获取所有作者名\nconst getAuthorName = (books: BookModel[]) => {\n  return books.map((item) => item.author);\n};\n//获取所有图书的key值\nconst getBookKey = (books: BookModel[]) => {\n  return books.map((item) => item.key);\n};\n//获取图书索引\nconst getBookIndex = (nameArr: string[], oldNameArr: string[]) => {\n  let indexArr: number[] = [];\n  for (let i = 0; i < nameArr.length; i++) {\n    if (oldNameArr.indexOf(nameArr[i]) > -1) {\n      //如果索引数组已经包含该索引，就把它放在随后一位，取数组长度为索引\n      indexArr.push(\n        indexArr.indexOf(oldNameArr.indexOf(nameArr[i])) > -1\n          ? indexArr.length\n          : oldNameArr.indexOf(nameArr[i])\n      );\n    }\n  }\n  return indexArr;\n};\n\nconst getDurationArr = () => {\n  let durationObj = ReadingTime.getAllTime();\n  var sortable: any[] = [];\n  for (let obj in durationObj) {\n    sortable.push([obj, durationObj[obj]]);\n  }\n  sortable.sort(function (a, b) {\n    return a[1] - b[1];\n  });\n  return Object.keys(durationObj);\n};\nconst getPercentageArr = () => {\n  let locationObj = RecordLocation.getAllCfi();\n  var sortable: any = [];\n  for (let obj in locationObj) {\n    sortable.push([obj, locationObj[obj].percentage]);\n  }\n  sortable.sort(function (a, b) {\n    return a[1] - b[1];\n  });\n  return Object.keys(locationObj);\n};\nclass SortUtil {\n  static sortBooks(\n    books: BookModel[],\n    bookSortCode: { sort: number; order: number }\n  ) {\n    if (bookSortCode.sort === 1) {\n      let oldNameArr = getBookName(books);\n      let nameArr = getBookName(books).sort();\n      if (bookSortCode.order === 1) {\n        return getBookIndex(nameArr, oldNameArr);\n      } else {\n        return getBookIndex(nameArr, oldNameArr).reverse();\n      }\n    }\n    if (bookSortCode.sort === 2) {\n      let nameArr: number[] = [];\n      for (let i = 0; i < books.length; i++) {\n        nameArr.push(i);\n      }\n      if (bookSortCode.order === 1) {\n        return nameArr;\n      } else {\n        return nameArr.reverse();\n      }\n    }\n    if (bookSortCode.sort === 3) {\n      let durationKeys = getDurationArr();\n      let bookKeys = getBookKey(books);\n      if (bookSortCode.order === 1) {\n        return getBookIndex(_.union(durationKeys, bookKeys), bookKeys);\n      } else {\n        return getBookIndex(\n          _.union(durationKeys, bookKeys),\n          bookKeys\n        ).reverse();\n      }\n    }\n    if (bookSortCode.sort === 4) {\n      let oldAuthorArr = getAuthorName(books);\n      let authorArr = getAuthorName(books).sort();\n      if (bookSortCode.order === 1) {\n        return getBookIndex(authorArr, oldAuthorArr);\n      } else {\n        return getBookIndex(authorArr, oldAuthorArr).reverse();\n      }\n    }\n    if (bookSortCode.sort === 5) {\n      let percentagenKeys = getPercentageArr();\n      let bookKeys = getBookKey(books);\n      if (bookSortCode.order === 1) {\n        return getBookIndex(\n          _.union(percentagenKeys, bookKeys),\n          bookKeys\n        ).reverse();\n      } else {\n        return getBookIndex(_.union(percentagenKeys, bookKeys), bookKeys);\n      }\n    }\n  }\n  static sortNotes(\n    notes: NoteModel[],\n    noteSortCode: { sort: number; order: number },\n    books: BookModel[] = []\n  ) {\n    if (noteSortCode.sort === 2) {\n      //使书摘从晚到早排序\n      let noteArr = _.clone(notes).reverse();\n      let dateArr = _.uniq(\n        notes.map(\n          (item) =>\n            \"\" + item.date.year + \"-\" + item.date.month + \"-\" + item.date.day\n        )\n      );\n      if (noteSortCode.order === 1) {\n        dateArr.sort();\n      } else {\n        dateArr.sort().reverse();\n      }\n      //得到以日期为键，书摘为值的对象\n      let noteObj: { [key: string]: any } = {};\n      dateArr.forEach((date) => {\n        noteObj[date] = [];\n      });\n      noteArr.forEach((note) => {\n        dateArr.forEach((date) => {\n          if (\n            date ===\n            \"\" + note.date.year + \"-\" + note.date.month + \"-\" + note.date.day\n          ) {\n            noteObj[date].push(note);\n          }\n        });\n      });\n      return noteObj || {};\n    }\n    if (noteSortCode.sort === 1) {\n      //使书摘从晚到早排序\n      let noteArr = _.clone(notes).reverse();\n      let nameArr = _.uniq(\n        notes.map(\n          (item) =>\n            books[\n              _.findLastIndex(books, {\n                key: item.bookKey,\n              })\n            ].name\n        )\n      );\n      if (noteSortCode.order === 1) {\n        nameArr.sort();\n      } else {\n        nameArr.sort().reverse();\n      }\n      //得到以日期为键，书摘为值的对象\n      let noteObj: { [key: string]: any } = {};\n      nameArr.forEach((name) => {\n        noteObj[name] = [];\n      });\n      noteArr.forEach((note) => {\n        nameArr.forEach((name) => {\n          if (\n            name ===\n            books[\n              _.findLastIndex(books, {\n                key: note.bookKey,\n              })\n            ].name\n          ) {\n            noteObj[name].push(note);\n          }\n        });\n      });\n      return noteObj || {};\n    }\n  }\n}\n\nexport default SortUtil;\n","import React from \"react\";\r\n// import \"./deletePopup.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { DeletePopupProps } from \"./interface\";\r\n\r\nclass DeletePopup extends React.Component<DeletePopupProps> {\r\n  handleCancel = () => {\r\n    this.props.handleDeletePopup(false);\r\n  };\r\n  handleComfirm = () => {\r\n    //从列表删除和从图书库删除判断\r\n    this.props.handleDeletePopup(false);\r\n    this.props.handleDeleteOpearion();\r\n    this.props.handleMessage(\"Delete Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"delete-dialog-container\">\r\n        <div className=\"delete-dialog-title\">\r\n          <Trans>{this.props.title}</Trans>\r\n        </div>\r\n\r\n        <div className=\"delete-dialog-book\">\r\n          <div className=\"delete-dialog-book-title\">{this.props.name}</div>\r\n        </div>\r\n\r\n        <div className=\"delete-dialog-other-option\">\r\n          <Trans>{this.props.description}</Trans>\r\n        </div>\r\n\r\n        <div\r\n          className=\"delete-dialog-cancel\"\r\n          onClick={() => {\r\n            this.handleCancel();\r\n          }}\r\n        >\r\n          <Trans>Cancel</Trans>\r\n        </div>\r\n        <div\r\n          className=\"delete-dialog-comfirm\"\r\n          onClick={() => {\r\n            this.handleComfirm();\r\n          }}\r\n        >\r\n          <Trans>Delete</Trans>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DeletePopup;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleFetchBooks,\r\n  handleMessageBox,\r\n  handleMessage,\r\n} from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport DeletePopup from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {};\r\n};\r\nconst actionCreator = {\r\n  handleFetchBooks,\r\n  handleMessageBox,\r\n  handleMessage,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(DeletePopup as any));\r\n","export const emptyList = [\r\n  {\r\n    mode: \"home\",\r\n    main: \"Empty Library\",\r\n    sub: \"Click the top-right button to add books\",\r\n  },\r\n  {\r\n    mode: \"favorite\",\r\n    main: \"No Favorite Books\",\r\n    sub:\r\n      \"Move your mouse on the top of any book, click the heart icon to add it to your favorite books\",\r\n  },\r\n  {\r\n    mode: \"bookmark\",\r\n    main: \"Empty Bookmark\",\r\n    sub: \"Move your mouse on the top edge of the reader\",\r\n  },\r\n  {\r\n    mode: \"note\",\r\n    main: \"Empty Note\",\r\n    sub: \"Select any text and click the Add-Note button on the popup Menu\",\r\n  },\r\n  {\r\n    mode: \"digest\",\r\n    main: \"Empty Digest\",\r\n    sub: \"Select any text and click the Collect button on the popup Menu\",\r\n  },\r\n  {\r\n    mode: \"shelf\",\r\n    main: \"Empty Shelf\",\r\n    sub: \"Move your mouse on the top of any book\",\r\n  },\r\n\r\n  {\r\n    mode: \"trash\",\r\n    main: \"Empty Recycle Bin\",\r\n    sub: \"Drag any book to the Deleted tab to add it to Recycle Bin\",\r\n  },\r\n];\r\n","//为空页面\r\nimport React from \"react\";\r\nimport \"./emptyPage.css\";\r\nimport { emptyList } from \"../../constants/emptyList\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { EmptyPageProps, EmptyPageState } from \"./interface\";\r\n\r\nclass EmptyPage extends React.Component<EmptyPageProps, EmptyPageState> {\r\n  render() {\r\n    const renderEmptyList = () => {\r\n      return emptyList.map((item) => {\r\n        return (\r\n          <div\r\n            className=\"empty-page-info-container\"\r\n            key={item.mode}\r\n            style={\r\n              this.props.mode === item.mode ? {} : { visibility: \"hidden\" }\r\n            }\r\n          >\r\n            <div className=\"empty-page-info-main\">\r\n              <Trans>{item.main}</Trans>\r\n            </div>\r\n            <div className=\"empty-page-info-sub\">\r\n              <Trans>{item.sub}</Trans>\r\n            </div>\r\n          </div>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div className=\"empty-page-container\">\r\n        <div\r\n          className=\"empty-illustration-container\"\r\n          style={{ width: \"calc(100% - 50px)\" }}\r\n        >\r\n          <img\r\n            src={\r\n              process.env.NODE_ENV === \"production\"\r\n                ? \"./assets/empty.svg\"\r\n                : \"../../assets/empty.svg\"\r\n            }\r\n            alt=\"\"\r\n            className=\"empty-page-illustration\"\r\n          />\r\n        </div>\r\n\r\n        {renderEmptyList()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default EmptyPage;\r\n","//为空页面\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport EmptyPage from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    mode: state.sidebar.mode,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(EmptyPage as any));\r\n","//为空页面\r\nimport React from \"react\";\r\nimport \"./viewMode.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { ViewModeProps, ViewModeState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\n\r\nclass ViewMode extends React.Component<ViewModeProps, ViewModeState> {\r\n  constructor(props: ViewModeProps) {\r\n    super(props);\r\n    this.state = {\r\n      isClicked: false,\r\n    };\r\n  }\r\n  handleChange = (mode: string) => {\r\n    OtherUtil.setReaderConfig(\"viewMode\", mode);\r\n    this.props.handleFetchList();\r\n  };\r\n  handleClick = (bool) => {\r\n    this.setState({ isClicked: bool });\r\n  };\r\n  render() {\r\n    return (\r\n      <div\r\n        className=\"book-list-view\"\r\n        onMouseEnter={() => {\r\n          this.handleClick(true);\r\n        }}\r\n        onMouseLeave={() => {\r\n          this.handleClick(false);\r\n        }}\r\n        style={\r\n          this.state.isClicked\r\n            ? { boxShadow: \"0px 0px 5px rgba(0, 0, 0, 0.18)\" }\r\n            : { height: \"20px\" }\r\n        }\r\n      >\r\n        <span className=\"icon-dropdown view-mode-down\"></span>\r\n        <div\r\n          className=\"card-list-mode\"\r\n          onClick={() => {\r\n            this.handleChange(\"card\");\r\n          }}\r\n          style={\r\n            this.props.viewMode !== \"card\" && !this.state.isClicked\r\n              ? { display: \"none\" }\r\n              : this.props.viewMode !== \"card\" && this.state.isClicked\r\n              ? { color: \"rgba(75,75,75,0.5)\" }\r\n              : {}\r\n          }\r\n        >\r\n          <span className=\"icon-grid\"></span>\r\n          <Trans>Card Mode</Trans>\r\n        </div>\r\n        <div\r\n          className=\"list-view-mode\"\r\n          onClick={() => {\r\n            this.handleChange(\"list\");\r\n          }}\r\n          style={\r\n            this.props.viewMode !== \"list\" && !this.state.isClicked\r\n              ? { display: \"none\" }\r\n              : this.props.viewMode !== \"list\" && this.state.isClicked\r\n              ? { color: \"rgba(75,75,75,0.5)\" }\r\n              : {}\r\n          }\r\n        >\r\n          <span className=\"icon-list\"></span> <Trans>List Mode</Trans>\r\n        </div>\r\n        <div\r\n          className=\"list-view-mode\"\r\n          onClick={() => {\r\n            this.handleChange(\"cover\");\r\n          }}\r\n          style={\r\n            this.props.viewMode !== \"cover\" && !this.state.isClicked\r\n              ? { display: \"none\" }\r\n              : this.props.viewMode !== \"cover\" && this.state.isClicked\r\n              ? { color: \"rgba(75,75,75,0.5)\" }\r\n              : {}\r\n          }\r\n        >\r\n          <span className=\"icon-cover\"></span> <Trans>Cover Mode</Trans>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ViewMode;\r\n","//为空页面\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport ViewMode from \"./component\";\r\nimport { handleFetchList } from \"../../store/actions/manager\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    viewMode: state.manager.viewMode,\r\n  };\r\n};\r\nconst actionCreator = { handleFetchList };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(ViewMode as any));\r\n","//全部图书，最近阅读，搜索结果，排序结果的数据\r\nimport React from \"react\";\r\nimport \"./booklist.css\";\r\nimport BookCardItem from \"../../components/bookCardtem\";\r\nimport BookListItem from \"../../components/bookListItem\";\r\nimport BookCoverItem from \"../../components/bookCoverItem\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport RecordRecent from \"../../utils/readUtils/recordRecent\";\r\nimport ShelfUtil from \"../../utils/readUtils/shelfUtil\";\r\nimport SortUtil from \"../../utils/readUtils/sortUtil\";\r\nimport BookModel from \"../../model/Book\";\r\nimport { Trans, NamespacesConsumer } from \"react-i18next\";\r\nimport { BookListProps, BookListState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport localforage from \"localforage\";\r\nimport DeletePopup from \"../../components/deletePopup\";\r\nimport Empty from \"../emptyPage\";\r\nimport { Redirect, withRouter } from \"react-router-dom\";\r\nimport ViewMode from \"../../components/viewMode\";\r\nimport BackUtil from \"../../utils/syncUtils/backupUtil\";\r\nimport isElectron from \"is-electron\";\r\n\r\nclass BookList extends React.Component<BookListProps, BookListState> {\r\n  constructor(props: BookListProps) {\r\n    super(props);\r\n    this.state = {\r\n      shelfIndex: 0,\r\n      isOpenDelete: false,\r\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\r\n    };\r\n  }\r\n  componentWillMount() {\r\n    if (this.props.mode === \"trash\") {\r\n      this.props.handleFetchBooks(true);\r\n    } else {\r\n      this.props.handleFetchBooks(false);\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    if (!this.props.books || !this.props.books[0]) {\r\n      return <Redirect to=\"manager/empty\" />;\r\n    }\r\n  }\r\n\r\n  handleKeyFilter = (items: any[], arr: string[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items.forEach((subItem: any) => {\r\n        if (subItem.key === item) {\r\n          itemArr.push(subItem);\r\n        }\r\n      });\r\n    });\r\n    return itemArr;\r\n  };\r\n\r\n  //获取书架数据\r\n  handleShelf(items: any, index: number) {\r\n    //获取书架名\r\n    if (index < 1) return items;\r\n    let shelfTitle = Object.keys(ShelfUtil.getShelf());\r\n    //获取当前书架名\r\n    let currentShelfTitle = shelfTitle[index];\r\n    if (!currentShelfTitle) return items;\r\n    //获取当前书架的图书列表\r\n    let currentShelfList = ShelfUtil.getShelf()[currentShelfTitle];\r\n    //根据图书列表获取到图书数据\r\n    let shelfItems = items.filter((item: { key: number }) => {\r\n      return currentShelfList.indexOf(item.key) > -1;\r\n    });\r\n    return shelfItems;\r\n  }\r\n  //控制卡片模式和列表模式的切换\r\n  handleChange = (mode: string) => {\r\n    OtherUtil.setReaderConfig(\"viewMode\", mode);\r\n    this.props.handleFetchList();\r\n  };\r\n  //根据搜索图书index获取到搜索出的图书\r\n  handleIndexFilter = (items: any, arr: number[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items[item] && itemArr.push(items[item]);\r\n    });\r\n\r\n    return itemArr;\r\n  };\r\n  renderBookList = () => {\r\n    //根据不同的场景获取不同的图书数据\r\n    let books = this.props.isSearch\r\n      ? this.handleIndexFilter(this.props.books, this.props.searchResults)\r\n      : this.props.shelfIndex > 0\r\n      ? this.handleShelf(this.props.books, this.props.shelfIndex)\r\n      : this.props.mode === \"favorite\" && !this.props.isBookSort\r\n      ? this.handleKeyFilter(this.props.books, AddFavorite.getAllFavorite())\r\n      : this.props.mode === \"favorite\" && this.props.isBookSort\r\n      ? this.handleIndexFilter(\r\n          this.handleKeyFilter(this.props.books, AddFavorite.getAllFavorite()),\r\n          //返回排序后的图书index\r\n          SortUtil.sortBooks(this.props.books, this.props.bookSortCode) || []\r\n        )\r\n      : this.props.isBookSort && this.props.bookSortCode.sort !== 0\r\n      ? this.handleIndexFilter(\r\n          this.props.books,\r\n          //返回排序后的图书index\r\n          SortUtil.sortBooks(this.props.books, this.props.bookSortCode) || []\r\n        )\r\n      : this.handleKeyFilter(this.props.books, RecordRecent.getAllRecent());\r\n    if (this.props.mode === \"shelf\" && books.length === 0) {\r\n      return (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            left: 0,\r\n            top: 0,\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n            zIndex: -1,\r\n          }}\r\n        >\r\n          <Empty />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return books.map((item: BookModel, index: number) => {\r\n      return this.props.viewMode === \"list\" ? (\r\n        <BookListItem\r\n          {...{\r\n            key: item.key,\r\n            book: item,\r\n          }}\r\n        />\r\n      ) : this.props.viewMode === \"card\" ? (\r\n        <BookCardItem key={item.key} book={item} />\r\n      ) : (\r\n        <BookCoverItem\r\n          {...{\r\n            key: item.key,\r\n            book: item,\r\n          }}\r\n        />\r\n      );\r\n    });\r\n  };\r\n  //切换书架\r\n  handleShelfItem = (event: any) => {\r\n    let index = event.target.value.split(\",\")[1];\r\n    this.setState({ shelfIndex: index });\r\n    this.props.handleShelfIndex(index);\r\n    if (index > 0) {\r\n      this.props.handleMode(\"shelf\");\r\n    } else {\r\n      this.props.handleMode(\"home\");\r\n    }\r\n  };\r\n  handleDeleteShelf = () => {\r\n    if (this.state.shelfIndex < 1) return;\r\n    let shelfTitles = Object.keys(ShelfUtil.getShelf());\r\n    //获取当前书架名\r\n    let currentShelfTitle = shelfTitles[this.state.shelfIndex];\r\n    ShelfUtil.removeShelf(currentShelfTitle);\r\n    this.setState({ shelfIndex: 0 }, () => {\r\n      this.props.handleShelfIndex(0);\r\n      this.props.handleMode(\"shelf\");\r\n    });\r\n  };\r\n  renderShelfList = () => {\r\n    let shelfList = ShelfUtil.getShelf();\r\n    let shelfTitle = Object.keys(shelfList);\r\n    return shelfTitle.map((item, index) => {\r\n      return (\r\n        <NamespacesConsumer key={index}>\r\n          {(t) => (\r\n            <option\r\n              value={[item, index.toString()]}\r\n              key={index}\r\n              className=\"add-dialog-shelf-list-option\"\r\n              selected={this.props.shelfIndex === index ? true : false}\r\n            >\r\n              {t(item === \"New\" ? \"All Books\" : item)}\r\n            </option>\r\n          )}\r\n        </NamespacesConsumer>\r\n      );\r\n    });\r\n  };\r\n  handleDeletePopup = (isOpenDelete: boolean) => {\r\n    this.setState({ isOpenDelete });\r\n  };\r\n  render() {\r\n    if (\r\n      (this.state.favoriteBooks === 0 && this.props.mode === \"favorite\") ||\r\n      !this.props.books ||\r\n      !this.props.books[0]\r\n    ) {\r\n      return <Redirect to=\"/manager/empty\" />;\r\n    }\r\n    if (isElectron()) {\r\n      localforage.getItem(this.props.books[0].key).then((result) => {\r\n        if (result) {\r\n          BackUtil.backup(\r\n            this.props.books,\r\n            this.props.notes,\r\n            this.props.bookmarks,\r\n            () => {},\r\n            4,\r\n            () => {}\r\n          );\r\n        }\r\n      });\r\n    }\r\n    const deletePopupProps = {\r\n      mode: \"shelf\",\r\n      name: Object.keys(ShelfUtil.getShelf())[this.state.shelfIndex],\r\n      title: \"Delete this shelf\",\r\n      description: \"This action will clear and remove this shelf\",\r\n      handleDeletePopup: this.handleDeletePopup,\r\n      handleDeleteOpearion: this.handleDeleteShelf,\r\n    };\r\n    OtherUtil.setReaderConfig(\"totalBooks\", this.props.books.length.toString());\r\n    return (\r\n      <>\r\n        {this.state.isOpenDelete && <DeletePopup {...deletePopupProps} />}\r\n        <ViewMode />\r\n\r\n        <div className=\"booklist-shelf-container\">\r\n          <p className=\"general-setting-title\" style={{ display: \"inline\" }}>\r\n            <Trans>My Shelves</Trans>\r\n          </p>\r\n          <select\r\n            className=\"booklist-shelf-list\"\r\n            onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\r\n              this.handleShelfItem(event);\r\n            }}\r\n          >\r\n            {this.renderShelfList()}\r\n          </select>\r\n          {this.state.shelfIndex > 0 ? (\r\n            <span\r\n              className=\"icon-trash delete-shelf-icon\"\r\n              onClick={() => {\r\n                this.handleDeletePopup(true);\r\n              }}\r\n            ></span>\r\n          ) : null}\r\n        </div>\r\n\r\n        <div className=\"book-list-container-parent\">\r\n          <div className=\"book-list-container\">\r\n            <ul className=\"book-list-item-box\">{this.renderBookList()}</ul>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(BookList);\r\n","//全部图书，最近阅读，搜索结果，排序结果的数据\r\nimport { connect } from \"react-redux\";\r\nimport { handleFetchList, handleFetchBooks } from \"../../store/actions/manager\";\r\nimport { handleMode, handleShelfIndex } from \"../../store/actions/sidebar\";\r\nimport { handleDeleteDialog } from \"../../store/actions/book\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport BookList from \"./component\";\r\n\r\nconst mappropsToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    mode: state.sidebar.mode,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n\r\n    shelfIndex: state.sidebar.shelfIndex,\r\n    searchResults: state.manager.searchResults,\r\n    isSearch: state.manager.isSearch,\r\n    isBookSort: state.manager.isBookSort,\r\n    viewMode: state.manager.viewMode,\r\n    bookSortCode: state.manager.bookSortCode,\r\n    noteSortCode: state.manager.noteSortCode,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchList,\r\n  handleMode,\r\n  handleShelfIndex,\r\n  handleDeleteDialog,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mappropsToProps,\r\n  actionCreator\r\n)(withNamespaces()(BookList as any));\r\n","//全部图书，最近阅读，搜索结果，排序结果的数据\r\nimport React from \"react\";\r\nimport \"./booklist.css\";\r\nimport Book from \"../../components/bookCardtem\";\r\nimport BookItem from \"../../components/bookListItem\";\r\nimport AddTrash from \"../../utils/readUtils/addTrash\";\r\nimport RecordRecent from \"../../utils/readUtils/recordRecent\";\r\nimport SortUtil from \"../../utils/readUtils/sortUtil\";\r\nimport BookModel from \"../../model/Book\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { BookListProps, BookListState } from \"./interface\";\r\nimport Empty from \"../emptyPage\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport ViewMode from \"../../components/viewMode\";\r\n\r\nclass BookList extends React.Component<BookListProps, BookListState> {\r\n  constructor(props: BookListProps) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n  componentWillMount() {\r\n    this.props.handleFetchBooks(true);\r\n  }\r\n  handleKeyFilter = (items: any[], arr: string[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items.forEach((subItem: any) => {\r\n        if (subItem.key === item) {\r\n          itemArr.push(subItem);\r\n        }\r\n      });\r\n    });\r\n\r\n    return itemArr;\r\n  };\r\n\r\n  //根据搜索图书index获取到搜索出的图书\r\n  handleIndexFilter = (items: any, arr: number[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items[item] && itemArr.push(items[item]);\r\n    });\r\n\r\n    return itemArr;\r\n  };\r\n  renderBookList = () => {\r\n    //根据不同的场景获取不同的图书数据\r\n    let books = !this.props.isBookSort\r\n      ? this.handleKeyFilter(this.props.deletedBooks, AddTrash.getAllTrash())\r\n      : this.props.isBookSort\r\n      ? this.handleIndexFilter(\r\n          this.handleKeyFilter(this.props.deletedBooks, AddTrash.getAllTrash()),\r\n          //返回排序后的图书index\r\n          SortUtil.sortBooks(\r\n            this.props.deletedBooks,\r\n            this.props.bookSortCode\r\n          ) || []\r\n        )\r\n      : this.props.isBookSort\r\n      ? this.handleIndexFilter(\r\n          this.props.deletedBooks,\r\n          //返回排序后的图书index\r\n          SortUtil.sortBooks(\r\n            this.props.deletedBooks,\r\n            this.props.bookSortCode\r\n          ) || []\r\n        )\r\n      : this.handleKeyFilter(\r\n          this.props.deletedBooks,\r\n          RecordRecent.getAllRecent()\r\n        );\r\n    if (books.length === 0) {\r\n      return (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            left: 0,\r\n            top: 0,\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n            zIndex: -1,\r\n          }}\r\n        >\r\n          <Empty />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return books.map((item: BookModel, index: number) => {\r\n      return this.props.viewMode === \"list\" ? (\r\n        <BookItem\r\n          {...{\r\n            key: item.key,\r\n            book: item,\r\n          }}\r\n        />\r\n      ) : (\r\n        <Book key={item.key} book={item} />\r\n      );\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <ViewMode />\r\n        <div\r\n          className=\"booklist-delete-container\"\r\n          onClick={() => {\r\n            this.props.handleDeleteDialog(true);\r\n          }}\r\n        >\r\n          <Trans>Delete All Books</Trans>\r\n        </div>\r\n\r\n        <div className=\"book-list-container-parent\">\r\n          <div className=\"book-list-container\">\r\n            <ul className=\"book-list-item-box\">{this.renderBookList()}</ul>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(BookList);\r\n","//全部图书，最近阅读，搜索结果，排序结果的数据\r\nimport { connect } from \"react-redux\";\r\nimport { handleFetchList, handleFetchBooks } from \"../../store/actions/manager\";\r\nimport { handleMode, handleShelfIndex } from \"../../store/actions/sidebar\";\r\nimport { handleDeleteDialog } from \"../../store/actions/book\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport BookList from \"./component\";\r\n\r\nconst mappropsToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    deletedBooks: state.manager.deletedBooks,\r\n    mode: state.sidebar.mode,\r\n    isBookSort: state.manager.isBookSort,\r\n    viewMode: state.manager.viewMode,\r\n    bookSortCode: state.manager.bookSortCode,\r\n    noteSortCode: state.manager.noteSortCode,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchList,\r\n  handleMode,\r\n  handleShelfIndex,\r\n  handleDeleteDialog,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mappropsToProps,\r\n  actionCreator\r\n)(withNamespaces()(BookList as any));\r\n","export function handleOpenMenu(isOpenMenu: boolean) {\r\n  return { type: \"HANDLE_OPEN_MENU\", payload: isOpenMenu };\r\n}\r\nexport function handleMenuMode(menuMode: string) {\r\n  return { type: \"HANDLE_MENU_MODE\", payload: menuMode };\r\n}\r\nexport function handleOpenHighlight(isOpenHighlight: boolean) {\r\n  return { type: \"HANDLE_OPEN_HIGHLIGHT\", payload: isOpenHighlight };\r\n}\r\nexport function handleChangeDirection(isChangeDirection: boolean) {\r\n  return { type: \"HANDLE_CHANGE_DIRECTION\", payload: isChangeDirection };\r\n}\r\nexport function handleShowBookmark(isShowBookmark: boolean) {\r\n  return { type: \"HANDLE_SHOW_BOOKMARK\", payload: isShowBookmark };\r\n}\r\nexport function handleSelection(selection: string) {\r\n  return { type: \"HANDLE_SELECTION\", payload: selection };\r\n}\r\n","class TagUtil {\n  static setTags(tagName: string) {\n    let tagArr =\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\n      localStorage.getItem(\"noteTags\")\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\n        : [];\n    const index = tagArr.indexOf(tagName);\n    if (index > -1) {\n      tagArr.splice(index, 1);\n      tagArr.unshift(tagName);\n    } else {\n      tagArr.unshift(tagName);\n    }\n\n    localStorage.setItem(\"noteTags\", JSON.stringify(tagArr));\n  }\n\n  static clear(tagName: string) {\n    let tagArr =\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\n      localStorage.getItem(\"noteTags\")\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\n        : [];\n    const index = tagArr.indexOf(tagName);\n    if (index > -1) {\n      tagArr.splice(index, 1);\n    }\n    localStorage.setItem(\"noteTags\", JSON.stringify(tagArr));\n  }\n  static getAllTags() {\n    let tagArr =\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\n      localStorage.getItem(\"noteTags\")\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\n        : [];\n    return tagArr || [];\n  }\n}\n\nexport default TagUtil;\n","//我的书摘页面\r\nimport React from \"react\";\r\nimport \"./deleteIcon.css\";\r\nimport { DeleteIconProps, DeleteIconStates } from \"./interface\";\r\nimport localforage from \"localforage\";\r\nimport TagUtil from \"../../utils/readUtils/tagUtil\";\r\nimport DeletePopup from \"../deletePopup\";\r\n\r\nclass DeleteIcon extends React.Component<DeleteIconProps, DeleteIconStates> {\r\n  constructor(props: DeleteIconProps) {\r\n    super(props);\r\n    this.state = {\r\n      deleteIndex: -1,\r\n      isOpenDelete: false,\r\n    };\r\n  }\r\n\r\n  handleDelete = () => {\r\n    let deleteItems =\r\n      this.props.mode === \"notes\"\r\n        ? this.props.notes\r\n        : this.props.mode === \"tags\"\r\n        ? TagUtil.getAllTags()\r\n        : this.props.bookmarks;\r\n    let deleteFunc =\r\n      this.props.mode === \"notes\"\r\n        ? this.props.handleFetchNotes\r\n        : this.props.handleFetchBookmarks;\r\n    deleteItems.forEach((item: any, index: number) => {\r\n      if (this.props.mode === \"tags\") {\r\n        item === this.props.tagName && TagUtil.clear(item);\r\n        return;\r\n      }\r\n      if (item.key === this.props.itemKey) {\r\n        deleteItems.splice(index, 1);\r\n        if (deleteItems.length === 0) {\r\n          localforage\r\n            .removeItem(this.props.mode)\r\n            .then(() => {\r\n              deleteFunc();\r\n              this.props.handleMessage(\"Delete Successfully\");\r\n              this.props.handleMessageBox(true);\r\n            })\r\n            .catch(() => {\r\n              console.log(\"删除失败\");\r\n            });\r\n        } else {\r\n          localforage\r\n            .setItem(this.props.mode, deleteItems)\r\n            .then(() => {\r\n              deleteFunc();\r\n              this.props.handleMessage(\"Delete Successfully\");\r\n              this.props.handleMessageBox(true);\r\n            })\r\n            .catch(() => {\r\n              console.log(\"修改失败\");\r\n            });\r\n        }\r\n      }\r\n    });\r\n    // if (this.props.isReading && this.props.mode === \"notes\") {\r\n    //   this.props.renderHighlighters();\r\n    //   this.props.handleShowDelete(\"\");\r\n    // }\r\n  };\r\n  handleDeletePopup = (isOpenDelete: boolean) => {\r\n    this.setState({ isOpenDelete });\r\n    if (!isOpenDelete) {\r\n      this.props.handleChangeTag(this.props.index);\r\n    }\r\n  };\r\n  render() {\r\n    const deletePopupProps = {\r\n      name: this.props.tagName,\r\n      title: \"Delete this tag\",\r\n      description: \"This action will clear and remove this tag\",\r\n      handleDeletePopup: this.handleDeletePopup,\r\n      handleDeleteOpearion: this.handleDelete,\r\n    };\r\n    return (\r\n      <>\r\n        {this.state.isOpenDelete && <DeletePopup {...deletePopupProps} />}\r\n        <div\r\n          className=\"delete-digest-button\"\r\n          onClick={() => {\r\n            this.props.mode === \"tags\"\r\n              ? this.handleDeletePopup(true)\r\n              : this.handleDelete();\r\n          }}\r\n        >\r\n          <span className=\"icon-close delete-digest-icon\"></span>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DeleteIcon;\r\n","//我的书摘页面\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport {\r\n  handleFetchBookmarks,\r\n  handleFetchNotes,\r\n} from \"../../store/actions/reader\";\r\nimport { handleShowBookmark } from \"../../store/actions/viewArea\";\r\nimport DeleteIcon from \"./component\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    digests: state.reader.digests,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    isReading: state.book.isReading,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchBookmarks,\r\n  handleFetchNotes,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleShowBookmark,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(DeleteIcon as any);\r\n","//我的书摘，笔记的卡片\r\nimport React from \"react\";\r\nimport \"./cardList.css\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { CardListProps, CardListStates } from \"./interface\";\r\nimport DeleteIcon from \"../../components/deleteIcon\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport SortUtil from \"../../utils/readUtils/sortUtil\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\ndeclare var window: any;\r\n\r\nclass CardList extends React.Component<CardListProps, CardListStates> {\r\n  constructor(props: CardListProps) {\r\n    super(props);\r\n    this.state = { deleteKey: \"\" };\r\n  }\r\n  //根据bookkey获取\r\n  handleBookName = (bookKey: string) => {\r\n    let { books } = this.props;\r\n    let bookName = \"\";\r\n    for (let i = 0; i < this.props.books.length; i++) {\r\n      if (books[i].key === bookKey) {\r\n        bookName = books[i].name;\r\n        break;\r\n      }\r\n    }\r\n    return bookName;\r\n  };\r\n  handleShowDelete = (deleteKey: string) => {\r\n    this.setState({ deleteKey });\r\n  };\r\n  handleJump = (cfi: string, bookKey: string, percentage: number) => {\r\n    let { books } = this.props;\r\n    let book: any;\r\n    //根据bookKey获取指定的book和epub\r\n    for (let i = 0; i < books.length; i++) {\r\n      if (books[i].key === bookKey) {\r\n        book = books[i];\r\n        break;\r\n      }\r\n    }\r\n    if (!book) {\r\n      this.props.handleMessage(\"Book not exsit\");\r\n      this.props.handleMessageBox(true);\r\n      return;\r\n    }\r\n    RecordLocation.recordCfi(bookKey, cfi, percentage);\r\n    window.open(`${window.location.href.split(\"#\")[0]}#/epub/${book.key}`);\r\n  };\r\n  render() {\r\n    let { cards } = this.props;\r\n    if (cards.length === 0) {\r\n      return <Redirect to=\"/manager/empty\" />;\r\n    }\r\n\r\n    let noteObj = SortUtil.sortNotes(\r\n      cards,\r\n      this.props.noteSortCode,\r\n      this.props.books\r\n    );\r\n    const renderCardListItem = (title: string) => {\r\n      return noteObj![title].map((item: NoteModel, index: number) => {\r\n        const cardProps = {\r\n          itemKey: item.key,\r\n          mode: \"notes\",\r\n        };\r\n        return (\r\n          <li\r\n            className=\"card-list-item\"\r\n            key={index}\r\n            onMouseOver={() => {\r\n              this.handleShowDelete(item.key);\r\n            }}\r\n            onMouseLeave={() => {\r\n              this.handleShowDelete(\"\");\r\n            }}\r\n            style={this.props.mode === \"note\" ? { height: \"250px\" } : {}}\r\n          >\r\n            <div className=\"card-list-item-card\">\r\n              <div style={{ position: \"relative\", bottom: \"25px\" }}>\r\n                {this.state.deleteKey === item.key ? (\r\n                  <DeleteIcon {...cardProps} />\r\n                ) : null}\r\n              </div>\r\n              <div className=\"card-list-item-text-parent\">\r\n                <div className=\"card-list-item-text\">\r\n                  {this.props.mode === \"note\" ? item.notes : item.text}\r\n                </div>\r\n              </div>\r\n              {this.props.mode === \"note\" ? (\r\n                <div className=\"card-list-item-text-note\">\r\n                  <div className=\"card-list-item-text\">{item.text}</div>\r\n                </div>\r\n              ) : null}\r\n\r\n              <div className=\"card-list-item-citation\">\r\n                <div className=\"card-list-item-title\">\r\n                  <Trans>From</Trans>《\r\n                </div>\r\n                <div className=\"card-list-item-chapter card-list-item-title\">\r\n                  {this.handleBookName(item.bookKey)}\r\n                </div>\r\n                <div className=\"card-list-item-chapter card-list-item-title\">\r\n                  》<Trans>{item.chapter}</Trans>\r\n                </div>\r\n              </div>\r\n              <div\r\n                onClick={() => {\r\n                  this.handleJump(item.cfi, item.bookKey, item.percentage);\r\n                }}\r\n              >\r\n                <div\r\n                  className=\"card-list-item-show-more\"\r\n                  style={{ color: \"rgba(75,75,75,0.8)\", bottom: \"10px\" }}\r\n                >\r\n                  {this.props.mode === \"note\" ? (\r\n                    <Trans>{\"More Notes\"}</Trans>\r\n                  ) : (\r\n                    <Trans>{\"More Digests\"}</Trans>\r\n                  )}\r\n\r\n                  <span className=\"icon-dropdown icon-card-right\"></span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    const renderCardList = () => {\r\n      return Object.keys(noteObj!).map((item, index) => {\r\n        return (\r\n          <li className=\"card-page-item\" key={index}>\r\n            <div className=\"card-page-item-date\">{item}</div>\r\n            <ul className=\"card-list-container-box\">\r\n              {renderCardListItem(item)}\r\n            </ul>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    return <div className=\"card-list-container\">{renderCardList()}</div>;\r\n  }\r\n}\r\n\r\nexport default withRouter(CardList);\r\n","//我的书摘页面\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport CardList from \"./component\";\r\nimport { handleReadingBook } from \"../../store/actions/book\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    digests: state.reader.digests,\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    chapters: state.reader.chapters,\r\n    books: state.manager.books,\r\n    noteSortCode: state.manager.noteSortCode,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingBook,\r\n  handleMessageBox,\r\n  handleMessage,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(CardList as any));\r\n","//笔记书摘的标签\r\nimport React from \"react\";\r\nimport \"./noteTag.css\";\r\nimport { NoteTagProps, NoteTagState } from \"./interface\";\r\nimport TagUtil from \"../../utils/readUtils/tagUtil\";\r\nimport DeleteIcon from \"../deleteIcon\";\r\nimport { Trans } from \"react-i18next\";\r\n\r\nclass NoteTag extends React.Component<NoteTagProps, NoteTagState> {\r\n  constructor(props: NoteTagProps) {\r\n    super(props);\r\n    this.state = {\r\n      tagIndex: [],\r\n      isInput: false,\r\n      deleteIndex: -1,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    if (this.props.isReading) {\r\n      this.setState({ tagIndex: this.tagToIndex(this.props.tag) });\r\n    }\r\n  }\r\n  componentWillReceiveProps(nextProps: NoteTagProps) {\r\n    if (\r\n      this.props.isReading &&\r\n      nextProps.tag &&\r\n      nextProps.tag.length > 0 &&\r\n      this.props.tag !== nextProps.tag\r\n    ) {\r\n      this.setState({ tagIndex: this.tagToIndex(nextProps.tag) });\r\n    }\r\n  }\r\n  tagToIndex = (tag: string[]) => {\r\n    let temp: number[] = [];\r\n    if (!tag) return [];\r\n    for (let i = 0; i < TagUtil.getAllTags().length; i++) {\r\n      if (tag.indexOf(TagUtil.getAllTags()[i]) > -1) {\r\n        temp.push(i);\r\n      }\r\n    }\r\n    return temp;\r\n  };\r\n  indextoTag = (tagIndex: number[]) => {\r\n    let temp: any = [];\r\n    for (let i = 0; i < tagIndex.length; i++) {\r\n      temp.push(TagUtil.getAllTags()[tagIndex[i]]);\r\n    }\r\n    return temp;\r\n  };\r\n  handleChangeTag = (index: number) => {\r\n    let temp: number[] = [...this.state.tagIndex];\r\n    if (this.state.tagIndex.indexOf(index) > -1) {\r\n      temp = [...this.state.tagIndex];\r\n      let indexResult = temp.indexOf(index);\r\n      temp.splice(indexResult, 1);\r\n      this.setState({ tagIndex: temp });\r\n      this.props.handleTag(this.indextoTag(temp));\r\n    } else {\r\n      temp.push(index);\r\n      this.setState({ tagIndex: temp });\r\n      this.props.handleTag(this.indextoTag(temp));\r\n    }\r\n  };\r\n  handleAddTag = (event: any) => {\r\n    this.setState({ isInput: false });\r\n    if (!event.target.value) {\r\n      return;\r\n    }\r\n    TagUtil.setTags(event.target.value);\r\n    this.setState({ tagIndex: [] });\r\n    this.props.handleTag(this.indextoTag([]));\r\n  };\r\n  handleInput = () => {\r\n    this.setState({ isInput: true }, () => {\r\n      document.getElementById(\"newTag\")?.focus();\r\n    });\r\n  };\r\n  render() {\r\n    const renderTag = () => {\r\n      let noteTags = TagUtil.getAllTags();\r\n      return noteTags.map((item: any, index: number) => {\r\n        return (\r\n          <li\r\n            key={item}\r\n            className={\r\n              this.state.tagIndex.indexOf(index) > -1\r\n                ? \"tag-list-item active-tag \"\r\n                : \"tag-list-item\"\r\n            }\r\n          >\r\n            <div className=\"delete-tag-container\">\r\n              {this.state.tagIndex.indexOf(index) > -1 &&\r\n              !this.props.isReading ? (\r\n                <DeleteIcon\r\n                  {...{\r\n                    tagName: item,\r\n                    mode: \"tags\",\r\n                    index: index,\r\n                    handleChangeTag: this.handleChangeTag,\r\n                  }}\r\n                />\r\n              ) : null}\r\n            </div>\r\n            <div\r\n              className=\"center\"\r\n              onClick={() => {\r\n                this.handleChangeTag(index);\r\n              }}\r\n            >\r\n              <Trans>{item}</Trans>\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div\r\n        className=\"note-tag-container\"\r\n        style={this.props.isReading ? { width: \"1999px\" } : {}}\r\n      >\r\n        {this.props.isReading ? null : (\r\n          <span className=\"tag-title\">\r\n            <Trans>All Tags</Trans>\r\n          </span>\r\n        )}\r\n\r\n        <ul className=\"tag-container\">\r\n          <li\r\n            className=\"tag-list-item-new\"\r\n            onClick={() => {\r\n              this.handleInput();\r\n            }}\r\n            style={this.state.isInput ? { width: \"80px\" } : {}}\r\n          >\r\n            <div className=\"center\">\r\n              {this.state.isInput ? (\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"newTag\"\r\n                  id=\"newTag\"\r\n                  onBlur={(event) => {\r\n                    this.handleAddTag(event);\r\n                  }}\r\n                />\r\n              ) : (\r\n                <span className=\"icon-add\"></span>\r\n              )}\r\n            </div>\r\n          </li>\r\n          {renderTag()}\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default NoteTag;\r\n","import { connect } from \"react-redux\";\r\nimport { handleSearchResults, handleSearch } from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport NoteTag from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isReading: state.book.isReading,\r\n    noteKey: state.reader.noteKey,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSearchResults,\r\n  handleSearch,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(NoteTag as any));\r\n","//我的笔记页面\r\nimport React from \"react\";\r\nimport \"./noteList.css\";\r\nimport { NoteListProps, NoteListState } from \"./interface\";\r\nimport CardList from \"../../components/cardList\";\r\nimport NoteTag from \"../../components/noteTag\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport Empty from \"../emptyPage\";\r\n\r\nclass NoteList extends React.Component<NoteListProps, NoteListState> {\r\n  constructor(props: NoteListProps) {\r\n    super(props);\r\n    this.state = {\r\n      tag: [],\r\n    };\r\n  }\r\n  componentWillMount() {\r\n    this.props.handleFetchNotes();\r\n  }\r\n  handleTag = (tag: string[]) => {\r\n    this.setState({ tag });\r\n  };\r\n  handleFilter = (items: any, arr: number[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items[item] && itemArr.push(items[item]);\r\n    });\r\n    return itemArr;\r\n  };\r\n  filterTag = (notes: NoteModel[]) => {\r\n    let temp: NoteModel[] = [];\r\n    for (let i = 0; i < notes.length; i++) {\r\n      let flag = false;\r\n      for (let j = 0; j < this.state.tag.length; j++) {\r\n        if (notes[i].tag && notes[i].tag.indexOf(this.state.tag[j]) > -1) {\r\n          flag = true;\r\n          break;\r\n        }\r\n      }\r\n      if (flag) {\r\n        temp.push(notes[i]);\r\n      }\r\n    }\r\n    return temp;\r\n  };\r\n  render() {\r\n    const noteProps = {\r\n      cards: this.props.isSearch\r\n        ? this.handleFilter(\r\n            this.props.notes.filter((item) => item.notes !== \"\"),\r\n            this.props.searchResults\r\n          )\r\n        : this.state.tag.length > 0\r\n        ? this.filterTag(this.props.notes.filter((item) => item.notes !== \"\"))\r\n        : this.props.notes.filter((item) => item.notes !== \"\"),\r\n      mode: \"note\",\r\n    };\r\n    return (\r\n      <div className=\"note-list-container-parent\">\r\n        <div className=\"note-tags\">\r\n          <NoteTag {...{ handleTag: this.handleTag }} />\r\n        </div>\r\n        {noteProps.cards.length === 0 ? (\r\n          <div\r\n            style={{\r\n              position: \"fixed\",\r\n              left: 0,\r\n              top: 0,\r\n              width: \"100%\",\r\n              height: \"100%\",\r\n              zIndex: -1,\r\n            }}\r\n          >\r\n            <Empty />\r\n          </div>\r\n        ) : (\r\n          <CardList {...noteProps} />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NoteList;\r\n","//我的笔记页面\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport NoteList from \"./component\";\r\nimport { handleFetchNotes } from \"../../store/actions/reader\";\r\n\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    notes: state.reader.notes,\r\n    isSearch: state.manager.isSearch,\r\n    searchResults: state.manager.searchResults,\r\n  };\r\n};\r\nconst actionCreator = { handleFetchNotes };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(NoteList as any));\r\n","//我的书摘页面\r\nimport React from \"react\";\r\nimport \"./digestList.css\";\r\nimport { DigestListProps, DigestListStates } from \"./interface\";\r\nimport CardList from \"../../components/cardList\";\r\nimport NoteTag from \"../../components/noteTag\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport Empty from \"../emptyPage\";\r\n\r\nclass DigestList extends React.Component<DigestListProps, DigestListStates> {\r\n  constructor(props: DigestListProps) {\r\n    super(props);\r\n    this.state = {\r\n      tag: [],\r\n    };\r\n  }\r\n  componentWillMount() {\r\n    this.props.handleFetchNotes();\r\n  }\r\n  handleFilter = (items: any, arr: number[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items[item] && itemArr.push(items[item]);\r\n    });\r\n    return itemArr;\r\n  };\r\n  handleTag = (tag: string[]) => {\r\n    this.setState({ tag });\r\n  };\r\n  filterTag = (digests: NoteModel[]) => {\r\n    let temp: NoteModel[] = [];\r\n    for (let i = 0; i < digests.length; i++) {\r\n      let flag = false;\r\n      for (let j = 0; j < this.state.tag.length; j++) {\r\n        if (digests[i].tag && digests[i].tag.indexOf(this.state.tag[j]) > -1) {\r\n          flag = true;\r\n          break;\r\n        }\r\n      }\r\n      if (flag) {\r\n        temp.push(digests[i]);\r\n      }\r\n    }\r\n    return temp;\r\n  };\r\n  render() {\r\n    const noteProps = {\r\n      cards: this.props.isSearch\r\n        ? this.handleFilter(this.props.digests, this.props.searchResults)\r\n        : this.state.tag.length > 0\r\n        ? this.filterTag(this.props.digests)\r\n        : this.props.digests,\r\n      mode: \"digest\",\r\n    };\r\n\r\n    return (\r\n      <div className=\"digest-list-container-parent\">\r\n        <div className=\"note-tags\">\r\n          <NoteTag {...{ handleTag: this.handleTag }} />\r\n        </div>\r\n        {noteProps.cards.length === 0 ? (\r\n          <div\r\n            style={{\r\n              position: \"fixed\",\r\n              left: 0,\r\n              top: 0,\r\n              width: \"100%\",\r\n              height: \"100%\",\r\n              zIndex: -1,\r\n            }}\r\n          >\r\n            <Empty />\r\n          </div>\r\n        ) : (\r\n          <CardList {...noteProps} />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DigestList;\r\n","//我的书摘页面\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport DigestList from \"./component\";\r\nimport { handleFetchNotes } from \"../../store/actions/reader\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    digests: state.reader.digests,\r\n    isSearch: state.manager.isSearch,\r\n    searchResults: state.manager.searchResults,\r\n  };\r\n};\r\nconst actionCreator = { handleFetchNotes };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(DigestList as any));\r\n","//图书加载前的动画\r\nimport React from \"react\";\r\nimport \"./loadingPage.css\";\r\nimport { LoadingPageProps } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nclass LoadingPage extends React.Component<LoadingPageProps> {\r\n  render() {\r\n    if (this.props.books) {\r\n      return <Redirect to=\"/manager/home\" />;\r\n    }\r\n    let arr: number[] = [];\r\n    for (\r\n      let i = 0;\r\n      i < parseInt(OtherUtil.getReaderConfig(\"totalBooks\") || \"0\");\r\n      i++\r\n    ) {\r\n      arr.push(i);\r\n    }\r\n    if (OtherUtil.getReaderConfig(\"viewMode\") !== \"list\") {\r\n      const renderLoadingCard = () => {\r\n        return arr.map((item, index) => {\r\n          return (\r\n            <div className=\"loading-page-book\" key={item}>\r\n              <div\r\n                className=\"loading-page-cover\"\r\n                style={{ opacity: `${(index % 7) * 0.2}` }}\r\n              ></div>\r\n            </div>\r\n          );\r\n        });\r\n      };\r\n      return (\r\n        <div className=\"loading-page-container-parent\">\r\n          <div className=\"loading-page-container\">{renderLoadingCard()}</div>\r\n        </div>\r\n      );\r\n    } else {\r\n      const renderLoadingList = () => {\r\n        return arr.map((item, index) => {\r\n          return (\r\n            <div className=\"loading-page-list\" key={item}>\r\n              <div className=\"loading-page-list-cover\"></div>\r\n              <div className=\"loading-page-bar\">\r\n                <div className=\"loading-page-bar1\"></div>\r\n                <div className=\"loading-page-bar2\"></div>\r\n                <div className=\"loading-page-bar3\"></div>\r\n              </div>\r\n            </div>\r\n          );\r\n        });\r\n      };\r\n      return (\r\n        <div className=\"loading-page-container-parent\">\r\n          <div className=\"loading-page-container\" style={{ marginTop: \"8px\" }}>\r\n            {renderLoadingList()}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default LoadingPage;\r\n","//图书加载前的动画\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport LoadingPage from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(mapStateToProps, actionCreator)(LoadingPage);\r\n","import BookList from \"../containers/bookList\";\r\nimport DeletedBookList from \"../containers/deletedBookList\";\r\nimport NoteList from \"../containers/noteList\";\r\nimport DigestList from \"../containers/digestList\";\r\nimport EmptyPage from \"../containers/emptyPage\";\r\nimport LoadingPage from \"../containers/loadingPage\";\r\n\r\nexport const routes = [\r\n  { path: \"/manager/empty\", component: EmptyPage },\r\n  { path: \"/manager/loading\", component: LoadingPage },\r\n  { path: \"/manager/note\", component: NoteList },\r\n  { path: \"/manager/digest\", component: DigestList },\r\n  { path: \"/manager/home\", component: BookList },\r\n  { path: \"/manager/favorite\", component: BookList },\r\n  { path: \"/manager/trash\", component: DeletedBookList },\r\n];\r\n","import React from \"react\";\r\nimport \"./arrow.css\";\r\nconst Arrow = () => {\r\n  return (\r\n    <div className=\"arrow-container\">\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width=\"48\"\r\n        height=\"48\"\r\n        viewBox=\"0 0 48 48\"\r\n        className=\"circle\"\r\n      >\r\n        <g\r\n          transform=\"translate(48 48) rotate(180)\"\r\n          fill=\"none\"\r\n          stroke=\"rgba(255,255,255,0.4)\"\r\n          strokeWidth=\"1.5\"\r\n        >\r\n          <circle cx=\"24\" cy=\"24\" r=\"24\" stroke=\"none\" />\r\n          <circle cx=\"24\" cy=\"24\" r=\"23.25\" fill=\"none\" />\r\n        </g>\r\n      </svg>\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width=\"7\"\r\n        height=\"40.5\"\r\n        viewBox=\"0 0 9 64.5\"\r\n        className=\"arrow\"\r\n      >\r\n        <g transform=\"translate(-799.5 -100)\">\r\n          <line\r\n            y2=\"59\"\r\n            transform=\"translate(804 163.5) rotate(180)\"\r\n            fill=\"none\"\r\n            stroke=\"#fff\"\r\n            strokeLinecap=\"round\"\r\n            strokeWidth=\"2\"\r\n          />\r\n          <path\r\n            d=\"M4.5,0,9,8H0Z\"\r\n            transform=\"translate(799.5 100)\"\r\n            fill=\"#fff\"\r\n          />\r\n        </g>\r\n      </svg>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Arrow;\r\n","import React from \"react\";\r\nimport \"./loadingDialog.css\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationData from \"../../assets/loading.json\";\r\nimport { Trans } from \"react-i18next\";\r\nconst defaultOptions = {\r\n  loop: true,\r\n  autoplay: true,\r\n  animationData: animationData,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\nconst LoadingDialog = (props) => {\r\n  return (\r\n    <div className=\"loading-dialog\">\r\n      <div className=\"loading-dialog-title\">\r\n        <Trans>Please Wait a moment</Trans>\r\n      </div>\r\n      <div className=\"loading-animation\">\r\n        <Lottie options={defaultOptions} height={250} width={280} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default LoadingDialog;\r\n","//提示更新的文字\r\nimport React from \"react\";\r\nimport \"./updateInfo.css\";\r\nimport { DownloadDeskProps, DownloadDeskState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationDownload from \"../../assets/download.json\";\r\n\r\nconst downloadOptions = {\r\n  loop: true,\r\n  autoplay: true,\r\n  animationData: animationDownload,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\ndeclare var window: any;\r\n\r\nclass DownloadDesk extends React.Component<\r\n  DownloadDeskProps,\r\n  DownloadDeskState\r\n> {\r\n  constructor(props: DownloadDeskProps) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n\r\n  handleClose = () => {\r\n    this.props.handleDownloadDesk(false);\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"download-desk-container\">\r\n        <div\r\n          className=\"setting-close-container\"\r\n          onClick={() => {\r\n            this.handleClose();\r\n          }}\r\n        >\r\n          <span className=\"icon-close\"></span>\r\n        </div>\r\n\r\n        <div className=\"download-desk-title\">\r\n          <Trans>Download Desktop Version</Trans>\r\n        </div>\r\n        <div className=\"download-desk-subtile\">\r\n          <Trans>\r\n            Koodo Reader's web version are limited by the browser, for more\r\n            powerful features, please download the desktop version.\r\n          </Trans>\r\n        </div>\r\n        <div className=\"download-desk-feature-container\">\r\n          <div className=\"download-desk-feature-item\">\r\n            <Trans>More formats supported</Trans>\r\n          </div>\r\n          <div className=\"download-desk-feature-item\">\r\n            <Trans>Use the fonts from your local computer</Trans>\r\n          </div>\r\n          <div className=\"download-desk-feature-item\">\r\n            <Trans>Backup your data with Webdav</Trans>\r\n          </div>\r\n        </div>\r\n        <div\r\n          className=\"download-desk-button\"\r\n          onClick={() => {\r\n            window.open(\"https://koodo.960960.xyz/download\");\r\n          }}\r\n        >\r\n          <Trans>Download</Trans>\r\n        </div>\r\n        <div className=\"download-desk-animation\">\r\n          <Lottie options={downloadOptions} height={250} width={350} />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DownloadDesk;\r\n","//左下角的图标外链\r\nimport { connect } from \"react-redux\";\r\nimport { handleDownloadDesk } from \"../../store/actions/manager\";\r\nimport DownloadDesk from \"./component\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {};\r\n};\r\nconst actionCreator = {\r\n  handleDownloadDesk,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(DownloadDesk as any));\r\n","import React from \"react\";\r\nimport Sidebar from \"../../containers/sidebar\";\r\nimport Header from \"../../containers/header\";\r\nimport DeleteDialog from \"../../containers/deleteDialog\";\r\nimport EditDialog from \"../../containers/editDialog\";\r\nimport AddDialog from \"../../containers/addDialog\";\r\nimport SortDialog from \"../../containers/sortDialog\";\r\nimport MessageBox from \"../../containers/messageBox\";\r\nimport BackupDialog from \"../../containers/backupDialog\";\r\nimport \"./manager.css\";\r\nimport { ManagerProps, ManagerState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport SettingDialog from \"../../components/settingDialog\";\r\nimport { isMobileOnly } from \"react-device-detect\";\r\nimport { Route, Switch, Redirect } from \"react-router-dom\";\r\nimport { routes } from \"../../router/routes\";\r\nimport Arrow from \"../../components/arrow\";\r\nimport LoadingDialog from \"../../components/loadingDialog\";\r\nimport DownloadDesk from \"../../components/downloadDesk\";\r\n// declare var window: any;\r\n\r\n//判断是否为触控设备\r\nconst is_touch_device = () => {\r\n  return \"ontouchstart\" in window;\r\n};\r\nconst isElectron = require(\"is-electron\");\r\nclass Manager extends React.Component<ManagerProps, ManagerState> {\r\n  timer!: NodeJS.Timeout;\r\n  constructor(props: ManagerProps) {\r\n    super(props);\r\n    this.state = {\r\n      totalBooks: parseInt(OtherUtil.getReaderConfig(\"totalBooks\") || \"0\") || 0,\r\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\r\n      isAuthed: false,\r\n      isError: false,\r\n      isCopied: false,\r\n      isUpdated: false,\r\n      isDrag: false,\r\n      token: \"\",\r\n    };\r\n  }\r\n  //从indexdb里读取书籍\r\n  UNSAFE_componentWillMount() {\r\n    this.props.handleFetchBooks();\r\n    this.props.handleFetchNotes();\r\n    this.props.handleFetchBookmarks();\r\n    this.props.handleFetchBookSortCode();\r\n    this.props.handleFetchList();\r\n  }\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps: ManagerProps) {\r\n    if (nextProps.books && this.state.totalBooks !== nextProps.books.length) {\r\n      this.setState(\r\n        {\r\n          totalBooks: nextProps.books.length,\r\n        },\r\n        () => {\r\n          OtherUtil.setReaderConfig(\r\n            \"totalBooks\",\r\n            this.state.totalBooks.toString()\r\n          );\r\n        }\r\n      );\r\n    }\r\n    if (nextProps.books && nextProps.books.length === 1 && !this.props.books) {\r\n      this.props.history.push(\"/manager/home\");\r\n    }\r\n    if (this.props.mode !== nextProps.mode) {\r\n      this.setState({\r\n        favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\r\n      });\r\n    }\r\n    if (nextProps.isMessage) {\r\n      this.timer = setTimeout(() => {\r\n        this.props.handleMessageBox(false);\r\n      }, 2000);\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    if (is_touch_device() && !OtherUtil.getReaderConfig(\"isTouch\")) {\r\n      OtherUtil.setReaderConfig(\"isTouch\", \"yes\");\r\n    }\r\n  }\r\n\r\n  handleDrag = (isDrag: boolean) => {\r\n    this.setState({ isDrag });\r\n  };\r\n  componentWillUnmout() {\r\n    clearTimeout(this.timer);\r\n  }\r\n\r\n  render() {\r\n    let { books } = this.props;\r\n    if (isMobileOnly) {\r\n      return (\r\n        <>\r\n          <p className=\"waring-title\">\r\n            <Trans>Warning</Trans>\r\n          </p>\r\n          <div className=\"mobile-warning\">\r\n            <span>\r\n              <Trans>\r\n                For better user experince, please visit this site on a computer\r\n              </Trans>\r\n            </span>\r\n          </div>\r\n          <div>\r\n            <img\r\n              src={\r\n                process.env.NODE_ENV === \"production\"\r\n                  ? \"./assets/empty.svg\"\r\n                  : \"../../assets/empty.svg\"\r\n              }\r\n              alt=\"\"\r\n              className=\"waring-pic\"\r\n            />\r\n          </div>\r\n        </>\r\n      );\r\n    }\r\n    return (\r\n      <div\r\n        className=\"manager\"\r\n        onDragEnter={() => {\r\n          !this.props.dragItem && this.handleDrag(true);\r\n          (document.getElementsByClassName(\r\n            \"import-from-local\"\r\n          )[0] as any).style.zIndex = \"50\";\r\n        }}\r\n      >\r\n        {this.state.isDrag && !this.props.dragItem && (\r\n          <div className=\"drag-background\">\r\n            <div className=\"drag-info\">\r\n              <Arrow />\r\n              <p className=\"arrow-text\">\r\n                <Trans>Drop your books here</Trans>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n        <Sidebar />\r\n        <Header {...{ handleDrag: this.handleDrag }} />\r\n        {this.props.isOpenDeleteDialog && <DeleteDialog />}\r\n        {this.props.isOpenEditDialog && <EditDialog />}\r\n        {this.props.isOpenAddDialog && <AddDialog />}\r\n        {this.props.isShowLoading && <LoadingDialog />}\r\n        {\r\n          <div\r\n            className=\"drag-background\"\r\n            style={\r\n              this.props.isSettingOpen ||\r\n              this.props.isBackup ||\r\n              this.props.isShowNew ||\r\n              this.props.isOpenDeleteDialog ||\r\n              this.props.isOpenEditDialog ||\r\n              this.props.isOpenAddDialog ||\r\n              this.props.isDownloadDesk ||\r\n              this.props.isShowLoading\r\n                ? {}\r\n                : {\r\n                    display: \"none\",\r\n                  }\r\n            }\r\n          ></div>\r\n        }\r\n\r\n        {this.props.isMessage && <MessageBox />}\r\n        <SortDialog />\r\n        {this.props.isBackup && <BackupDialog />}\r\n        {this.props.isSettingOpen && <SettingDialog />}\r\n        {this.props.isDownloadDesk && !isElectron() && <DownloadDesk />}\r\n        {(!books || books.length === 0) && this.state.totalBooks ? (\r\n          <Redirect to=\"/manager/loading\" />\r\n        ) : (\r\n          <Switch>\r\n            {routes.map((ele) => (\r\n              <Route\r\n                render={() => <ele.component />}\r\n                key={ele.path}\r\n                path={ele.path}\r\n              />\r\n            ))}\r\n          </Switch>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Manager;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleFetchBooks,\r\n  handleFetchBookSortCode,\r\n  handleFetchList,\r\n  handleMessageBox,\r\n} from \"../../store/actions/manager\";\r\nimport {\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n} from \"../../store/actions/reader\";\r\nimport \"./manager.css\";\r\nimport { stateType } from \"../../store\";\r\nimport Manager from \"./component\";\r\nimport { withRouter } from \"react-router-dom\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n    bookmarks: state.reader.bookmarks,\r\n    isReading: state.book.isReading,\r\n    mode: state.sidebar.mode,\r\n    dragItem: state.book.dragItem,\r\n    shelfIndex: state.sidebar.shelfIndex,\r\n    isOpenEditDialog: state.book.isOpenEditDialog,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    isOpenAddDialog: state.book.isOpenAddDialog,\r\n    isSettingOpen: state.manager.isSettingOpen,\r\n    isBookSort: state.manager.isBookSort,\r\n    isSortDisplay: state.manager.isSortDisplay,\r\n    isShowLoading: state.manager.isShowLoading,\r\n    isShowNew: state.manager.isShowNew,\r\n    isDownloadDesk: state.manager.isDownloadDesk,\r\n    isMessage: state.manager.isMessage,\r\n    isBackup: state.backupPage.isBackup,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchBooks,\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleFetchBookSortCode,\r\n  handleFetchList,\r\n  handleMessageBox,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(withRouter(Manager));\r\n","import RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nexport function handleLocations(locations: any) {\r\n  return { type: \"HANDLE_LOCATIONS\", payload: locations };\r\n}\r\nexport function handlePercentage(percentage: number) {\r\n  return { type: \"HANDLE_PERCENTAGE\", payload: percentage };\r\n}\r\nexport function handleFetchPercentage(book: { key: string }) {\r\n  return (dispatch: (arg0: { type: string; payload: any }) => void) => {\r\n    let percentage = RecordLocation.getCfi(book.key).percentage;\r\n    dispatch(handlePercentage(percentage));\r\n  };\r\n}\r\nexport function handleFetchLocations(epub: any) {\r\n  return (dispatch: (arg0: { type: string; payload: any }) => void) => {\r\n    epub.locations\r\n      .generate()\r\n      .then((result: any) => {\r\n        dispatch(handleLocations(epub.locations));\r\n      })\r\n      .catch(() => {\r\n        console.log(\"Error occurs\");\r\n      });\r\n  };\r\n}\r\n","class Note {\n  key: string;\n  bookKey: string;\n  date: { year: number; month: number; day: number };\n  chapter: string;\n  chapterIndex: number;\n  text: string;\n  cfi: string;\n  range: string;\n  notes: string;\n  percentage: number;\n  color: number;\n  tag: string[];\n  constructor(\n    bookKey: string,\n    chapter: string,\n    chapterIndex: number,\n    text: string,\n    cfi: string,\n    range: string,\n    notes: string,\n    percentage: number,\n    color: number,\n    tag: string[]\n  ) {\n    this.key = new Date().getTime() + \"\"; //笔记的键值\n    this.bookKey = bookKey; //笔记的所在书的键值\n    this.date = {\n      year: new Date().getFullYear(),\n      month: new Date().getMonth() + 1,\n      day: new Date().getDate(),\n    }; //笔记的添加日期\n    this.chapter = chapter; //笔记的所在章节\n    this.chapterIndex = chapterIndex; //笔记的所在章节\n    this.text = text; //笔记对应的书本的内容\n    this.cfi = cfi; //添加笔记的位置\n    this.range = range; // Rangy.js产生的将Range对象序列化后的字符串\n    this.notes = notes || \"\"; //笔记的内容\n    this.percentage = percentage; //笔记在文中的进度\n    this.color = color; //笔记高亮的颜色\n    this.tag = tag; //笔记高亮的颜色\n  }\n}\n\nexport default Note;\n","//添加笔记的弹窗\r\nimport React from \"react\";\r\nimport \"./popupNote.css\";\r\nimport Note from \"../../model/Note\";\r\nimport localforage from \"localforage\";\r\nimport { PopupNoteProps, PopupNoteState } from \"./interface\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport NoteTag from \"../noteTag\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport { Trans } from \"react-i18next\";\r\n\r\ndeclare var window: any;\r\n\r\nclass PopupNote extends React.Component<PopupNoteProps, PopupNoteState> {\r\n  constructor(props: PopupNoteProps) {\r\n    super(props);\r\n    this.state = { tag: [] };\r\n  }\r\n  componentDidMount() {\r\n    let textArea: any = document.querySelector(\".editor-box\");\r\n    textArea && textArea.focus();\r\n  }\r\n  handleTag = (tag: string[]) => {\r\n    this.setState({ tag });\r\n  };\r\n  createNote() {\r\n    let notes = (document.querySelector(\".editor-box\") as HTMLInputElement)\r\n      .value;\r\n\r\n    if (this.props.noteKey) {\r\n      //编辑笔记\r\n      this.props.notes.forEach((item) => {\r\n        if (item.key === this.props.noteKey) {\r\n          item.notes = notes;\r\n          item.tag = this.state.tag;\r\n        }\r\n      });\r\n      localforage.setItem(\"notes\", this.props.notes).then(() => {\r\n        this.props.handleOpenMenu(false);\r\n        this.props.handleMessage(\"Add Successfully\");\r\n        this.props.handleMessageBox(true);\r\n        this.props.handleFetchNotes();\r\n        this.props.handleMenuMode(\"highlight\");\r\n        this.props.handleNoteKey(\"\");\r\n        console.log(\"edit\");\r\n      });\r\n    } else {\r\n      //创建笔记\r\n      let bookKey = this.props.currentBook.key;\r\n      const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n      let chapterHref = currentLocation.start.href;\r\n      let chapterIndex = currentLocation.start.index;\r\n      let chapter = \"Unknown Chapter\";\r\n      let currentChapter = this.props.flattenChapters.filter(\r\n        (item: any) => item.href.split(\"#\")[0] === chapterHref\r\n      )[0];\r\n      if (currentChapter) {\r\n        chapter = currentChapter.label.trim(\" \");\r\n      }\r\n\r\n      const cfi = RecordLocation.getCfi(this.props.currentBook.key).cfi;\r\n\r\n      let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n      if (!iframe) return;\r\n      let doc = iframe.contentDocument;\r\n      if (!doc) {\r\n        return;\r\n      }\r\n      let charRange = window.rangy\r\n        .getSelection(iframe)\r\n        .saveCharacterRanges(doc.body)[0];\r\n      let range = JSON.stringify(charRange);\r\n      let text = doc.getSelection()?.toString();\r\n      if (!text) {\r\n        return;\r\n      }\r\n      text = text.replace(/\\s\\s/g, \"\");\r\n      text = text.replace(/\\r/g, \"\");\r\n      text = text.replace(/\\n/g, \"\");\r\n      text = text.replace(/\\t/g, \"\");\r\n      text = text.replace(/\\f/g, \"\");\r\n      let percentage = RecordLocation.getCfi(this.props.currentBook.key)\r\n        .percentage\r\n        ? RecordLocation.getCfi(this.props.currentBook.key).percentage\r\n        : 0;\r\n\r\n      let color = this.props.color || 0;\r\n      let tag = this.state.tag;\r\n      let note = new Note(\r\n        bookKey,\r\n        chapter,\r\n        chapterIndex,\r\n        text,\r\n        cfi,\r\n        range,\r\n        notes,\r\n        percentage,\r\n        color,\r\n        tag\r\n      );\r\n      let noteArr = this.props.notes;\r\n      noteArr.push(note);\r\n      localforage.setItem(\"notes\", noteArr).then(() => {\r\n        this.props.handleOpenMenu(false);\r\n        this.props.handleMessage(\"Add Successfully\");\r\n        this.props.handleMessageBox(true);\r\n        this.props.handleFetchNotes();\r\n        this.props.handleMenuMode(\"highlight\");\r\n        console.log(\"new\");\r\n      });\r\n    }\r\n  }\r\n  handleClose = () => {\r\n    let noteIndex = -1;\r\n    console.log(this.props.noteKey);\r\n    if (this.props.noteKey) {\r\n      this.props.notes.forEach((item, index) => {\r\n        if (item.key === this.props.noteKey) {\r\n          noteIndex = index;\r\n        }\r\n      });\r\n      if (noteIndex > -1) {\r\n        this.props.notes.splice(noteIndex, 1);\r\n        localforage.setItem(\"notes\", this.props.notes).then(() => {\r\n          this.props.handleOpenMenu(false);\r\n          this.props.handleMenuMode(\"menu\");\r\n          this.props.handleMessage(\"Delete Successfully\");\r\n          this.props.handleMessageBox(true);\r\n          this.props.handleMenuMode(\"highlight\");\r\n\r\n          this.props.handleNoteKey(\"\");\r\n        });\r\n      }\r\n    } else {\r\n      this.props.handleOpenMenu(false);\r\n      this.props.handleMenuMode(\"menu\");\r\n      this.props.handleNoteKey(\"\");\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let note: NoteModel;\r\n    if (this.props.noteKey) {\r\n      this.props.notes.forEach((item) => {\r\n        if (item.key === this.props.noteKey) {\r\n          note = item;\r\n        }\r\n      });\r\n    }\r\n\r\n    const renderNoteEditor = () => {\r\n      return (\r\n        <div className=\"note-editor\">\r\n          <div className=\"editor-box-parent\">\r\n            <textarea className=\"editor-box\" />\r\n          </div>\r\n          <div\r\n            className=\"note-tags\"\r\n            style={{ position: \"absolute\", bottom: \"0px\", height: \"70px\" }}\r\n          >\r\n            <NoteTag\r\n              {...{\r\n                handleTag: this.handleTag,\r\n                tag: this.props.noteKey ? note.tag : [],\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"note-button-container\">\r\n            <span\r\n              className=\"cancel-button\"\r\n              onClick={() => {\r\n                this.handleClose();\r\n              }}\r\n            >\r\n              {this.props.noteKey ? (\r\n                <Trans>Delete</Trans>\r\n              ) : (\r\n                <Trans>Cancel</Trans>\r\n              )}\r\n            </span>\r\n            <span\r\n              className=\"confirm-button\"\r\n              onClick={() => {\r\n                this.createNote();\r\n              }}\r\n            >\r\n              <Trans>Confirm</Trans>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      );\r\n    };\r\n    return renderNoteEditor();\r\n  }\r\n}\r\nexport default PopupNote;\r\n","import { connect } from \"react-redux\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport { handleOpenMenu, handleMenuMode } from \"../../store/actions/viewArea\";\r\nimport { handleNoteKey, handleFetchNotes } from \"../../store/actions/reader\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport PopupNote from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n    notes: state.reader.notes,\r\n    color: state.reader.color,\r\n    flattenChapters: state.reader.flattenChapters,\r\n    noteKey: state.reader.noteKey,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleNoteKey,\r\n  handleFetchNotes,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(PopupNote as any));\r\n","//高亮，下划线颜色选择\r\nimport React from \"react\";\r\nimport \"./colorOption.css\";\r\nimport { ColorProps, ColorStates } from \"./interface\";\r\n\r\nclass ColorOption extends React.Component<ColorProps, ColorStates> {\r\n  constructor(props: ColorProps) {\r\n    super(props);\r\n    this.state = {\r\n      isLine: false,\r\n    };\r\n  }\r\n  handleChangeOptiion = () => {\r\n    this.setState({ isLine: !this.state.isLine });\r\n  };\r\n  render() {\r\n    const renderLine = () => {\r\n      return [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"].map((item, index) => {\r\n        return (\r\n          <div\r\n            className=\"line-option\"\r\n            style={{\r\n              border: `${\r\n                this.props.color === index + 4\r\n                  ? \"2px solid rgba(75,75,75,1)\"\r\n                  : \"\"\r\n              }`,\r\n            }}\r\n            key={item}\r\n            onClick={() => {\r\n              this.props.handleColor(index + 4);\r\n            }}\r\n          >\r\n            <div\r\n              className=\"demo-line\"\r\n              style={{ borderBottom: `solid 2px ${item}` }}\r\n            ></div>\r\n          </div>\r\n        );\r\n      });\r\n    };\r\n    const renderColor = () => {\r\n      return [\"#FBF1D1\", \"#EFEEB0\", \"#CAEFC9\", \"#76BEE9\"].map((item, index) => {\r\n        return (\r\n          <div\r\n            className=\"color-option\"\r\n            style={{\r\n              backgroundColor: item,\r\n              border: `${\r\n                this.props.color === index ? \"2px solid rgba(75,75,75,1)\" : \"\"\r\n              }`,\r\n            }}\r\n            key={item}\r\n            onClick={() => {\r\n              this.props.handleColor(index);\r\n            }}\r\n          ></div>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div className=\"color-option-container\">\r\n        {!this.state.isLine && renderColor()}\r\n        <span\r\n          className=\"icon-sort popup-color-more\"\r\n          onClick={() => {\r\n            this.handleChangeOptiion();\r\n          }}\r\n        ></span>\r\n        {this.state.isLine && renderLine()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ColorOption;\r\n","//左下角的图标外链\r\nimport { connect } from \"react-redux\";\r\nimport { handleColor } from \"../../store/actions/reader\";\r\nimport { stateType } from \"../../store\";\r\nimport About from \"./component\";\r\nimport { handleSelection } from \"../../store/actions/viewArea\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    color: state.reader.color,\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleColor,\r\n  handleSelection,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(About);\r\n","//选中文字后的弹窗，四个按钮\r\nimport React from \"react\";\r\nimport \"./popupOption.css\";\r\nimport localforage from \"localforage\";\r\nimport Note from \"../../model/Note\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { PopupOptionProps } from \"./interface\";\r\nimport ColorOption from \"../colorOption\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\n\r\ndeclare var window: any;\r\n\r\nclass PopupOption extends React.Component<PopupOptionProps> {\r\n  handleNote = () => {\r\n    this.props.handleChangeDirection(false);\r\n    this.props.handleMenuMode(\"note\");\r\n    let rect = this.props.rect;\r\n    let x = rect.x % this.props.currentEpub.rendition._layout.width;\r\n    let y = rect.y % this.props.currentEpub.rendition._layout.height;\r\n    let height = 200;\r\n    let posX = x + rect.width / 2 - 20;\r\n    //防止menu超出图书\r\n    let rightEdge = this.props.currentEpub.rendition._layout.width - 200;\r\n    var posY;\r\n    //控制menu方向\r\n    if (y < height) {\r\n      this.props.handleChangeDirection(true);\r\n      posY = y + 77;\r\n    } else {\r\n      posY = y - height / 2 - rect.height;\r\n    }\r\n\r\n    posY = posY < 6 ? 6 : posY;\r\n    posX = posX < 10 ? 10 : x > rightEdge ? rightEdge : posX;\r\n\r\n    let popupMenu = document.querySelector(\".popup-menu-container\");\r\n    popupMenu &&\r\n      popupMenu.setAttribute(\"style\", `left:${posX}px;top:${posY}px`);\r\n  };\r\n  handleCopy = () => {\r\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    let text = doc.execCommand(\"copy\", false);\r\n    !text\r\n      ? console.log(\"failed to copy text to clipboard\")\r\n      : console.log(\"copied!\");\r\n    this.props.handleOpenMenu(false);\r\n    doc.getSelection()!.empty();\r\n    this.props.handleMessage(\"Copy Successfully\");\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  handleTrans = () => {\r\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    let sel = doc.getSelection();\r\n    if (!sel) return;\r\n    let text = sel.toString();\r\n    text = text && text.trim();\r\n    this.props.handleMenuMode(\"trans\");\r\n    this.props.handleOriginalText(text);\r\n  };\r\n  handleDigest = () => {\r\n    let bookKey = this.props.currentBook.key;\r\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n    let chapterHref = currentLocation.start.href;\r\n    let chapterIndex = currentLocation.start.index;\r\n    let chapter = \"Unknown Chapter\";\r\n    let currentChapter = this.props.flattenChapters.filter(\r\n      (item: any) => item.href.split(\"#\")[0] === chapterHref\r\n    )[0];\r\n    if (currentChapter) {\r\n      chapter = currentChapter.label.trim(\" \");\r\n    }\r\n    const cfi = RecordLocation.getCfi(this.props.currentBook.key).cfi;\r\n\r\n    let percentage = RecordLocation.getCfi(this.props.currentBook.key)\r\n      .percentage\r\n      ? RecordLocation.getCfi(this.props.currentBook.key).percentage\r\n      : 0;\r\n    let color = this.props.color;\r\n    let notes = \"\";\r\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    let charRange = window.rangy\r\n      .getSelection(iframe)\r\n      .saveCharacterRanges(doc.body)[0];\r\n    let range = JSON.stringify(charRange);\r\n    let text = doc.getSelection()?.toString();\r\n    if (!text) return;\r\n    text = text.replace(/\\s\\s/g, \"\");\r\n    text = text.replace(/\\r/g, \"\");\r\n    text = text.replace(/\\n/g, \"\");\r\n    text = text.replace(/\\t/g, \"\");\r\n    text = text.replace(/\\f/g, \"\");\r\n    let digest = new Note(\r\n      bookKey,\r\n      chapter,\r\n      chapterIndex,\r\n      text,\r\n      cfi,\r\n      range,\r\n      notes,\r\n      percentage,\r\n      color,\r\n      []\r\n    );\r\n    let noteArr = this.props.notes;\r\n    noteArr.push(digest);\r\n    localforage.setItem(\"notes\", noteArr).then(() => {\r\n      this.props.handleOpenMenu(false);\r\n      this.props.handleMessage(\"Add Successfully\");\r\n      this.props.handleMessageBox(true);\r\n      this.props.handleFetchNotes();\r\n      this.props.handleMenuMode(\"highlight\");\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const renderMenuList = () => {\r\n      return (\r\n        <>\r\n          <div className=\"menu-list\">\r\n            <div\r\n              className=\"note-option\"\r\n              onClick={() => {\r\n                this.handleNote();\r\n              }}\r\n            >\r\n              <div>\r\n                <span className=\"icon-note note-icon\"></span>\r\n                <p>\r\n                  <Trans>Take Notes</Trans>\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div\r\n              className=\"digest-option\"\r\n              onClick={() => {\r\n                this.handleDigest();\r\n              }}\r\n            >\r\n              <div>\r\n                <span className=\"icon-collect digest-icon\"></span>\r\n                <p>\r\n                  <Trans>Collect</Trans>\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div\r\n              className=\"translation-option\"\r\n              onClick={() => {\r\n                this.handleTrans();\r\n              }}\r\n            >\r\n              <div>\r\n                <span className=\"icon-translation translation-icon\"></span>\r\n                <p>\r\n                  <Trans>Translate</Trans>\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div\r\n              className=\"copy-option icon\"\r\n              onClick={() => {\r\n                this.handleCopy();\r\n              }}\r\n            >\r\n              <div>\r\n                <span className=\"icon-copy copy-icon\"></span>\r\n                <p>\r\n                  <Trans>Copy</Trans>\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <ColorOption />\r\n        </>\r\n      );\r\n    };\r\n    return renderMenuList();\r\n  }\r\n}\r\n\r\nexport default PopupOption;\r\n","import { connect } from \"react-redux\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport {\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleChangeDirection,\r\n} from \"../../store/actions/viewArea\";\r\nimport {\r\n  handleFetchNotes,\r\n  handleOriginalText,\r\n} from \"../../store/actions/reader\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport PopupOption from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    currentEpub: state.book.currentEpub,\r\n    selection: state.viewArea.selection,\r\n    notes: state.reader.notes,\r\n    color: state.reader.color,\r\n    flattenChapters: state.reader.flattenChapters,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleFetchNotes,\r\n  handleOriginalText,\r\n  handleChangeDirection,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(PopupOption as any));\r\n","//翻译弹窗\r\nimport React from \"react\";\r\nimport \"./popupTrans.css\";\r\nimport { PopupTransProps, PopupTransState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport md5 from \"md5\";\r\n\r\nclass PopupTrans extends React.Component<PopupTransProps, PopupTransState> {\r\n  constructor(props: PopupTransProps) {\r\n    super(props);\r\n    this.state = {\r\n      translatedText: \"\",\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    let lng = OtherUtil.getReaderConfig(\"lang\");\r\n    //兼容之前的版本\r\n    if (lng === \"cn\") {\r\n      lng = \"zh\";\r\n    }\r\n    var script = document.createElement(\"script\");\r\n    script.type = \"text/javascript\";\r\n    script.src = `https://fanyi-api.baidu.com/api/trans/vip/translate?q=${\r\n      this.props.originalText\r\n    }&from=auto&to=${\r\n      lng || \"zh\"\r\n    }&appid=20200802000531425&salt=1435660288&sign=${md5(\r\n      \"20200802000531425\" +\r\n        this.props.originalText +\r\n        \"1435660288\" +\r\n        \"sJRHTorJq8j8_ru2GkHl\"\r\n    )}&callback=handleCallback`;\r\n    document.head.appendChild(script);\r\n    (window as any).handleCallback = (res: any) => {\r\n      this.setState({\r\n        translatedText: res.trans_result ? res.trans_result[0].dst : \"出错了\",\r\n      });\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const renderNoteEditor = () => {\r\n      return (\r\n        <div className=\"trans-container\">\r\n          <div className=\"original-text-box\">{this.props.originalText}</div>\r\n          <div className=\"trans-text-box\">{this.state.translatedText}</div>\r\n        </div>\r\n      );\r\n    };\r\n    return renderNoteEditor();\r\n  }\r\n}\r\nexport default PopupTrans;\r\n","import { connect } from \"react-redux\";\r\nimport { handleOpenMenu, handleMenuMode } from \"../../store/actions/viewArea\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport PopupNote from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    originalText: state.reader.originalText,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(PopupNote as any));\r\n","//选中文字后的弹窗\r\nimport React from \"react\";\r\nimport \"./popupMenu.css\";\r\nimport PopupNote from \"../../components/popupNote\";\r\nimport PopupOption from \"../../components/popupOption\";\r\nimport PopupTrans from \"../../components/popupTrans\";\r\nimport { PopupMenuProps, PopupMenuStates } from \"./interface\";\r\nimport { isMobile } from \"react-device-detect\";\r\n\r\ndeclare var window: any;\r\n\r\nclass PopupMenu extends React.Component<PopupMenuProps, PopupMenuStates> {\r\n  highlighter: any;\r\n  timer!: NodeJS.Timeout;\r\n  key: any;\r\n  mode: string;\r\n  showNote: boolean;\r\n  isFirstShow: boolean;\r\n  cfiRange: any;\r\n  contents: any;\r\n  rect: any;\r\n  constructor(props: PopupMenuProps) {\r\n    super(props);\r\n    this.showNote = false;\r\n    this.isFirstShow = false;\r\n    this.highlighter = null;\r\n    this.mode = \"\";\r\n    this.state = {\r\n      deleteKey: \"\",\r\n      cfiRange: this.props.cfiRange,\r\n      contents: this.props.contents,\r\n      rect: this.props.rect,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.rendition.on(\"rendered\", () => {\r\n      new Promise<void>((resolve, reject) => {\r\n        this.getHighlighter();\r\n        resolve();\r\n      }).then(() => {\r\n        this.renderHighlighters();\r\n      });\r\n      let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n      if (!iframe) return;\r\n      let doc = iframe.contentDocument;\r\n      if (!doc) return;\r\n      doc.addEventListener(\"mousedown\", this.openMenu);\r\n    });\r\n  }\r\n  componentWillReceiveProps(nextProps: PopupMenuProps) {\r\n    if (nextProps.cfiRange !== this.props.cfiRange) {\r\n      this.setState(\r\n        {\r\n          cfiRange: nextProps.cfiRange,\r\n          contents: nextProps.contents,\r\n          rect: nextProps.rect,\r\n        },\r\n        () => {\r\n          this.openMenu();\r\n        }\r\n      );\r\n    }\r\n  }\r\n  //新建高亮\r\n  getHighlighter = () => {\r\n    // 注意点一\r\n    // 为了每次切换章节时都有与当前文档相关联的 pen\r\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    this.highlighter = window.rangy.createHighlighter(doc);\r\n    let classes = [\r\n      \"color-0\",\r\n      \"color-1\",\r\n      \"color-2\",\r\n      \"color-3\",\r\n      \"line-0\",\r\n      \"line-1\",\r\n      \"line-2\",\r\n      \"line-3\",\r\n    ];\r\n    classes.forEach((item) => {\r\n      let config = {\r\n        ignoreWhiteSpace: true,\r\n        elementTagName: \"span\",\r\n        elementProperties: {\r\n          onclick: (event: any) => {\r\n            let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n            if (!iframe) return;\r\n            let doc = iframe.contentDocument;\r\n            if (!doc) return;\r\n            this.props.handleMenuMode(\"note\");\r\n            let sel = doc.getSelection();\r\n            if (!sel) return;\r\n            let range = sel.getRangeAt(0);\r\n            this.setState({ rect: range.getBoundingClientRect() }, () => {\r\n              this.showMenu();\r\n              this.handleClickHighlighter(event.currentTarget.dataset.key);\r\n              event.stopPropagation();\r\n            });\r\n          },\r\n        },\r\n        onElementCreate: (element: any) => {\r\n          element.dataset.key = this.key;\r\n        },\r\n      };\r\n      let applier = window.rangy.createClassApplier(item, config);\r\n      this.highlighter.addClassApplier(applier);\r\n    });\r\n  };\r\n  handleClickHighlighter = (key: string) => {\r\n    let dialog: HTMLInputElement | null = document.querySelector(\".editor-box\");\r\n    let note = this.props.notes.filter((item) => item.key === key)[0];\r\n    if (note && note.notes) {\r\n      dialog!.value = note.notes;\r\n    }\r\n    this.props.handleNoteKey(key);\r\n  };\r\n  handleShowDelete = (deleteKey: string) => {\r\n    this.setState({ deleteKey });\r\n  };\r\n  showMenu = () => {\r\n    let rect = this.state.rect;\r\n    if (!rect) return;\r\n    this.props.handleChangeDirection(false);\r\n    // const rect = this.rect;\r\n    let height = 200;\r\n    let x = rect.x % this.props.currentEpub.rendition._layout.width;\r\n    let y = rect.y % this.props.currentEpub.rendition._layout.height;\r\n\r\n    let posX = x + rect.width / 2 - 20;\r\n    //防止menu超出图书\r\n    let rightEdge =\r\n      this.props.menuMode === \"note\"\r\n        ? this.props.currentEpub.rendition._layout.width - 240\r\n        : this.props.currentEpub.rendition._layout.width - 150;\r\n    var posY;\r\n    //控制menu方向\r\n    if (y < height) {\r\n      this.props.handleChangeDirection(true);\r\n      posY = y + 67;\r\n    } else {\r\n      posY = y - height / 2 - 57;\r\n    }\r\n\r\n    posX = posX > rightEdge ? rightEdge : posX;\r\n\r\n    this.props.handleOpenMenu(true);\r\n    let popupMenu = document.querySelector(\".popup-menu-container\");\r\n\r\n    popupMenu!.setAttribute(\"style\", `left:${posX}px;top:${posY}px`);\r\n    isMobile &&\r\n      popupMenu!.setAttribute(\r\n        \"style\",\r\n        `left:calc(50vw - 79px);top:calc(50vh - 86px)`\r\n      );\r\n    this.setState({ rect: null });\r\n  };\r\n  //渲染高亮\r\n  renderHighlighters = () => {\r\n    let highlighters: any = this.props.notes;\r\n    if (!highlighters) return;\r\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n    if (!currentLocation.start) return;\r\n    let chapterIndex = currentLocation.start.index;\r\n    let highlightersByChapter = highlighters.filter(\r\n      (item: any) => item.chapterIndex === chapterIndex\r\n    );\r\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n    let iWin = iframe.contentWindow || iframe.contentDocument!.defaultView;\r\n    this.highlighter && this.highlighter.removeAllHighlights(); // 为了避免下次反序列化失败，必须先清除已有的高亮\r\n\r\n    let classes = [\r\n      \"color-0\",\r\n      \"color-1\",\r\n      \"color-2\",\r\n      \"color-3\",\r\n      \"line-0\",\r\n      \"line-1\",\r\n      \"line-2\",\r\n      \"line-3\",\r\n    ];\r\n    highlightersByChapter &&\r\n      highlightersByChapter.forEach((item: any) => {\r\n        this.key = item.key;\r\n        //控制渲染指定图书的指定高亮\r\n        if (item.bookKey === this.props.currentBook.key) {\r\n          try {\r\n            let temp = JSON.parse(item.range);\r\n            temp = [temp];\r\n            window.rangy\r\n              .getSelection(iframe)\r\n              .restoreCharacterRanges(iframe.contentDocument, temp);\r\n          } catch (e) {\r\n            console.warn(\r\n              \"Exception has been caught when restore character ranges.\"\r\n            );\r\n            return;\r\n          }\r\n          this.highlighter.highlightSelection(classes[item.color]);\r\n        }\r\n      });\r\n    if (!iWin || !iWin.getSelection()) return;\r\n    iWin.getSelection()!.empty(); // 清除文本选取\r\n    // this.props.isOpenMenu &&\r\n    //   window.rangy.deserializeSelection(serial, null, iWin); // （为了选取文本后不被上一行代码清除掉）恢复原本的文本选取\r\n  };\r\n  //控制弹窗\r\n  openMenu = () => {\r\n    this.setState({ deleteKey: \"\" });\r\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    let sel = doc.getSelection();\r\n    this.props.handleChangeDirection(false);\r\n    // 如果 popmenu正在被展示，则隐藏\r\n    if (this.props.isOpenMenu) {\r\n      this.props.handleMenuMode(\"menu\");\r\n      this.props.handleOpenMenu(false);\r\n      this.props.handleNoteKey(\"\");\r\n    }\r\n\r\n    // 使弹出菜单更加灵活可控;\r\n    if (sel!.isCollapsed) {\r\n      this.props.isOpenMenu && this.props.handleOpenMenu(false);\r\n      this.props.handleMenuMode(\"menu\");\r\n      this.props.handleNoteKey(\"\");\r\n      return;\r\n    }\r\n    this.showMenu();\r\n    this.props.handleMenuMode(\"menu\");\r\n  };\r\n  //添加高亮\r\n  handleHighlight() {\r\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    let color = this.props.color;\r\n    let classes = [\r\n      \"color-0\",\r\n      \"color-1\",\r\n      \"color-2\",\r\n      \"color-3\",\r\n      \"line-0\",\r\n      \"line-1\",\r\n      \"line-2\",\r\n      \"line-3\",\r\n    ];\r\n    this.highlighter.highlightSelection(classes[color]);\r\n    this.props.handleMenuMode(\"menu\");\r\n    this.props.handleOpenMenu(false);\r\n    doc.getSelection()!.empty();\r\n    this.props.handleMenuMode(\"menu\");\r\n    this.highlighter && this.highlighter.removeAllHighlights();\r\n    new Promise<void>((resolve) => {\r\n      this.getHighlighter();\r\n      resolve();\r\n    }).then(() => {\r\n      this.renderHighlighters();\r\n    });\r\n  }\r\n  render() {\r\n    if (this.props.menuMode === \"highlight\") {\r\n      this.handleHighlight();\r\n    }\r\n    const PopupProps = {\r\n      cfiRange: this.props.cfiRange,\r\n      contents: this.props.contents,\r\n      rect: this.props.rect,\r\n    };\r\n    return (\r\n      <div>\r\n        <div\r\n          className=\"popup-menu-container\"\r\n          style={this.props.isOpenMenu ? {} : { display: \"none\" }}\r\n        >\r\n          <div className=\"popup-menu-box\">\r\n            {this.props.menuMode === \"menu\" ? (\r\n              <PopupOption {...PopupProps} />\r\n            ) : this.props.menuMode === \"note\" ? (\r\n              <PopupNote {...PopupProps} />\r\n            ) : this.props.menuMode === \"trans\" ? (\r\n              <PopupTrans {...PopupProps} />\r\n            ) : null}\r\n          </div>\r\n          {this.props.isChangeDirection ? (\r\n            <span\r\n              className=\"icon-popup popup-menu-triangle-up\"\r\n              style={\r\n                this.props.menuMode === \"highlight\" ? { bottom: \"110px\" } : {}\r\n              }\r\n            ></span>\r\n          ) : (\r\n            <span className=\"icon-popup popup-menu-triangle-down\"></span>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default PopupMenu;\r\n","//弹出菜单\r\nimport {\r\n  handleSelection,\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleChangeDirection,\r\n} from \"../../store/actions/viewArea\";\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport { handleNoteKey } from \"../../store/actions/reader\";\r\nimport PopupMenu from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    digests: state.reader.digests,\r\n    notes: state.reader.notes,\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n    isOpenMenu: state.viewArea.isOpenMenu,\r\n    menuMode: state.viewArea.menuMode,\r\n    color: state.reader.color,\r\n    isChangeDirection: state.viewArea.isChangeDirection,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSelection,\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleChangeDirection,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleNoteKey,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(PopupMenu);\r\n","import OtherUtil from \"../otherUtil\";\r\n\r\nclass styleUtil {\r\n  // 为 iframe 添加默认的样式\r\n  static addDefaultCss() {\r\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    let css = this.getDefaultCss();\r\n    let style = doc.getElementById(\"default-style\");\r\n    let background = document.querySelector(\".background\");\r\n    if (!background) return;\r\n    background!.setAttribute(\r\n      \"style\",\r\n      `background-color:${OtherUtil.getReaderConfig(\"backgroundColor\")}`\r\n    );\r\n    if (!doc.head) {\r\n      return;\r\n    }\r\n    if (!style) {\r\n      style = doc.createElement(\"style\");\r\n      style.id = \"default-style\";\r\n      style.textContent = css;\r\n      doc.head.appendChild(style);\r\n      return;\r\n    }\r\n    style.textContent = css;\r\n  }\r\n  // 获取为文档默认应用的css样式\r\n  static getDefaultCss() {\r\n    let colors = [\"#FBF1D1\", \"#EFEEB0\", \"#CAEFC9\", \"#76BEE9\"];\r\n    let lines = [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"];\r\n    let css1 = `::selection{background:#f3a6a68c}::-moz-selection{background:#f3a6a68c}[class*=color-]:hover{cursor:pointer;background-image:linear-gradient(0,rgba(0,0,0,.075),rgba(0,0,0,.075))}.color-0{background-color:${colors[0]}}.color-1{background-color:${colors[1]}}.color-2{background-color:${colors[2]}}.color-3{background-color:${colors[3]}}.line-0{border-bottom:2px solid ${lines[0]}}.line-1{border-bottom:2px solid ${lines[1]}}.line-2{border-bottom:2px solid ${lines[2]}}.line-3{border-bottom:2px solid ${lines[3]}}}`;\r\n\r\n    return css1;\r\n  }\r\n}\r\n\r\nexport default styleUtil;\r\n","//阅读器图书内容区域\r\nimport React from \"react\";\r\nimport \"./imageViewer.css\";\r\nimport { ImageViewerProps, ImageViewerStates } from \"./interface\";\r\nimport StyleUtil from \"../../utils/readUtils/styleUtil\";\r\nimport FileSaver from \"file-saver\";\r\n\r\nconst isElectron = require(\"is-electron\");\r\n\r\ndeclare var window: any;\r\n\r\nclass ImageViewer extends React.Component<ImageViewerProps, ImageViewerStates> {\r\n  constructor(props: ImageViewerProps) {\r\n    super(props);\r\n    this.state = {\r\n      isShowImage: false,\r\n      imageRatio: \"horizontal\",\r\n      zoomIndex: 0,\r\n      rotateIndex: 0,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.rendition.on(\"rendered\", () => {\r\n      let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n      if (!iframe) return;\r\n      let doc = iframe.contentDocument;\r\n      if (!doc) {\r\n        return;\r\n      }\r\n      StyleUtil.addDefaultCss();\r\n      doc.addEventListener(\"click\", this.showImage, false);\r\n    });\r\n  }\r\n\r\n  showImage = (event: any) => {\r\n    if (this.props.isShow) {\r\n      this.props.handleLeaveReader(\"left\");\r\n      this.props.handleLeaveReader(\"right\");\r\n      this.props.handleLeaveReader(\"top\");\r\n      this.props.handleLeaveReader(\"bottom\");\r\n    }\r\n    let href =\r\n      event.target.src ||\r\n      event.target.href ||\r\n      event.target.parentNode.href ||\r\n      event.target.parentNode.parentNode.href ||\r\n      \"\";\r\n    if (\r\n      isElectron() &&\r\n      href &&\r\n      href.indexOf(\"OEBPF\") === -1 &&\r\n      href.indexOf(\"OEBPS\") === -1 &&\r\n      href.indexOf(\"footnote\") === -1 &&\r\n      href.indexOf(\"blob\") === -1 &&\r\n      href.indexOf(\".htm\") === -1\r\n    ) {\r\n      console.log(href);\r\n      event.preventDefault();\r\n      const { shell } = window.require(\"electron\");\r\n      const { dialog } = window.require(\"electron\").remote;\r\n      dialog\r\n        .showMessageBox({\r\n          type: \"question\",\r\n          title: this.props.t(\"Open link in browser\"),\r\n          message: this.props.t(\"Do you want to open this link in browser\"),\r\n          buttons: [this.props.t(\"Confirm\"), this.props.t(\"Cancel\")],\r\n        })\r\n        .then((result) => {\r\n          result.response === 0 && shell.openExternal(href);\r\n        });\r\n    }\r\n    if (!event.target.src) {\r\n      return;\r\n    }\r\n    if (this.state.isShowImage) {\r\n      this.setState({\r\n        isShowImage: false,\r\n        zoomIndex: 0,\r\n        rotateIndex: 0,\r\n        imageRatio: \"horizontal\",\r\n      });\r\n    }\r\n    event.preventDefault();\r\n    const handleDirection = (direction: string) => {\r\n      this.setState({ imageRatio: direction });\r\n    };\r\n    var img = new Image();\r\n    img.addEventListener(\"load\", function () {\r\n      handleDirection(\r\n        this.naturalWidth / this.naturalHeight > 1 ? \"horizontal\" : \"vertical\"\r\n      );\r\n    });\r\n    img.src = event.target.src;\r\n    let image: HTMLImageElement | null = document.querySelector(\".image\");\r\n    if (image) {\r\n      image.src = event.target.src;\r\n      this.setState({ isShowImage: true });\r\n    }\r\n  };\r\n  hideImage = (event: any) => {\r\n    event.preventDefault();\r\n    if (event.target.src) {\r\n      let image: HTMLImageElement | null = document.querySelector(\".image\");\r\n      if (image) image.src = \"\";\r\n    }\r\n    this.setState({ isShowImage: false });\r\n  };\r\n  handleZoomIn = () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    if (image.style.width === \"200vw\" || image.style.height === \"200vh\") return;\r\n    this.setState({ zoomIndex: this.state.zoomIndex + 1 }, () => {\r\n      if (this.state.imageRatio === \"horizontal\") {\r\n        image.style.width = `${60 + this.state.zoomIndex * 10}vw`;\r\n      } else {\r\n        image.style.height = `${90 + 10 * this.state.zoomIndex}vh`;\r\n      }\r\n    });\r\n  };\r\n  handleZoomOut = () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    if (image.style.width === \"10vw\" || image.style.height === \"10vh\") return;\r\n    this.setState({ zoomIndex: this.state.zoomIndex - 1 }, () => {\r\n      if (this.state.imageRatio === \"horizontal\") {\r\n        image.style.width = `${60 + this.state.zoomIndex * 10}vw`;\r\n      } else {\r\n        image.style.height = `${90 + 10 * this.state.zoomIndex}vh`;\r\n      }\r\n    });\r\n  };\r\n  handleSave = async () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    let blob = await fetch(image.src).then((r) => r.blob());\r\n    FileSaver.saveAs(blob, `${new Date().toLocaleDateString()}`);\r\n  };\r\n  handleClock = () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    this.setState({ rotateIndex: this.state.rotateIndex + 1 }, () => {\r\n      image.style.transform = `rotate(${this.state.rotateIndex * 90}deg)`;\r\n    });\r\n  };\r\n  handleCounterClock = () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    this.setState({ rotateIndex: this.state.rotateIndex - 1 }, () => {\r\n      image.style.transform = `rotate(${this.state.rotateIndex * 90}deg)`;\r\n    });\r\n  };\r\n  render() {\r\n    return (\r\n      <div\r\n        className=\"image-preview\"\r\n        style={this.state.isShowImage ? {} : { display: \"none\" }}\r\n      >\r\n        <div\r\n          className=\"image-background\"\r\n          style={\r\n            this.state.isShowImage\r\n              ? { backgroundColor: \"rgba(75,75,75,0.3)\" }\r\n              : {}\r\n          }\r\n          onClick={(event) => {\r\n            this.hideImage(event);\r\n          }}\r\n        ></div>\r\n        <img\r\n          src=\"\"\r\n          alt=\"\"\r\n          className=\"image\"\r\n          style={\r\n            this.state.imageRatio === \"horizontal\"\r\n              ? { width: \"60vw\" }\r\n              : { height: \"90vh\" }\r\n          }\r\n        />\r\n        <div className=\"image-operation\">\r\n          <span\r\n            className=\"icon-zoom-in zoom-in-icon\"\r\n            onClick={() => {\r\n              this.handleZoomIn();\r\n            }}\r\n          ></span>\r\n          <span\r\n            className=\"icon-zoom-out zoom-out-icon\"\r\n            onClick={() => {\r\n              this.handleZoomOut();\r\n            }}\r\n          ></span>\r\n          <span\r\n            className=\"icon-save save-icon\"\r\n            onClick={() => {\r\n              this.handleSave();\r\n            }}\r\n          ></span>\r\n          <span\r\n            className=\"icon-clockwise clockwise-icon\"\r\n            onClick={() => {\r\n              this.handleClock();\r\n            }}\r\n          ></span>\r\n          <span\r\n            className=\"icon-counterclockwise counterclockwise-icon\"\r\n            onClick={() => {\r\n              this.handleCounterClock();\r\n            }}\r\n          ></span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ImageViewer;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport ImageViewer from \"./component\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {};\r\n};\r\nconst actionCreator = {};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(ImageViewer as any));\r\n","//阅读器图书内容区域\r\nimport React from \"react\";\r\nimport \"./viewArea.css\";\r\nimport PopupMenu from \"../popupMenu\";\r\nimport { ViewAreaProps, ViewAreaStates } from \"./interface\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport BookmarkModel from \"../../model/Bookmark\";\r\nimport StyleUtil from \"../../utils/readUtils/styleUtil\";\r\nimport ImageViewer from \"../../components/imageViewer\";\r\n\r\ndeclare var window: any;\r\n\r\nclass ViewArea extends React.Component<ViewAreaProps, ViewAreaStates> {\r\n  isFirst: boolean;\r\n  constructor(props: ViewAreaProps) {\r\n    super(props);\r\n    this.state = {\r\n      cfiRange: null,\r\n      contents: null,\r\n      rect: null,\r\n      loading: true,\r\n    };\r\n    this.isFirst = true;\r\n  }\r\n\r\n  componentDidMount() {\r\n    let epub = this.props.currentEpub;\r\n    (window as any).rangy.init(); // 初始化\r\n    this.props.rendition.on(\"locationChanged\", () => {\r\n      this.props.handleReadingEpub(epub);\r\n      this.props.handleOpenMenu(false);\r\n      const currentLocation = this.props.rendition.currentLocation();\r\n      const cfi = currentLocation.start.cfi;\r\n      this.props.handleShowBookmark(\r\n        this.props.bookmarks &&\r\n          this.props.bookmarks.filter(\r\n            (item: BookmarkModel) => item.cfi === cfi\r\n          )[0]\r\n          ? true\r\n          : false\r\n      );\r\n\r\n      if (!this.isFirst && this.props.locations) {\r\n        let percentage = this.props.locations.percentageFromCfi(cfi);\r\n        RecordLocation.recordCfi(this.props.currentBook.key, cfi, percentage);\r\n        this.props.handlePercentage(percentage);\r\n      } else if (!this.isFirst) {\r\n        //如果过暂时没有解析出locations，就直接记录cfi\r\n        RecordLocation.recordCfi(\r\n          this.props.currentBook.key,\r\n          cfi,\r\n          RecordLocation.getCfi(this.props.currentBook.key).percentage\r\n        );\r\n      }\r\n      this.isFirst = false;\r\n    });\r\n    this.props.rendition.on(\"rendered\", () => {\r\n      this.setState({ loading: false });\r\n      let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n      if (!iframe) return;\r\n      let doc = iframe.contentDocument;\r\n      if (!doc) {\r\n        return;\r\n      }\r\n      StyleUtil.addDefaultCss();\r\n      this.props.rendition.themes.default({\r\n        \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n          \"font-size\": `${\r\n            OtherUtil.getReaderConfig(\"fontSize\") || 17\r\n          }px !important`,\r\n          \"line-height\": `${\r\n            OtherUtil.getReaderConfig(\"lineHeight\") || \"1.25\"\r\n          } !important`,\r\n          \"font-family\": `${\r\n            OtherUtil.getReaderConfig(\"fontFamily\") || \"Helvetica\"\r\n          } !important`,\r\n          color: `${\r\n            OtherUtil.getReaderConfig(\"textColor\")\r\n              ? OtherUtil.getReaderConfig(\"textColor\")\r\n              : \"\"\r\n          } !important`,\r\n          \"font-weight\": `${\r\n            OtherUtil.getReaderConfig(\"isBold\") === \"yes\"\r\n              ? \"bold !important\"\r\n              : \"\"\r\n          }`,\r\n        },\r\n      });\r\n    });\r\n    this.props.rendition.on(\"selected\", (cfiRange: any, contents: any) => {\r\n      var range = contents.range(cfiRange);\r\n      var rect = range.getBoundingClientRect();\r\n      this.setState({ cfiRange, contents, rect });\r\n    });\r\n    this.props.rendition.themes.default({\r\n      \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n        \"font-size\": `${\r\n          OtherUtil.getReaderConfig(\"fontSize\") || 17\r\n        }px !important`,\r\n        \"line-height\": `${\r\n          OtherUtil.getReaderConfig(\"lineHeight\") || \"1.25\"\r\n        } !important`,\r\n        \"font-family\": `${\r\n          OtherUtil.getReaderConfig(\"fontFamily\") || \"内嵌字体\"\r\n        } !important`,\r\n        color: `${\r\n          OtherUtil.getReaderConfig(\"backgroundColor\") === \"rgba(44,47,49,1)\"\r\n            ? \"white\"\r\n            : \"\"\r\n        } !important`,\r\n        \"font-weight\": `${\r\n          OtherUtil.getReaderConfig(\"isBold\") === \"yes\" ? \"bold !important\" : \"\"\r\n        }`,\r\n      },\r\n    });\r\n    this.props.rendition.display(\r\n      RecordLocation.getCfi(this.props.currentBook.key) === null\r\n        ? null\r\n        : RecordLocation.getCfi(this.props.currentBook.key).cfi\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const popupMenuProps = {\r\n      rendition: this.props.rendition,\r\n      cfiRange: this.state.cfiRange,\r\n      contents: this.state.contents,\r\n      rect: this.state.rect,\r\n    };\r\n    return (\r\n      <div className=\"view-area\">\r\n        <ImageViewer\r\n          {...{\r\n            isShow: this.props.isShow,\r\n            rendition: this.props.rendition,\r\n            handleEnterReader: this.props.handleEnterReader,\r\n            handleLeaveReader: this.props.handleLeaveReader,\r\n          }}\r\n        />\r\n        <PopupMenu {...popupMenuProps} />\r\n        {this.state.loading ? (\r\n          <div className=\"spinner\">\r\n            <div className=\"sk-chase\">\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n            </div>\r\n          </div>\r\n        ) : null}\r\n        <>\r\n          {this.props.isShowBookmark ? <div className=\"bookmark\"></div> : null}\r\n        </>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ViewArea;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport ViewArea from \"./component\";\r\nimport { handlePercentage } from \"../../store/actions/progressPanel\";\r\nimport {\r\n  handleOpenMenu,\r\n  handleShowBookmark,\r\n} from \"../../store/actions/viewArea\";\r\nimport { handleReadingEpub } from \"../../store/actions/book\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    chapters: state.reader.chapters,\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n    locations: state.progressPanel.locations,\r\n    bookmarks: state.reader.bookmarks,\r\n    isShowBookmark: state.viewArea.isShowBookmark,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handlePercentage,\r\n  handleOpenMenu,\r\n  handleShowBookmark,\r\n  handleReadingEpub,\r\n};\r\n\r\nexport default connect(mapStateToProps, actionCreator)(ViewArea);\r\n","//图书下面的背景，包括页边和书脊\r\nimport React from \"react\";\r\nimport \"./background.css\";\r\nimport { BackgroundProps, BackgroundState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { isMobile } from \"react-device-detect\";\r\n\r\nclass Background extends React.Component<BackgroundProps, BackgroundState> {\r\n  isFirst: Boolean;\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      isSingle:\r\n        OtherUtil.getReaderConfig(\"readerMode\") &&\r\n        OtherUtil.getReaderConfig(\"readerMode\") !== \"double\",\r\n      currentChapter: \"\",\r\n      prevPage: 0,\r\n      nextPage: 0,\r\n      scale: OtherUtil.getReaderConfig(\"scale\") || 1,\r\n      isShowFooter: OtherUtil.getReaderConfig(\"isShowFooter\") !== \"no\",\r\n      isShowHeader: OtherUtil.getReaderConfig(\"isShowHeader\") !== \"no\",\r\n      isUseBackground: OtherUtil.getReaderConfig(\"isUseBackground\") === \"yes\",\r\n    };\r\n    this.isFirst = true;\r\n  }\r\n  componentDidMount() {\r\n    if (isMobile) {\r\n      OtherUtil.setReaderConfig(\"readerMode\", \"continuous\");\r\n    }\r\n  }\r\n  componentWillReceiveProps(nextProps: BackgroundProps) {\r\n    if (\r\n      nextProps.currentEpub.rendition &&\r\n      nextProps.currentEpub.rendition.location &&\r\n      this.props.currentEpub.rendition\r\n    ) {\r\n      const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n      if (!currentLocation.start) {\r\n        return;\r\n      }\r\n      this.isFirst && this.props.handleFetchLocations(this.props.currentEpub);\r\n      this.isFirst = false;\r\n      this.setState({\r\n        prevPage: currentLocation.start.displayed.page,\r\n        nextPage: currentLocation.end.displayed.page,\r\n      });\r\n      let chapterHref = currentLocation.start.href;\r\n      let chapter = \"Unknown Chapter\";\r\n      let currentChapter = this.props.flattenChapters.filter(\r\n        (item: any) => item.href.split(\"#\")[0] === chapterHref\r\n      )[0];\r\n      if (currentChapter) {\r\n        chapter = currentChapter.label.trim(\" \");\r\n      }\r\n      this.setState({ currentChapter: chapter });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.isUseBackground) {\r\n      return (\r\n        <div\r\n          className=\"background\"\r\n          style={{\r\n            color: OtherUtil.getReaderConfig(\"textColor\")\r\n              ? OtherUtil.getReaderConfig(\"textColor\")\r\n              : \"\",\r\n          }}\r\n        >\r\n          {this.state.isShowHeader && this.state.currentChapter && (\r\n            <p\r\n              className=\"progress-chapter-name\"\r\n              style={\r\n                this.state.isSingle && !isMobile\r\n                  ? {\r\n                      left: `calc(50vw - \r\n                      270px)`,\r\n                    }\r\n                  : isMobile\r\n                  ? { left: \"auto\", width: \"100vw\" }\r\n                  : {}\r\n              }\r\n            >\r\n              <Trans>{this.state.currentChapter}</Trans>\r\n            </p>\r\n          )}\r\n          {this.state.isShowHeader && !this.state.isSingle && (\r\n            <p\r\n              className=\"progress-book-name\"\r\n              style={\r\n                this.state.isSingle && !isMobile\r\n                  ? {\r\n                      right: `calc(50vw - \r\n                      270px)`,\r\n                    }\r\n                  : isMobile\r\n                  ? { right: \"auto\", width: \"100vw\" }\r\n                  : {}\r\n              }\r\n            >\r\n              <Trans>{this.props.currentBook.name}</Trans>\r\n            </p>\r\n          )}\r\n          {this.state.isShowFooter && this.state.prevPage > 0 && (\r\n            <p\r\n              className=\"background-page-left\"\r\n              style={\r\n                this.state.isSingle && !isMobile\r\n                  ? {\r\n                      left: `calc(50vw - \r\n                      270px)`,\r\n                    }\r\n                  : isMobile\r\n                  ? { left: \"auto\", width: \"100vw\" }\r\n                  : {}\r\n              }\r\n            >\r\n              <Trans i18nKey=\"Book Page\" count={this.state.prevPage}>\r\n                Page\r\n                {{\r\n                  count: this.state.prevPage,\r\n                }}\r\n              </Trans>\r\n            </p>\r\n          )}\r\n          {this.state.isShowFooter &&\r\n            this.state.nextPage > 0 &&\r\n            !this.state.isSingle && (\r\n              <p className=\"background-page-right\">\r\n                <Trans i18nKey=\"Book Page\" count={this.state.nextPage}>\r\n                  Page\r\n                  {{\r\n                    count: this.state.nextPage,\r\n                  }}\r\n                </Trans>\r\n              </p>\r\n            )}\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div\r\n        className=\"background\"\r\n        style={{\r\n          color: OtherUtil.getReaderConfig(\"textColor\")\r\n            ? OtherUtil.getReaderConfig(\"textColor\")\r\n            : \"\",\r\n        }}\r\n      >\r\n        {this.state.isShowHeader && this.state.currentChapter && (\r\n          <p\r\n            className=\"progress-chapter-name\"\r\n            style={\r\n              this.state.isSingle && !isMobile\r\n                ? {\r\n                    left: `calc(50vw - \r\n                      270px)`,\r\n                  }\r\n                : isMobile\r\n                ? { left: \"auto\", width: \"100vw\" }\r\n                : {}\r\n            }\r\n          >\r\n            <Trans>{this.state.currentChapter}</Trans>\r\n          </p>\r\n        )}\r\n\r\n        {this.state.isShowHeader && !this.state.isSingle && (\r\n          <p\r\n            className=\"progress-book-name\"\r\n            style={\r\n              this.state.isSingle && !isMobile\r\n                ? {\r\n                    right: `calc(50vw - \r\n                      270px)`,\r\n                  }\r\n                : isMobile\r\n                ? { right: \"auto\", width: \"100vw\" }\r\n                : {}\r\n            }\r\n          >\r\n            <Trans>{this.props.currentBook.name}</Trans>\r\n          </p>\r\n        )}\r\n\r\n        {this.state.isShowFooter && this.state.prevPage > 0 && (\r\n          <p\r\n            className=\"background-page-left\"\r\n            style={\r\n              this.state.isSingle && !isMobile\r\n                ? {\r\n                    left: `calc(50vw - \r\n                      270px)`,\r\n                  }\r\n                : isMobile\r\n                ? { left: \"auto\", width: \"100vw\" }\r\n                : {}\r\n            }\r\n          >\r\n            <Trans i18nKey=\"Book Page\" count={this.state.prevPage}>\r\n              Page\r\n              {{\r\n                count: this.state.prevPage,\r\n              }}\r\n            </Trans>\r\n          </p>\r\n        )}\r\n        {this.state.isShowFooter &&\r\n          this.state.nextPage > 0 &&\r\n          !this.state.isSingle && (\r\n            <p className=\"background-page-right\">\r\n              <Trans i18nKey=\"Book Page\" count={this.state.nextPage}>\r\n                Page\r\n                {{\r\n                  count: this.state.nextPage,\r\n                }}\r\n              </Trans>\r\n            </p>\r\n          )}\r\n        <div\r\n          className=\"background-box2\"\r\n          style={\r\n            document.body.clientWidth < 570\r\n              ? { left: 5, right: 8 }\r\n              : this.state.isSingle\r\n              ? {\r\n                  left: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - ${this.state.isSingle ? \"9\" : \"5\"}px)`,\r\n                  right: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - 7px)`,\r\n                  boxShadow: \"0 0 0px rgba(191, 191, 191, 1)\",\r\n                }\r\n              : {}\r\n          }\r\n        ></div>\r\n        <div\r\n          className=\"background-box3\"\r\n          style={\r\n            document.body.clientWidth < 570\r\n              ? { left: 5, right: 10 }\r\n              : this.state.isSingle\r\n              ? {\r\n                  left: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - 9px)`,\r\n                  right: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - 9px)`,\r\n                }\r\n              : {}\r\n          }\r\n        >\r\n          <div\r\n            className=\"spine-shadow-left\"\r\n            style={\r\n              this.state.isSingle ||\r\n              (OtherUtil.getReaderConfig(\"backgroundColor\") &&\r\n                (OtherUtil.getReaderConfig(\"backgroundColor\") ===\r\n                  \"rgba(44,47,49,1)\" ||\r\n                  OtherUtil.getReaderConfig(\"backgroundColor\").startsWith(\"#\")))\r\n                ? { display: \"none\" }\r\n                : {}\r\n            }\r\n          ></div>\r\n          <div\r\n            className=\"book-spine\"\r\n            style={this.state.isSingle ? { display: \"none\" } : {}}\r\n          ></div>\r\n          <div\r\n            className=\"spine-shadow-right\"\r\n            style={\r\n              OtherUtil.getReaderConfig(\"backgroundColor\") &&\r\n              (OtherUtil.getReaderConfig(\"backgroundColor\") ===\r\n                \"rgba(44,47,49,1)\" ||\r\n                OtherUtil.getReaderConfig(\"backgroundColor\").startsWith(\"#\"))\r\n                ? { display: \"none\" }\r\n                : this.state.isSingle\r\n                ? {\r\n                    position: \"relative\",\r\n                    right: 0,\r\n                  }\r\n                : {}\r\n            }\r\n          ></div>\r\n        </div>\r\n\r\n        <div\r\n          className=\"background-box1\"\r\n          style={\r\n            document.body.clientWidth < 570\r\n              ? { left: 5, right: 6 }\r\n              : this.state.isSingle\r\n              ? {\r\n                  left: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - ${this.state.isSingle ? \"9\" : \"5\"}px)`,\r\n                  right: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - 5px)`,\r\n                  boxShadow: \"0 0 0px rgba(191, 191, 191, 1)\",\r\n                }\r\n              : {}\r\n          }\r\n        ></div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Background;\r\n","//图书下面的背景，包括页边和书脊\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport Background from \"./component\";\r\nimport { handleFetchLocations } from \"../../store/actions/progressPanel\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n    flattenChapters: state.reader.flattenChapters,\r\n    locations: state.progressPanel.locations,\r\n  };\r\n};\r\nconst actionCreator = { handleFetchLocations };\r\nexport default connect(mapStateToProps, actionCreator)(Background);\r\n","export const backgroundList = [\r\n  { id: 1, theme: \"rgba(197, 231, 207,1)\" },\r\n  { id: 2, theme: \"rgba(233, 216, 188,1)\" },\r\n  { id: 3, theme: \"rgba(255,255,255,1)\" },\r\n  { id: 4, theme: \"rgba(44,47,49,1)\" },\r\n];\r\nexport const textList = [\r\n  { id: 1, theme: \"rgba(0,0,0,1)\" },\r\n  { id: 2, theme: \"rgba(255,255,255,1)\" },\r\n  { id: 3, theme: \"rgba(89, 68, 41,1)\" },\r\n  { id: 4, theme: \"rgba(54, 80, 62,1)\" },\r\n];\r\n","//修改阅读器背景色\r\nimport React from \"react\";\r\nimport { backgroundList, textList } from \"../../constants/themeList\";\r\nimport StyleUtil from \"../../utils/readUtils/styleUtil\";\r\nimport \"./themeList.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { ThemeListProps, ThemeListState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport { Panel as ColorPickerPanel } from \"rc-color-picker\";\r\nimport \"rc-color-picker/assets/index.css\";\r\nimport _ from \"underscore\";\r\n\r\nclass ThemeList extends React.Component<ThemeListProps, ThemeListState> {\r\n  constructor(props: ThemeListProps) {\r\n    super(props);\r\n    this.state = {\r\n      currentBackgroundIndex: backgroundList.findIndex((item) => {\r\n        return (\r\n          item.theme ===\r\n          (OtherUtil.getReaderConfig(\"backgroundColor\") ||\r\n            \"rgba(255,255,255,1)\")\r\n        );\r\n      }),\r\n      currentTextIndex: textList.findIndex((item) => {\r\n        return (\r\n          item.theme ===\r\n          (OtherUtil.getReaderConfig(\"textColor\") || \"rgba(0,0,0,1)\")\r\n        );\r\n      }),\r\n      isShowTextPicker: false,\r\n      isShowBgPicker: false,\r\n    };\r\n  }\r\n  handleChangeBgColor = (color: string, index: number = -1) => {\r\n    OtherUtil.setReaderConfig(\"backgroundColor\", color);\r\n    this.setState({\r\n      currentBackgroundIndex: index,\r\n    });\r\n    if (index === 3) {\r\n      this.props.currentEpub.rendition.themes.default({\r\n        \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n          color: `white !important`,\r\n        },\r\n      });\r\n    } else if (\r\n      index === 2 &&\r\n      OtherUtil.getReaderConfig(\"backgroundColor\") === \"rgba(255,255,255,1)\"\r\n    ) {\r\n      this.props.currentEpub.rendition.themes.default({\r\n        \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n          color: `black !important`,\r\n        },\r\n      });\r\n    } else {\r\n      this.props.currentEpub.rendition.themes.default({\r\n        \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n          color: `inherit !important`,\r\n        },\r\n      });\r\n    }\r\n    StyleUtil.addDefaultCss();\r\n  };\r\n  handleChooseBgColor = (color) => {\r\n    OtherUtil.setReaderConfig(\"backgroundColor\", color.color);\r\n    StyleUtil.addDefaultCss();\r\n  };\r\n  handleColorTextPicker = (isShowTextPicker: boolean) => {\r\n    this.setState({ isShowTextPicker });\r\n  };\r\n  handleColorBgPicker = (isShowBgPicker: boolean) => {\r\n    this.setState({ isShowBgPicker });\r\n  };\r\n  handleChooseTextColor = (color) => {\r\n    if (typeof color !== \"object\") {\r\n      this.setState({\r\n        currentTextIndex: _.findLastIndex(textList, { theme: color }),\r\n      });\r\n    }\r\n    OtherUtil.setReaderConfig(\r\n      \"textColor\",\r\n      typeof color === \"object\" ? color.color : color\r\n    );\r\n    this.props.currentEpub.rendition.themes.default({\r\n      \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n        color: `${typeof color === \"object\" ? color.color : color} !important`,\r\n      },\r\n    });\r\n  };\r\n  render() {\r\n    const renderBackgroundColorList = () => {\r\n      return backgroundList.map((item, index) => {\r\n        return (\r\n          <li\r\n            key={item.id}\r\n            className={\r\n              index === this.state.currentBackgroundIndex\r\n                ? \"active-color background-color-circle\"\r\n                : \"background-color-circle\"\r\n            }\r\n            onClick={() => {\r\n              this.handleChangeBgColor(item.theme, index);\r\n            }}\r\n            style={{ backgroundColor: item.theme }}\r\n          ></li>\r\n        );\r\n      });\r\n    };\r\n    const renderTextColorList = () => {\r\n      return textList.map((item, index) => {\r\n        return (\r\n          <li\r\n            key={item.id}\r\n            className={\r\n              index === this.state.currentTextIndex\r\n                ? \"active-color background-color-circle\"\r\n                : \"background-color-circle\"\r\n            }\r\n            onClick={() => {\r\n              this.handleChooseTextColor(item.theme);\r\n            }}\r\n            style={{ backgroundColor: item.theme }}\r\n          ></li>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div className=\"background-color-setting\">\r\n        <div className=\"background-color-text\">\r\n          <Trans>Background Color</Trans>\r\n        </div>\r\n        <ul className=\"background-color-list\">\r\n          {renderBackgroundColorList()}\r\n          <li\r\n            className=\"background-color-circle\"\r\n            style={{ textAlign: \"center\", lineHeight: \"35px\" }}\r\n            onClick={() => {\r\n              this.handleColorBgPicker(!this.state.isShowBgPicker);\r\n            }}\r\n          >\r\n            <span className=\"icon-more\"></span>\r\n          </li>\r\n        </ul>\r\n        {this.state.isShowBgPicker && (\r\n          <ColorPickerPanel\r\n            enableAlpha={false}\r\n            color={\"#345679\"}\r\n            onChange={this.handleChooseBgColor}\r\n            mode=\"RGB\"\r\n            style={{\r\n              margin: 20,\r\n              animation: \"fade-in 0.2s ease-in-out 0s 1\",\r\n            }}\r\n          />\r\n        )}\r\n        <div className=\"background-color-text\">\r\n          <Trans>Text Color</Trans>\r\n        </div>\r\n        <ul className=\"background-color-list\">\r\n          {renderTextColorList()}\r\n\r\n          <li\r\n            className=\"background-color-circle\"\r\n            style={{ textAlign: \"center\", lineHeight: \"35px\" }}\r\n            onClick={() => {\r\n              this.handleColorTextPicker(!this.state.isShowTextPicker);\r\n            }}\r\n          >\r\n            <span\r\n              className=\"icon-more\"\r\n              style={{ transform: \"rotate(-90deg)\" }}\r\n            ></span>\r\n          </li>\r\n        </ul>\r\n        {this.state.isShowTextPicker && (\r\n          <ColorPickerPanel\r\n            enableAlpha={false}\r\n            color={\"#345679\"}\r\n            onChange={this.handleChooseTextColor}\r\n            mode=\"RGB\"\r\n            style={{\r\n              margin: 20,\r\n              animation: \"fade-in 0.2s ease-in-out 0s 1\",\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ThemeList;\r\n","import { connect } from \"react-redux\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport ThemeList from \"./component\";\r\nimport { stateType } from \"../../store\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentEpub: state.book.currentEpub,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(ThemeList as any));\r\n","//字体大小选择页面\r\nimport React from \"react\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { SliderListProps, SliderListState } from \"./interface\";\r\nimport \"./sliderList.css\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\n\r\nclass SliderList extends React.Component<SliderListProps, SliderListState> {\r\n  constructor(props: SliderListProps) {\r\n    super(props);\r\n    this.state = {\r\n      value:\r\n        this.props.mode === \"fontSize\"\r\n          ? OtherUtil.getReaderConfig(\"fontSize\") || \"17\"\r\n          : this.props.mode === \"scale\"\r\n          ? OtherUtil.getReaderConfig(\"scale\") || \"1\"\r\n          : OtherUtil.getReaderConfig(\"margin\") || \"30\",\r\n    };\r\n  }\r\n\r\n  onValueChange = (event: any) => {\r\n    if (this.props.mode === \"fontSize\") {\r\n      const fontSize = event.target.value;\r\n      this.setState({ value: fontSize });\r\n      OtherUtil.setReaderConfig(\"fontSize\", fontSize);\r\n      this.props.currentEpub.rendition.themes.default({\r\n        \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n          \"font-size\": `${fontSize || 17}px !important`,\r\n        },\r\n      });\r\n    } else if (this.props.mode === \"scale\") {\r\n      const scale = event.target.value;\r\n      this.setState({ value: scale });\r\n      OtherUtil.setReaderConfig(\"scale\", scale);\r\n    } else {\r\n      const margin = event.target.value;\r\n      this.setState({ value: margin });\r\n      OtherUtil.setReaderConfig(\"margin\", margin);\r\n    }\r\n  };\r\n  //使进度百分比随拖动实时变化\r\n  onValueInput = (event: any) => {\r\n    this.setState({ value: event.target.value });\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"font-size-setting\">\r\n        <div className=\"font-size-title\">\r\n          {this.props.mode === \"fontSize\" ? (\r\n            <>\r\n              <Trans>Font Size</Trans>&nbsp;&nbsp; &nbsp;\r\n              <span>{this.state.value}px</span>\r\n            </>\r\n          ) : this.props.mode === \"scale\" ? (\r\n            <>\r\n              <Trans>Scale</Trans>&nbsp;&nbsp; &nbsp;\r\n              <span>\r\n                {parseInt((parseFloat(this.state.value) * 100).toString())}%\r\n              </span>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <Trans>Margin</Trans>&nbsp;&nbsp; &nbsp;\r\n              <span>{this.state.value}px</span>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        <span className=\"ultra-small-size\">\r\n          {this.props.mode === \"fontSize\"\r\n            ? \"A\"\r\n            : this.props.mode === \"scale\"\r\n            ? \"1\"\r\n            : \"0\"}\r\n        </span>\r\n        <div className=\"font-size-selector\">\r\n          <input\r\n            className=\"input-progress\"\r\n            defaultValue={this.state.value}\r\n            type=\"range\"\r\n            max={this.props.maxValue}\r\n            min={this.props.minValue}\r\n            step={\r\n              this.props.mode === \"fontSize\"\r\n                ? \"1\"\r\n                : this.props.mode === \"scale\"\r\n                ? \"0.1\"\r\n                : \"5\"\r\n            }\r\n            onInput={(event) => {\r\n              this.onValueChange(event);\r\n            }}\r\n            onChange={(event) => {\r\n              this.onValueInput(event);\r\n            }}\r\n            onMouseUp={() => {\r\n              this.props.mode === \"scale\" && window.location.reload();\r\n            }}\r\n          />\r\n        </div>\r\n        {this.props.mode === \"fontSize\" ? (\r\n          <span className=\"ultra-large-size\">A</span>\r\n        ) : this.props.mode === \"scale\" ? (\r\n          <span\r\n            className=\"ultra-large-size\"\r\n            style={{ fontSize: \"16px\", right: \"5px\" }}\r\n          >\r\n            4\r\n          </span>\r\n        ) : (\r\n          <span\r\n            className=\"ultra-large-size\"\r\n            style={{ fontSize: \"16px\", right: \"5px\" }}\r\n          >\r\n            50\r\n          </span>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SliderList;\r\n","//字体大小选择页面\r\nimport { connect } from \"react-redux\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport SliderList from \"./component\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return { currentEpub: state.book.currentEpub };\r\n};\r\nconst actionCreator = {\r\n  handleMessageBox,\r\n  handleMessage,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(SliderList as any));\r\n","export const dropdownList = [\r\n  {\r\n    id: 1,\r\n    title: \"Font Family\",\r\n    value: \"fontFamily\",\r\n    option: [\r\n      \"内嵌字体\",\r\n      \"Helvetica\",\r\n      \"Times New Roman\",\r\n      \"Microsoft YaHei\",\r\n      \"SimSun\",\r\n      \"SimHei\",\r\n      \"Arial\",\r\n    ],\r\n  },\r\n  {\r\n    id: 2,\r\n    title: \"Line Height\",\r\n    value: \"lineHeight\",\r\n    option: [\"1.25\", \"1\", \"1.25\", \"1.5\", \"1.75\", \"2\"],\r\n  },\r\n];\r\n","//图书样式设置的下拉菜单页面\r\nimport React from \"react\";\r\nimport { dropdownList } from \"../../constants/dropdownList\";\r\nimport \"./dropdownList.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { DropdownListProps, DropdownListState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nconst isElectron = require(\"is-electron\");\r\nif (\r\n  isElectron() &&\r\n  navigator.appVersion.indexOf(\"NT 6.1\") === -1 &&\r\n  navigator.appVersion.indexOf(\"NT 5.1\") === -1 &&\r\n  navigator.appVersion.indexOf(\"NT 6.0\") === -1\r\n) {\r\n  const { ipcRenderer } = window.require(\"electron\");\r\n  dropdownList[0].option = ipcRenderer.sendSync(\"fonts-ready\", \"ping\");\r\n  dropdownList[0].option.push(\"内嵌字体\");\r\n}\r\n\r\nclass DropdownList extends React.Component<\r\n  DropdownListProps,\r\n  DropdownListState\r\n> {\r\n  constructor(props: DropdownListProps) {\r\n    super(props);\r\n    this.state = {\r\n      currentFontFamilyIndex: dropdownList[0].option.findIndex((item: any) => {\r\n        return item === (OtherUtil.getReaderConfig(\"fontFamily\") || \"内嵌字体\");\r\n      }),\r\n      currentLineHeightIndex: dropdownList[1].option.findIndex((item: any) => {\r\n        return item === (OtherUtil.getReaderConfig(\"lineHeight\") || \"1.25\");\r\n      }),\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    //使下拉菜单选中预设的值\r\n\r\n    document\r\n      .querySelector(\".paragraph-character-setting\")!\r\n      .children[0].children[1].children[\r\n        this.state.currentFontFamilyIndex === -1\r\n          ? 0\r\n          : this.state.currentFontFamilyIndex\r\n      ].setAttribute(\"selected\", \"selected\");\r\n\r\n    document\r\n      .querySelector(\".paragraph-character-setting\")!\r\n      .children[1].children[1].children[\r\n        this.state.currentLineHeightIndex\r\n      ].setAttribute(\"selected\", \"selected\");\r\n  }\r\n  //切换不同的样式\r\n  handleView(event: any, option: string) {\r\n    let arr = event.target.value.split(\",\");\r\n    OtherUtil.setReaderConfig(option, arr[0]);\r\n    switch (option) {\r\n      case \"fontFamily\":\r\n        this.setState({\r\n          currentFontFamilyIndex: arr[1],\r\n        });\r\n        this.props.currentEpub.rendition.themes.default({\r\n          \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n            \"font-family\": `${arr[0] || \"内嵌字体\"} !important`,\r\n          },\r\n        });\r\n        break;\r\n\r\n      case \"lineHeight\":\r\n        this.setState({\r\n          currentLineHeightIndex: arr[1],\r\n        });\r\n        this.props.currentEpub.rendition.themes.default({\r\n          \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n            \"line-height\": `${arr[0] || \"1.25\"} !important`,\r\n          },\r\n        });\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n  render() {\r\n    const renderParagraphCharacter = () => {\r\n      return dropdownList.map((item) => (\r\n        <li className=\"paragraph-character-container\" key={item.id}>\r\n          <p className=\"general-setting-title\">\r\n            <Trans>{item.title}</Trans>\r\n          </p>\r\n          <select\r\n            name=\"\"\r\n            className=\"general-setting-dropdown\"\r\n            onChange={(event) => {\r\n              this.handleView(event, item.value);\r\n            }}\r\n          >\r\n            {item.option.map((subItem: string, index: number) => (\r\n              <option\r\n                value={[subItem, index.toString()]}\r\n                className=\"general-setting-option\"\r\n                key={index}\r\n              >\r\n                {subItem}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </li>\r\n      ));\r\n    };\r\n\r\n    return (\r\n      <ul className=\"paragraph-character-setting\">\r\n        {renderParagraphCharacter()}\r\n      </ul>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DropdownList;\r\n","//图书样式设置的下拉菜单页面\r\nimport { connect } from \"react-redux\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport DropdownList from \"./component\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return { currentEpub: state.book.currentEpub };\r\n};\r\nconst actionCreator = {\r\n  handleMessageBox,\r\n  handleMessage,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(DropdownList as any));\r\n","//阅读模式切换\r\nimport React from \"react\";\r\nimport \"./modeControl.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { ModeControlProps, ModeControlState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\n\r\nclass ModeControl extends React.Component<ModeControlProps, ModeControlState> {\r\n  constructor(props: ModeControlProps) {\r\n    super(props);\r\n    this.state = {\r\n      readerMode: OtherUtil.getReaderConfig(\"readerMode\") || \"double\",\r\n    };\r\n  }\r\n\r\n  handleChangeMode = (mode: string) => {\r\n    this.setState({ readerMode: mode });\r\n    OtherUtil.setReaderConfig(\"readerMode\", mode);\r\n    window.location.reload();\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"single-control-container\">\r\n        <div\r\n          className=\"single-mode-container\"\r\n          onClick={() => {\r\n            this.handleChangeMode(\"single\");\r\n          }}\r\n          style={this.state.readerMode === \"single\" ? {} : { opacity: 0.4 }}\r\n        >\r\n          <span className=\"icon-single-page single-page-icon\"></span>\r\n          <div className=\"single-mode-text\">\r\n            <Trans>Single-Page Mode</Trans>\r\n          </div>\r\n        </div>\r\n        <div\r\n          className=\"double-mode-container\"\r\n          onClick={() => {\r\n            this.handleChangeMode(\"double\");\r\n          }}\r\n          style={this.state.readerMode === \"double\" ? {} : { opacity: 0.4 }}\r\n        >\r\n          <span className=\"icon-two-page two-page-icon\"></span>\r\n          <div className=\"double-mode-text\">\r\n            <Trans>Double-Page Mode</Trans>\r\n          </div>\r\n        </div>\r\n\r\n        <div\r\n          className=\"double-mode-container\"\r\n          onClick={() => {\r\n            this.handleChangeMode(\"continuous\");\r\n          }}\r\n          style={this.state.readerMode === \"continuous\" ? {} : { opacity: 0.4 }}\r\n        >\r\n          <span className=\"icon-scroll two-page-icon\"></span>\r\n          <div className=\"double-mode-text\">\r\n            <Trans>Continuous Scroll</Trans>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default ModeControl;\r\n","//单双页切换\r\nimport { connect } from \"react-redux\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport ModeControl from \"./component\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {};\r\n};\r\nconst actionCreator = { handleMessageBox, handleMessage };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(ModeControl as any));\r\n","//右侧阅读选项面板\r\nimport React from \"react\";\r\nimport \"./settingPanel.css\";\r\nimport ThemeList from \"../../components/themeList\";\r\nimport SliderList from \"../../components/sliderList\";\r\nimport DropdownList from \"../../components/dropdownList\";\r\nimport ModeControl from \"../../components/modeControl\";\r\nimport { SettingPanelProps, SettingPanelState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport { isMobile } from \"react-device-detect\";\r\n\r\nclass SettingPanel extends React.Component<\r\n  SettingPanelProps,\r\n  SettingPanelState\r\n> {\r\n  constructor(props: SettingPanelProps) {\r\n    super(props);\r\n    this.state = {\r\n      isSupported: false,\r\n      isAudioOn: false,\r\n      isBold: OtherUtil.getReaderConfig(\"isBold\") === \"yes\",\r\n      readerMode: OtherUtil.getReaderConfig(\"readerMode\") || \"double\",\r\n      isUseBackground: OtherUtil.getReaderConfig(\"isUseBackground\") === \"yes\",\r\n      isSettingLocked:\r\n        OtherUtil.getReaderConfig(\"isSettingLocked\") === \"yes\" ? true : false,\r\n      isShowFooter: OtherUtil.getReaderConfig(\"isShowFooter\") !== \"no\",\r\n      isShowHeader: OtherUtil.getReaderConfig(\"isShowHeader\") !== \"no\",\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    if (\"speechSynthesis\" in window) {\r\n      this.setState({ isSupported: true });\r\n    }\r\n    if (this.state.isAudioOn) {\r\n      window.speechSynthesis && window.speechSynthesis.cancel();\r\n      this.setState({ isAudioOn: false });\r\n    }\r\n  }\r\n  handleChangeAudio = () => {\r\n    if (this.state.isAudioOn) {\r\n      window.speechSynthesis.cancel();\r\n      this.setState({ isAudioOn: false });\r\n    } else {\r\n      this.setState({ isAudioOn: true }, () => {\r\n        this.handleAudio();\r\n      });\r\n    }\r\n  };\r\n  handleBold = () => {\r\n    this.props.currentEpub.rendition.themes.default({\r\n      \"a, article, cite, code, div, li, p, pre, span, table\": {\r\n        \"font-weight\": `${this.state.isBold ? \"bold !important\" : \"\"}`,\r\n      },\r\n    });\r\n    this.setState({ isBold: !this.state.isBold });\r\n    OtherUtil.setReaderConfig(\"isBold\", this.state.isBold ? \"no\" : \"yes\");\r\n    window.location.reload();\r\n  };\r\n  handleAudio = () => {\r\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n    const cfibase = currentLocation.start.cfi\r\n      .replace(/!.*/, \"\")\r\n      .replace(\"epubcfi(\", \"\");\r\n    const cfistart = currentLocation.start.cfi\r\n      .replace(/.*!/, \"\")\r\n      .replace(/\\)/, \"\");\r\n    const cfiend = currentLocation.end.cfi.replace(/.*!/, \"\").replace(/\\)/, \"\");\r\n    const cfiRange = `epubcfi(${cfibase}!,${cfistart},${cfiend})`;\r\n    this.props.currentEpub.getRange(cfiRange).then((range: any) => {\r\n      let text = range.toString();\r\n      text = text\r\n        .replace(/\\s\\s/g, \"\")\r\n        .replace(/\\r/g, \"\")\r\n        .replace(/\\n/g, \"\")\r\n        .replace(/\\t/g, \"\")\r\n        .replace(/\\f/g, \"\");\r\n      var msg = new SpeechSynthesisUtterance();\r\n      msg.text = text;\r\n      window.speechSynthesis.speak(msg);\r\n      msg.onend = (event) => {\r\n        console.log(\r\n          \"Utterance has finished being spoken after \" +\r\n            event.elapsedTime +\r\n            \" milliseconds.\"\r\n        );\r\n        if (!this.state.isAudioOn || this.props.isReading) {\r\n          return;\r\n        }\r\n        this.props.currentEpub.rendition.next().then(() => {\r\n          this.handleAudio();\r\n        });\r\n      };\r\n    });\r\n  };\r\n  handleChangeBackground = () => {\r\n    this.setState({ isUseBackground: !this.state.isUseBackground });\r\n    OtherUtil.setReaderConfig(\r\n      \"isUseBackground\",\r\n      this.state.isUseBackground ? \"no\" : \"yes\"\r\n    );\r\n    this.state.isUseBackground\r\n      ? this.props.handleMessage(\"Turn Off Successfully\")\r\n      : this.props.handleMessage(\"Turn On Successfully\");\r\n    this.props.handleMessageBox(true);\r\n    window.location.reload();\r\n  };\r\n  handleFooter = () => {\r\n    this.setState({ isShowFooter: !this.state.isShowFooter });\r\n    OtherUtil.setReaderConfig(\r\n      \"isShowFooter\",\r\n      this.state.isShowFooter ? \"no\" : \"yes\"\r\n    );\r\n    this.state.isShowFooter\r\n      ? this.props.handleMessage(\"Turn On Successfully\")\r\n      : this.props.handleMessage(\"Turn Off Successfully\");\r\n    this.props.handleMessageBox(true);\r\n    setTimeout(() => {\r\n      window.location.reload();\r\n    }, 500);\r\n  };\r\n  handleHeader = () => {\r\n    this.setState({ isShowHeader: !this.state.isShowHeader });\r\n    OtherUtil.setReaderConfig(\r\n      \"isShowHeader\",\r\n      this.state.isShowHeader ? \"no\" : \"yes\"\r\n    );\r\n    this.state.isShowHeader\r\n      ? this.props.handleMessage(\"Turn On Successfully\")\r\n      : this.props.handleMessage(\"Turn Off Successfully\");\r\n    this.props.handleMessageBox(true);\r\n    setTimeout(() => {\r\n      window.location.reload();\r\n    }, 500);\r\n  };\r\n  handleLock = () => {\r\n    this.setState({ isSettingLocked: !this.state.isSettingLocked }, () => {\r\n      OtherUtil.setReaderConfig(\r\n        \"isSettingLocked\",\r\n        this.state.isSettingLocked ? \"yes\" : \"no\"\r\n      );\r\n    });\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"setting-panel-parent\">\r\n        <span\r\n          className={\r\n            this.state.isSettingLocked\r\n              ? \"icon-lock lock-icon\"\r\n              : \"icon-unlock lock-icon\"\r\n          }\r\n          onClick={() => {\r\n            this.handleLock();\r\n          }}\r\n        ></span>\r\n        <div className=\"setting-panel-title\">\r\n          <Trans>Reading Option</Trans>\r\n        </div>\r\n        <div className=\"setting-panel\">\r\n          {!isMobile && <ModeControl />}\r\n          <ThemeList />\r\n          <SliderList\r\n            {...{\r\n              maxValue: 31,\r\n              minValue: 13,\r\n              mode: \"fontSize\",\r\n            }}\r\n          />\r\n          <SliderList\r\n            {...{\r\n              maxValue: 50,\r\n              minValue: 0,\r\n              mode: \"margin\",\r\n            }}\r\n          />\r\n          {this.state.readerMode && this.state.readerMode !== \"double\" ? (\r\n            <SliderList\r\n              {...{\r\n                maxValue: 4,\r\n                minValue: 1,\r\n                mode: \"scale\",\r\n              }}\r\n            />\r\n          ) : null}\r\n\r\n          <DropdownList />\r\n          {this.state.isSupported ? (\r\n            <div className=\"single-control-switch-container\">\r\n              <span className=\"single-control-switch-title\">\r\n                <Trans>Turn on audio</Trans>\r\n              </span>\r\n\r\n              <span\r\n                className=\"single-control-switch\"\r\n                onClick={() => {\r\n                  if (this.props.locations) {\r\n                    this.handleChangeAudio();\r\n                  } else {\r\n                    this.props.handleMessage(\"Audio is not ready yet\");\r\n                    this.props.handleMessageBox(true);\r\n                  }\r\n                }}\r\n                style={\r\n                  this.props.locations\r\n                    ? this.state.isAudioOn\r\n                      ? { background: \"rgba(46, 170, 220)\" }\r\n                      : {}\r\n                    : { opacity: 0.5 }\r\n                }\r\n              >\r\n                <span\r\n                  className=\"single-control-button\"\r\n                  style={\r\n                    this.state.isAudioOn\r\n                      ? {\r\n                          transform: \"translateX(20px)\",\r\n                          transition: \"transform 0.5s ease\",\r\n                        }\r\n                      : {\r\n                          transform: \"translateX(0px)\",\r\n                          transition: \"transform 0.5s ease\",\r\n                        }\r\n                  }\r\n                ></span>\r\n              </span>\r\n            </div>\r\n          ) : null}\r\n          <div className=\"single-control-switch-container\">\r\n            <span className=\"single-control-switch-title\">\r\n              <Trans>Bold Font</Trans>\r\n            </span>\r\n\r\n            <span\r\n              className=\"single-control-switch\"\r\n              onClick={() => {\r\n                this.handleBold();\r\n              }}\r\n              style={\r\n                this.state.isBold\r\n                  ? { background: \"rgba(46, 170, 220)\", float: \"right\" }\r\n                  : { float: \"right\" }\r\n              }\r\n            >\r\n              <span\r\n                className=\"single-control-button\"\r\n                style={\r\n                  !this.state.isBold\r\n                    ? {\r\n                        transform: \"translateX(0px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                    : {\r\n                        transform: \"translateX(20px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                }\r\n              ></span>\r\n            </span>\r\n          </div>\r\n          <div\r\n            className=\"single-control-switch-container\"\r\n            style={\r\n              this.state.isAudioOn ? { background: \"rgba(46, 170, 220)\" } : {}\r\n            }\r\n          >\r\n            <span className=\"single-control-switch-title\">\r\n              <Trans>Don't show footer</Trans>\r\n            </span>\r\n\r\n            <span\r\n              className=\"single-control-switch\"\r\n              onClick={() => {\r\n                this.handleFooter();\r\n              }}\r\n              style={\r\n                !this.state.isShowFooter\r\n                  ? { background: \"rgba(46, 170, 220)\", float: \"right\" }\r\n                  : { float: \"right\" }\r\n              }\r\n            >\r\n              <span\r\n                className=\"single-control-button\"\r\n                style={\r\n                  this.state.isShowFooter\r\n                    ? {\r\n                        transform: \"translateX(0px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                    : {\r\n                        transform: \"translateX(20px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                }\r\n              ></span>\r\n            </span>\r\n          </div>\r\n          <div\r\n            className=\"single-control-switch-container\"\r\n            style={\r\n              this.state.isAudioOn ? { background: \"rgba(46, 170, 220)\" } : {}\r\n            }\r\n          >\r\n            <span className=\"single-control-switch-title\">\r\n              <Trans>Don't show header</Trans>\r\n            </span>\r\n\r\n            <span\r\n              className=\"single-control-switch\"\r\n              onClick={() => {\r\n                this.handleHeader();\r\n              }}\r\n              style={\r\n                !this.state.isShowHeader\r\n                  ? { background: \"rgba(46, 170, 220)\", float: \"right\" }\r\n                  : { float: \"right\" }\r\n              }\r\n            >\r\n              <span\r\n                className=\"single-control-button\"\r\n                style={\r\n                  this.state.isShowHeader\r\n                    ? {\r\n                        transform: \"translateX(0px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                    : {\r\n                        transform: \"translateX(20px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                }\r\n              ></span>\r\n            </span>\r\n          </div>\r\n          <div className=\"single-control-switch-container\">\r\n            <span className=\"single-control-switch-title\">\r\n              <Trans>Dont't use mimical background</Trans>\r\n            </span>\r\n            <span\r\n              className=\"single-control-switch\"\r\n              onClick={() => {\r\n                this.handleChangeBackground();\r\n              }}\r\n              style={\r\n                this.state.isUseBackground\r\n                  ? { background: \"rgba(46, 170, 220)\", float: \"right\" }\r\n                  : { float: \"right\" }\r\n              }\r\n            >\r\n              <span\r\n                className=\"single-control-button\"\r\n                style={\r\n                  this.state.isUseBackground\r\n                    ? {\r\n                        transform: \"translateX(20px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                    : {\r\n                        transform: \"translateX(0px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                }\r\n              ></span>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SettingPanel;\r\n","import { withNamespaces } from \"react-i18next\";\r\nimport { connect } from \"react-redux\";\r\nimport SettingPanel from \"./component\";\r\nimport { stateType } from \"../../store\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentEpub: state.book.currentEpub,\r\n    locations: state.progressPanel.locations,\r\n    isReading: state.book.isReading,\r\n  };\r\n};\r\nconst actionCreator = { handleMessageBox, handleMessage };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(SettingPanel as any));\r\n","//图书导航栏的目录列表\r\nimport React from \"react\";\r\nimport \"./contentList.css\";\r\nimport { ContentListProps, ContentListState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nclass ContentList extends React.Component<ContentListProps, ContentListState> {\r\n  constructor(props: ContentListProps) {\r\n    super(props);\r\n    this.state = {\r\n      chapters: [],\r\n      isCollapsed: true,\r\n      currentIndex: -1,\r\n      isExpandContent: OtherUtil.getReaderConfig(\"isExpandContent\") === \"yes\",\r\n    };\r\n    this.handleJump = this.handleJump.bind(this);\r\n  }\r\n\r\n  componentWillMount() {\r\n    //获取目录\r\n    this.props.currentEpub.loaded.navigation\r\n      .then((chapters: any) => {\r\n        this.setState({ chapters: chapters.toc });\r\n      })\r\n      .catch(() => {\r\n        console.log(\"Error occurs\");\r\n      });\r\n  }\r\n  handleJump(event: any) {\r\n    event.preventDefault();\r\n    let href = event.target.getAttribute(\"href\");\r\n    this.props.currentEpub.rendition.display(href);\r\n  }\r\n  render() {\r\n    const renderContentList = (items: any, level: number) => {\r\n      level++;\r\n      return items.map((item: any, index: number) => {\r\n        return (\r\n          <li key={index} className=\"book-content-list\">\r\n            {item.subitems.length > 0 &&\r\n              level <= 2 &&\r\n              !this.state.isExpandContent && (\r\n                <span\r\n                  className=\"icon-dropdown content-dropdown\"\r\n                  onClick={() => {\r\n                    this.setState({\r\n                      currentIndex:\r\n                        this.state.currentIndex === index ? -1 : index,\r\n                    });\r\n                  }}\r\n                  style={\r\n                    this.state.currentIndex === index\r\n                      ? {}\r\n                      : { transform: \"rotate(-90deg)\" }\r\n                  }\r\n                ></span>\r\n              )}\r\n\r\n            <a\r\n              href={item.href}\r\n              onClick={this.handleJump}\r\n              className=\"book-content-name\"\r\n            >\r\n              {item.label}\r\n            </a>\r\n            {item.subitems.length > 0 &&\r\n            (this.state.currentIndex === index ||\r\n              level > 2 ||\r\n              this.state.isExpandContent) ? (\r\n              <ul>{renderContentList(item.subitems, level)}</ul>\r\n            ) : null}\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n\r\n    return (\r\n      <div className=\"book-content-container\">\r\n        <ul className=\"book-content\">\r\n          {this.state.chapters && renderContentList(this.state.chapters, 1)}\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ContentList;\r\n","//图书导航栏的目录列表\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport ContentList from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentEpub: state.book.currentEpub,\r\n    chapters: state.reader.chapters,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(mapStateToProps, actionCreator)(ContentList);\r\n","//图书导航栏页面的书签，笔记，书摘页面\r\nimport React from \"react\";\r\nimport \"./navList.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { NavListProps, NavListState } from \"./interface\";\r\nimport DeleteIcon from \"../deleteIcon\";\r\nclass NavList extends React.Component<NavListProps, NavListState> {\r\n  constructor(props: NavListProps) {\r\n    super(props);\r\n    this.state = {\r\n      deleteIndex: -1,\r\n    };\r\n  }\r\n  //跳转到图书的指定位置\r\n  handleJump(cfi: string) {\r\n    if (!cfi) {\r\n      this.props.handleMessage(\"Wrong bookmark\");\r\n      this.props.handleMessageBox(true);\r\n      return;\r\n    }\r\n    this.props.currentEpub.rendition.display(cfi);\r\n  }\r\n  handleShowDelete = (index: number) => {\r\n    this.setState({ deleteIndex: index });\r\n  };\r\n  render() {\r\n    let currentData: any = ((this.props.currentTab === \"bookmarks\"\r\n      ? this.props.bookmarks\r\n      : this.props.currentTab === \"notes\"\r\n      ? this.props.notes.filter((item) => item.notes !== \"\")\r\n      : this.props.digests) as any).filter((item: any) => {\r\n      return item.bookKey === this.props.currentBook.key;\r\n    });\r\n    const renderBookNavList = () => {\r\n      return currentData.reverse().map((item: any, index: number) => {\r\n        const bookmarkProps = {\r\n          itemKey: item.key,\r\n          mode: this.props.currentTab === \"bookmarks\" ? \"bookmarks\" : \"notes\",\r\n        };\r\n        return (\r\n          <li\r\n            className=\"book-bookmark-list\"\r\n            key={item.key}\r\n            onMouseEnter={() => {\r\n              this.handleShowDelete(index);\r\n            }}\r\n            onMouseLeave={() => {\r\n              this.handleShowDelete(-1);\r\n            }}\r\n          >\r\n            <p className=\"book-bookmark-digest\">\r\n              {this.props.currentTab === \"bookmarks\"\r\n                ? item.label\r\n                : this.props.currentTab === \"notes\"\r\n                ? item.notes\r\n                : item.text}\r\n            </p>\r\n            <span className=\"bookmark-page-list-item-title\">\r\n              <Trans>{item.chapter}</Trans>\r\n            </span>\r\n            {this.state.deleteIndex === index ? (\r\n              <DeleteIcon {...bookmarkProps} />\r\n            ) : null}\r\n            <div\r\n              className=\"book-bookmark-link\"\r\n              onClick={() => {\r\n                this.handleJump(item.cfi);\r\n              }}\r\n              style={{ cursor: \"pointer\" }}\r\n            >\r\n              <Trans>Go To</Trans>\r\n            </div>\r\n            <div className=\"book-bookmark-progress\">\r\n              {Math.floor(item.percentage * 100)}%\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    if (!currentData[0]) {\r\n      return (\r\n        <div className=\"navigation-panel-empty-bookmark\">\r\n          <Trans>Empty</Trans>\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div className=\"book-bookmark-container\">\r\n        <ul className=\"book-bookmark\">{renderBookNavList()}</ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NavList;\r\n","//图书导航栏页面的书签页面\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport NavList from \"./component\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    currentEpub: state.book.currentEpub,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n  };\r\n};\r\nconst actionCreator = { handleMessageBox, handleMessage };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(NavList as any));\r\n","//左侧图书导航面板\r\nimport React from \"react\";\r\nimport \"./navigationPanel.css\";\r\nimport ContentList from \"../../components/contentList\";\r\nimport BookNavList from \"../../components/navList\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { NavigationPanelProps, NavigationPanelState } from \"./interface\";\r\nimport SearchBox from \"../../components/searchBox\";\r\nimport Parser from \"html-react-parser\";\r\nimport EmptyCover from \"../../components/emptyCover\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\n\r\nclass NavigationPanel extends React.Component<\r\n  NavigationPanelProps,\r\n  NavigationPanelState\r\n> {\r\n  timer: any;\r\n  constructor(props: NavigationPanelProps) {\r\n    super(props);\r\n    this.state = {\r\n      currentTab: \"contents\",\r\n      chapters: [],\r\n      cover: this.props.currentBook.cover,\r\n      isSearch: false,\r\n      searchList: null,\r\n      startIndex: 0,\r\n      currentIndex: 0,\r\n      isNavLocked:\r\n        OtherUtil.getReaderConfig(\"isNavLocked\") === \"yes\" ? true : false,\r\n    };\r\n  }\r\n  handleSearchState = (isSearch: boolean) => {\r\n    this.setState({ isSearch });\r\n  };\r\n  handleSearchList = (searchList: any) => {\r\n    this.setState({ searchList });\r\n  };\r\n  componentDidMount() {\r\n    this.props.handleFetchBookmarks();\r\n  }\r\n\r\n  handleChangeTab = (currentTab: string) => {\r\n    this.setState({ currentTab });\r\n  };\r\n  handleLock = () => {\r\n    this.setState({ isNavLocked: !this.state.isNavLocked }, () => {\r\n      OtherUtil.setReaderConfig(\r\n        \"isNavLocked\",\r\n        this.state.isNavLocked ? \"yes\" : \"no\"\r\n      );\r\n    });\r\n  };\r\n  renderSearchList = () => {\r\n    if (!this.state.searchList[0]) {\r\n      return (\r\n        <div className=\"navigation-panel-empty-bookmark\">\r\n          <Trans>Empty</Trans>\r\n        </div>\r\n      );\r\n    }\r\n    return this.state.searchList\r\n      .slice(\r\n        this.state.currentIndex * 10,\r\n        this.state.currentIndex * 10 + 10 > this.state.searchList.length\r\n          ? this.state.searchList.length\r\n          : this.state.currentIndex * 10 + 10\r\n      )\r\n      .map((item: any, index: number) => {\r\n        return (\r\n          <li\r\n            className=\"nav-search-list-item\"\r\n            key={item.cfi}\r\n            onClick={() => {\r\n              this.props.currentEpub.rendition.display(item.cfi);\r\n            }}\r\n          >\r\n            {Parser(item.excerpt)}\r\n          </li>\r\n        );\r\n      });\r\n  };\r\n  renderSearchPage = () => {\r\n    let startIndex = this.state.startIndex;\r\n    let currentIndex =\r\n      startIndex > 0 ? startIndex + 2 : this.state.currentIndex;\r\n    let pageList: any[] = [];\r\n    let total = Math.ceil(this.state.searchList.length / 10);\r\n    if (total <= 5) {\r\n      for (let i = 0; i < total; i++) {\r\n        pageList.push(\r\n          <li\r\n            className={\r\n              currentIndex === i\r\n                ? \"nav-search-page-item active-page \"\r\n                : \"nav-search-page-item\"\r\n            }\r\n            onClick={() => {\r\n              this.setState({ currentIndex: i });\r\n            }}\r\n          >\r\n            {i + 1}\r\n          </li>\r\n        );\r\n      }\r\n    } else {\r\n      for (let i = 0; i < 5; i++) {\r\n        let isShow = currentIndex > 2 ? i === 2 : currentIndex === i;\r\n        pageList.push(\r\n          <li\r\n            className={\r\n              isShow\r\n                ? \"nav-search-page-item active-page \"\r\n                : \"nav-search-page-item\"\r\n            }\r\n            onClick={() => {\r\n              if (i === 3 && startIndex === 0) {\r\n                this.setState({\r\n                  startIndex: 1,\r\n                  currentIndex: 3,\r\n                });\r\n                return;\r\n              }\r\n              this.setState({\r\n                startIndex: currentIndex > 2 ? i + startIndex - 2 : 0,\r\n                currentIndex: i + startIndex,\r\n              });\r\n            }}\r\n          >\r\n            {i + startIndex + 1}\r\n          </li>\r\n        );\r\n      }\r\n    }\r\n    return pageList;\r\n  };\r\n  render() {\r\n    const searchProps = {\r\n      mode: this.state.isSearch ? \"\" : \"nav\",\r\n      width: \"100px\",\r\n      height: \"35px\",\r\n      isNavSearch: this.state.isSearch,\r\n      handleSearchState: this.handleSearchState,\r\n      handleSearchList: this.handleSearchList,\r\n    };\r\n    const bookmarkProps = {\r\n      currentTab: this.state.currentTab,\r\n    };\r\n    return (\r\n      <div className=\"navigation-panel\">\r\n        {this.state.isSearch ? (\r\n          <>\r\n            <div\r\n              className=\"nav-close-icon\"\r\n              onClick={() => {\r\n                this.handleSearchState(false);\r\n                this.props.handleSearch(false);\r\n                this.setState({ searchList: null });\r\n              }}\r\n            >\r\n              <span className=\"icon-close\"></span>\r\n            </div>\r\n\r\n            <div\r\n              className=\"header-search-container\"\r\n              style={this.state.isSearch ? { left: 40 } : {}}\r\n            >\r\n              <div\r\n                className=\"navigation-search-title\"\r\n                style={{ height: \"20px\", margin: \"0px 25px 13px\" }}\r\n              >\r\n                <Trans>Search the book</Trans>\r\n              </div>\r\n              <SearchBox {...searchProps} />\r\n            </div>\r\n            <ul className=\"nav-search-list\">\r\n              {this.state.searchList ? this.renderSearchList() : null}\r\n            </ul>\r\n            <ul className=\"nav-search-page\">\r\n              {this.state.searchList ? this.renderSearchPage() : null}\r\n            </ul>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <div className=\"navigation-header\">\r\n              <span\r\n                className={\r\n                  this.state.isNavLocked\r\n                    ? \"icon-lock nav-lock-icon\"\r\n                    : \"icon-unlock nav-lock-icon\"\r\n                }\r\n                style={{}}\r\n                onClick={() => {\r\n                  this.handleLock();\r\n                }}\r\n              ></span>\r\n              {this.state.cover &&\r\n              this.props.currentBook.cover !== \"noCover\" &&\r\n              this.props.currentBook.publisher !== \"mobi\" &&\r\n              this.props.currentBook.publisher !== \"azw3\" &&\r\n              this.props.currentBook.publisher !== \"txt\" ? (\r\n                <img className=\"book-cover\" src={this.state.cover} alt=\"\" />\r\n              ) : (\r\n                <div className=\"book-cover\">\r\n                  <EmptyCover\r\n                    {...{\r\n                      format: this.props.currentBook.format,\r\n                      title: this.props.currentBook.name,\r\n                      scale: 0.86,\r\n                    }}\r\n                  />\r\n                </div>\r\n              )}\r\n\r\n              <p className=\"book-title\">{this.props.currentBook.name}</p>\r\n              <p className=\"book-arthur\">\r\n                <Trans>Author</Trans>:{\" \"}\r\n                <Trans>\r\n                  {this.props.currentBook.author\r\n                    ? this.props.currentBook.author\r\n                    : \"Unknown Authur\"}\r\n                </Trans>\r\n              </p>\r\n              <span className=\"reading-duration\">\r\n                <Trans>Reading Time</Trans>: {Math.floor(this.props.time / 60)}\r\n                &nbsp;\r\n                <Trans>Minute</Trans>\r\n              </span>\r\n              <div className=\"navigation-search-box\">\r\n                <SearchBox {...searchProps} />\r\n              </div>\r\n\r\n              <div className=\"navigation-navigation\">\r\n                <span\r\n                  className=\"book-content-title\"\r\n                  onClick={() => {\r\n                    this.handleChangeTab(\"contents\");\r\n                  }}\r\n                  style={\r\n                    this.state.currentTab === \"contents\"\r\n                      ? { color: \"rgba(112, 112, 112, 1)\" }\r\n                      : { color: \"rgba(217, 217, 217, 1)\" }\r\n                  }\r\n                >\r\n                  <Trans>Content</Trans>\r\n                </span>\r\n                <span\r\n                  className=\"book-bookmark-title\"\r\n                  style={\r\n                    this.state.currentTab === \"bookmarks\"\r\n                      ? { color: \"rgba(112, 112, 112, 1)\" }\r\n                      : { color: \"rgba(217, 217, 217, 1)\" }\r\n                  }\r\n                  onClick={() => {\r\n                    this.handleChangeTab(\"bookmarks\");\r\n                  }}\r\n                >\r\n                  <Trans>Bookmark</Trans>\r\n                </span>\r\n                <span\r\n                  className=\"book-bookmark-title\"\r\n                  style={\r\n                    this.state.currentTab === \"notes\"\r\n                      ? { color: \"rgba(112, 112, 112, 1)\" }\r\n                      : { color: \"rgba(217, 217, 217, 1)\" }\r\n                  }\r\n                  onClick={() => {\r\n                    this.handleChangeTab(\"notes\");\r\n                  }}\r\n                >\r\n                  <Trans>Note</Trans>\r\n                </span>\r\n                <span\r\n                  className=\"book-bookmark-title\"\r\n                  style={\r\n                    this.state.currentTab === \"digests\"\r\n                      ? { color: \"rgba(112, 112, 112, 1)\" }\r\n                      : { color: \"rgba(217, 217, 217, 1)\" }\r\n                  }\r\n                  onClick={() => {\r\n                    this.handleChangeTab(\"digests\");\r\n                  }}\r\n                >\r\n                  <Trans>Digest</Trans>\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div className=\"navigation-body-parent\">\r\n              <div className=\"navigation-body\">\r\n                {this.state.currentTab === \"contents\" ? (\r\n                  <ContentList />\r\n                ) : (\r\n                  <BookNavList {...bookmarkProps} />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NavigationPanel;\r\n","//图书导航栏\r\nimport { connect } from \"react-redux\";\r\nimport { handleFetchBookmarks } from \"../../store/actions/reader\";\r\nimport { handleSearch } from \"../../store/actions/manager\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport NavigationPanel from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n  };\r\n};\r\nconst actionCreator = { handleFetchBookmarks, handleSearch };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(NavigationPanel as any));\r\n","class Bookmark {\n  key: string;\n  bookKey: string;\n  cfi: string;\n  label: string;\n  percentage: number;\n  chapter: string;\n  constructor(\n    bookKey: string,\n    cfi: string,\n    label: string,\n    percentage: number,\n    chapter: string\n  ) {\n    this.key = new Date().getTime() + \"\"; // 唯一的键\n    this.bookKey = bookKey; // 所属的书籍的键\n    this.cfi = cfi; // 标记阅读位置的cfi\n    this.label = label; // 此项书签的别名\n    this.percentage = percentage; // 此项书签的摘要\n    this.chapter = chapter; // 此项书签的摘要\n  }\n}\n\nexport default Bookmark;\n","//顶部图书操作面板\r\nimport React from \"react\";\r\nimport \"./operationPanel.css\";\r\nimport Bookmark from \"../../model/Bookmark\";\r\nimport { Trans } from \"react-i18next\";\r\nimport localforage from \"localforage\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport { OperationPanelProps, OperationPanelState } from \"./interface\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport ReadingTime from \"../../utils/readUtils/readingTime\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { setInterval } from \"timers\";\r\nimport { isMobile, isElectron } from \"react-device-detect\";\r\nimport BackupUtil from \"../../utils/syncUtils/backupUtil\";\r\n\r\ndeclare var document: any;\r\n\r\nclass OperationPanel extends React.Component<\r\n  OperationPanelProps,\r\n  OperationPanelState\r\n> {\r\n  timeStamp: number;\r\n  speed: number;\r\n  timer: any;\r\n\r\n  constructor(props: OperationPanelProps) {\r\n    super(props);\r\n    this.state = {\r\n      isFullScreen:\r\n        OtherUtil.getReaderConfig(\"isFullScreen\") === \"yes\" ? true : false, // 是否进入全屏模式\r\n      isBookmark: false, // 是否添加书签\r\n      time: 0,\r\n      currentPercentage: RecordLocation.getCfi(this.props.currentBook.key)\r\n        ? RecordLocation.getCfi(this.props.currentBook.key).percentage\r\n        : 0,\r\n      timeLeft: 0,\r\n    };\r\n    this.timeStamp = Date.now();\r\n    this.speed = 30000;\r\n  }\r\n  componentWillReceiveProps(nextProps: OperationPanelProps) {\r\n    if (\r\n      nextProps.currentEpub.rendition &&\r\n      nextProps.currentEpub.rendition.location &&\r\n      this.props.currentEpub.rendition\r\n    ) {\r\n      const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n      if (!currentLocation.start) {\r\n        return;\r\n      }\r\n      if (\r\n        this.props.currentEpub.rendition.currentLocation().percentage !==\r\n        nextProps.currentEpub.rendition.currentLocation().percentage\r\n      ) {\r\n        this.speed = Date.now() - this.timeStamp;\r\n        this.timeStamp = Date.now();\r\n      }\r\n      this.setState({\r\n        timeLeft:\r\n          ((currentLocation.start.displayed.total -\r\n            currentLocation.start.displayed.page) *\r\n            this.speed) /\r\n          1000,\r\n      });\r\n      // let nextPercentage = section.start.percentage;\r\n    }\r\n  }\r\n  // 点击切换全屏按钮触发\r\n  handleScreen() {\r\n    !this.state.isFullScreen\r\n      ? this.handleFullScreen()\r\n      : this.handleExitFullScreen();\r\n  }\r\n  //控制进入全屏\r\n  handleFullScreen() {\r\n    let de: any = document.documentElement;\r\n    if (de.requestFullscreen) {\r\n      de.requestFullscreen();\r\n    } else if (de.mozRequestFullScreen) {\r\n      de.mozRequestFullScreen();\r\n    } else if (de.webkitRequestFullscreen) {\r\n      de.webkitRequestFullscreen();\r\n    } else if (de.msRequestFullscreen) {\r\n      de.msRequestFullscreen();\r\n    }\r\n\r\n    this.setState({ isFullScreen: true });\r\n    OtherUtil.setReaderConfig(\"isFullScreen\", \"yes\");\r\n    if (!isMobile) {\r\n      this.timer = setInterval(() => {\r\n        if (window.screenTop === 0) {\r\n          this.setState({ isFullScreen: false });\r\n          OtherUtil.setReaderConfig(\"isFullScreen\", \"no\");\r\n        }\r\n      }, 1000);\r\n    }\r\n  }\r\n  // 退出全屏模式\r\n  handleExitFullScreen() {\r\n    //解决使用esc退出全屏，再退出阅读时发生的bug\r\n    if (!document.fullscreenElement) return;\r\n\r\n    if (document.exitFullscreen) {\r\n      document.exitFullscreen();\r\n    } else if (document.msExitFullscreen) {\r\n      document.msExitFullscreen();\r\n    } else if (document.mozCancelFullScreen) {\r\n      document.mozCancelFullScreen();\r\n    } else if (document.webkitExitFullscreen) {\r\n      document.webkitExitFullscreen();\r\n    }\r\n\r\n    this.setState({ isFullScreen: false });\r\n    OtherUtil.setReaderConfig(\"isFullScreen\", \"no\");\r\n  }\r\n  handleAddBookmark() {\r\n    let bookKey = this.props.currentBook.key;\r\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n    let chapterHref = currentLocation.start.href;\r\n    let chapter = \"Unknown Chapter\";\r\n    let currentChapter = this.props.flattenChapters.filter(\r\n      (item: any) =>\r\n        chapterHref.indexOf(item.href.split(\"#\")[0]) > -1 ||\r\n        item.href.split(\"#\")[0].indexOf(chapterHref) > -1\r\n    )[0];\r\n    if (currentChapter) {\r\n      chapter = currentChapter.label.trim(\" \");\r\n    }\r\n    const cfibase = currentLocation.start.cfi\r\n      .replace(/!.*/, \"\")\r\n      .replace(\"epubcfi(\", \"\");\r\n    const cfistart = currentLocation.start.cfi\r\n      .replace(/.*!/, \"\")\r\n      .replace(/\\)/, \"\");\r\n    const cfiend = currentLocation.end.cfi.replace(/.*!/, \"\").replace(/\\)/, \"\");\r\n    const cfiRange = `epubcfi(${cfibase}!,${cfistart},${cfiend})`;\r\n    const cfi = RecordLocation.getCfi(this.props.currentBook.key).cfi;\r\n    this.props.currentEpub.getRange(cfiRange).then((range: any) => {\r\n      if (!range) return;\r\n      let text = range.toString();\r\n      text = text.replace(/\\s\\s/g, \"\");\r\n      text = text.replace(/\\r/g, \"\");\r\n      text = text.replace(/\\n/g, \"\");\r\n      text = text.replace(/\\t/g, \"\");\r\n      text = text.replace(/\\f/g, \"\");\r\n      let percentage = RecordLocation.getCfi(this.props.currentBook.key)\r\n        .percentage\r\n        ? RecordLocation.getCfi(this.props.currentBook.key).percentage\r\n        : 0;\r\n      let bookmark = new Bookmark(bookKey, cfi, text, percentage, chapter);\r\n      let bookmarkArr = this.props.bookmarks ?? [];\r\n      bookmarkArr.push(bookmark);\r\n      this.props.handleBookmarks(bookmarkArr);\r\n      localforage.setItem(\"bookmarks\", bookmarkArr);\r\n      this.setState({ isBookmark: true });\r\n      this.props.handleMessage(\"Add Successfully\");\r\n      this.props.handleMessageBox(true);\r\n      this.props.handleShowBookmark(true);\r\n    });\r\n  }\r\n\r\n  // 点击退出按钮的处理程序\r\n  handleExit() {\r\n    OtherUtil.setReaderConfig(\"isFullScreen\", \"no\");\r\n    window.speechSynthesis && window.speechSynthesis.cancel();\r\n    if (this.state.isFullScreen) {\r\n      this.handleExitFullScreen();\r\n    }\r\n    this.props.handleSearch(false);\r\n    this.props.handleOpenMenu(false);\r\n    ReadingTime.setTime(this.props.currentBook.key, this.props.time);\r\n    isElectron &&\r\n      BackupUtil.backup(\r\n        this.props.books,\r\n        this.props.notes,\r\n        this.props.bookmarks,\r\n        () => {},\r\n        5,\r\n        () => {}\r\n      );\r\n    setTimeout(() => {\r\n      window.close();\r\n    }, 200);\r\n    // this.props.history.push(\"/manager/home\");\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"book-operation-panel\">\r\n        <div className=\"book-opeartion-info\">\r\n          <span>\r\n            <Trans\r\n              i18nKey=\"Current Reading Time\"\r\n              count={Math.floor(\r\n                (this.props.time -\r\n                  ReadingTime.getTime(this.props.currentBook.key)) /\r\n                  60\r\n              )}\r\n            >\r\n              Current Reading Time:\r\n              {{\r\n                count: Math.abs(\r\n                  Math.floor(\r\n                    (this.props.time -\r\n                      ReadingTime.getTime(this.props.currentBook.key)) /\r\n                      60\r\n                  )\r\n                ),\r\n              }}\r\n              Minutes\r\n            </Trans>\r\n          </span>\r\n          &nbsp;&nbsp;&nbsp;\r\n          <span>\r\n            <Trans\r\n              i18nKey=\"Finish Reading Time\"\r\n              count={Math.ceil(this.state.timeLeft / 60)}\r\n            >\r\n              Finish Reading Time:\r\n              {{\r\n                count: `${Math.ceil(this.state.timeLeft / 60)}`,\r\n              }}\r\n              Minutes\r\n            </Trans>\r\n          </span>\r\n        </div>\r\n        <div\r\n          className=\"exit-reading-button\"\r\n          onClick={() => {\r\n            this.handleExit();\r\n          }}\r\n        >\r\n          <span className=\"icon-exit exit-reading-icon\"></span>\r\n          <span className=\"exit-reading-text\">\r\n            <Trans>Exit</Trans>\r\n          </span>\r\n        </div>\r\n        <div\r\n          className=\"add-bookmark-button\"\r\n          onClick={() => {\r\n            this.handleAddBookmark();\r\n          }}\r\n        >\r\n          <span className=\"icon-add add-bookmark-icon\"></span>\r\n          <span className=\"add-bookmark-text\">\r\n            <Trans>Add Bookmark</Trans>\r\n          </span>\r\n        </div>\r\n        <div\r\n          className=\"enter-fullscreen-button\"\r\n          onClick={() => {\r\n            this.handleScreen();\r\n          }}\r\n        >\r\n          <span className=\"icon-fullscreen enter-fullscreen-icon\"></span>\r\n          {!this.state.isFullScreen ? (\r\n            <span className=\"enter-fullscreen-text\">\r\n              <Trans>Enter Fullscreen</Trans>\r\n            </span>\r\n          ) : (\r\n            <span className=\"enter-fullscreen-text\">\r\n              <Trans>Exit Fullscreen</Trans>\r\n            </span>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(OperationPanel);\r\n","//图书操作页面\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  handleBookmarks,\r\n  handleFetchBookmarks,\r\n} from \"../../store/actions/reader\";\r\nimport {\r\n  handleOpenMenu,\r\n  handleShowBookmark,\r\n} from \"../../store/actions/viewArea\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleSearch,\r\n} from \"../../store/actions/manager\";\r\nimport { handleReadingState } from \"../../store/actions/book\";\r\nimport OperationPanel from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    books: state.manager.books,\r\n    locations: state.progressPanel.locations,\r\n    flattenChapters: state.reader.flattenChapters,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleBookmarks,\r\n  handleReadingState,\r\n  handleFetchBookmarks,\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleOpenMenu,\r\n  handleShowBookmark,\r\n  handleSearch,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(OperationPanel as any));\r\n","//底部阅读进度面板\r\nimport React from \"react\";\r\nimport \"./progressPanel.css\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { ProgressPanelProps, ProgressPanelState } from \"./interface\";\r\n\r\nclass ProgressPanel extends React.Component<\r\n  ProgressPanelProps,\r\n  ProgressPanelState\r\n> {\r\n  constructor(props: ProgressPanelProps) {\r\n    super(props);\r\n    this.state = {\r\n      displayPercentage: this.props.percentage ? this.props.percentage : 0,\r\n      currentChapter: \"\",\r\n      currentPage: 0,\r\n      totalPage: 0,\r\n      currentChapterIndex: 0,\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps: ProgressPanelProps) {\r\n    if (\r\n      nextProps.currentEpub.rendition &&\r\n      nextProps.currentEpub.rendition.location &&\r\n      this.props.currentEpub.rendition\r\n    ) {\r\n      const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n      if (!currentLocation.start) {\r\n        return;\r\n      }\r\n      this.setState({\r\n        currentPage: currentLocation.start.displayed.page,\r\n        totalPage: currentLocation.start.displayed.total,\r\n        currentChapterIndex: currentLocation.start.index,\r\n      });\r\n      let chapterHref = currentLocation.start.href;\r\n      let chapter = \"Unknown Chapter\";\r\n      let currentChapter = this.props.flattenChapters.filter(\r\n        (item: any) => item.href.split(\"#\")[0] === chapterHref\r\n      )[0];\r\n      if (currentChapter) {\r\n        chapter = currentChapter.label.trim(\" \");\r\n      }\r\n      this.setState({ currentChapter: chapter });\r\n    }\r\n  }\r\n  //WARNING! To be deprecated in React v17. Use componentDidMount instead.\r\n  onProgressChange = (event: any) => {\r\n    const percentage = event.target.value / 100;\r\n    const location = percentage\r\n      ? this.props.locations.cfiFromPercentage(percentage)\r\n      : 0;\r\n    this.props.currentEpub.rendition.display(location);\r\n  };\r\n  //使进度百分比随拖动实时变化\r\n  onProgressInput = (event: any) => {\r\n    this.setState({ displayPercentage: event.target.value / 100 });\r\n  };\r\n  previourChapter = () => {\r\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n    if (!currentLocation.start) return;\r\n    let chapterIndex = currentLocation.start.index;\r\n    this.setState({\r\n      currentChapterIndex: chapterIndex,\r\n    });\r\n    const section = this.props.currentEpub.section(chapterIndex - 1);\r\n    if (section && section.href) {\r\n      this.props.currentEpub.rendition.display(section.href).then(() => {\r\n        let percentage = RecordLocation.getCfi(this.props.currentBook.key)\r\n          .percentage\r\n          ? RecordLocation.getCfi(this.props.currentBook.key).percentage\r\n          : 0;\r\n\r\n        this.setState({ displayPercentage: percentage });\r\n      });\r\n    }\r\n  };\r\n  nextChapter = () => {\r\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\r\n    if (!currentLocation.start) return;\r\n    let chapterIndex = currentLocation.start.index;\r\n    this.setState({\r\n      currentChapterIndex: chapterIndex,\r\n    });\r\n    const section = this.props.currentEpub.section(chapterIndex + 1);\r\n    if (section && section.href) {\r\n      this.props.currentEpub.rendition.display(section.href).then(() => {\r\n        let percentage = RecordLocation.getCfi(this.props.currentBook.key)\r\n          .percentage\r\n          ? RecordLocation.getCfi(this.props.currentBook.key).percentage\r\n          : 0;\r\n        this.setState({ displayPercentage: percentage });\r\n      });\r\n    }\r\n  };\r\n  handleJumpChapter = (event: any) => {\r\n    if (!event.target.value) return;\r\n    const section = this.props.currentEpub.section(event.target.value);\r\n    if (section && section.href) {\r\n      this.props.currentEpub.rendition.display(section.href).then(() => {\r\n        let percentage = RecordLocation.getCfi(this.props.currentBook.key)\r\n          .percentage\r\n          ? RecordLocation.getCfi(this.props.currentBook.key).percentage\r\n          : 0;\r\n        this.setState({ displayPercentage: percentage });\r\n      });\r\n    }\r\n  };\r\n  handleJumpPage = (event: any) => {};\r\n  render() {\r\n    if (!this.props.locations) {\r\n      return (\r\n        <div className=\"progress-panel\">\r\n          <div className=\"spinner\" style={{ top: \"40%\" }}>\r\n            <div className=\"sk-chase\">\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n              <div className=\"sk-chase-dot\"></div>\r\n            </div>\r\n          </div>\r\n          <p className=\"progress-text\">\r\n            <Trans>Loading</Trans>\r\n          </p>\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div className=\"progress-panel\">\r\n        <p className=\"progress-text\" style={{ marginTop: 10 }}>\r\n          <span>\r\n            <Trans>Current Progress</Trans>:{\" \"}\r\n            {Math.round(\r\n              this.state.displayPercentage > 1\r\n                ? 100\r\n                : this.state.displayPercentage * 100\r\n            )}\r\n            %&nbsp;&nbsp;&nbsp;\r\n          </span>\r\n        </p>\r\n\r\n        <p className=\"progress-text\" style={{ marginTop: 0 }}>\r\n          {this.state.currentPage > 0 ? (\r\n            <>\r\n              <Trans>Current Chapter Pages</Trans>\r\n              <input\r\n                type=\"text\"\r\n                name=\"jumpPage\"\r\n                id=\"jumpPage\"\r\n                onBlur={(event) => {\r\n                  this.handleJumpPage(event);\r\n                }}\r\n                value={this.state.currentPage}\r\n              />\r\n              <span>/ {this.state.totalPage}</span>&nbsp;&nbsp;&nbsp;\r\n              <Trans>Chapter Redirect</Trans>\r\n              <input\r\n                type=\"text\"\r\n                name=\"jumpChapter\"\r\n                id=\"jumpChapter\"\r\n                onBlur={(event) => {\r\n                  this.handleJumpChapter(event);\r\n                }}\r\n                defaultValue={this.state.currentChapterIndex}\r\n              />\r\n              <span>\r\n                / {this.props.currentEpub.rendition.book.spine.length}\r\n              </span>\r\n            </>\r\n          ) : null}\r\n        </p>\r\n        <div>\r\n          <input\r\n            className=\"input-progress\"\r\n            defaultValue={Math.round(this.state.displayPercentage * 100)}\r\n            type=\"range\"\r\n            max=\"100\"\r\n            min=\"0\"\r\n            step=\"1\"\r\n            onMouseUp={(event) => {\r\n              this.onProgressChange(event);\r\n            }}\r\n            onTouchEnd={(event) => {\r\n              this.onProgressChange(event);\r\n            }}\r\n            onChange={(event) => {\r\n              this.onProgressInput(event);\r\n            }}\r\n            style={{ width: 300, left: 50, top: 73 }}\r\n          />\r\n        </div>\r\n\r\n        <div\r\n          className=\"previous-chapter\"\r\n          onClick={() => {\r\n            this.previourChapter();\r\n          }}\r\n        >\r\n          <span className=\"icon-dropdown previous-chapter-icon\"> </span>\r\n        </div>\r\n        <div\r\n          className=\"next-chapter\"\r\n          onClick={() => {\r\n            this.nextChapter();\r\n          }}\r\n        >\r\n          <span className=\"icon-dropdown next-chapter-icon\"></span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ProgressPanel;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withNamespaces } from \"react-i18next\";\r\nimport ProgressPanel from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n    percentage: state.progressPanel.percentage,\r\n    locations: state.progressPanel.locations,\r\n    flattenChapters: state.reader.flattenChapters,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(ProgressPanel as any));\r\n","import OtherUtil from \"./otherUtil\";\r\nlet Hammer = (window as any).Hammer;\r\ndeclare var document: any;\r\nexport const MouseEvent = (rendition: any) => {\r\n  let isFirefox = navigator.userAgent.indexOf(\"Firefox\") !== -1;\r\n  let lock = false; // 暂时锁住翻页快捷键，避免快速点击产生的Bug\r\n  const arrowKeys = (event: any) => {\r\n    // event.preventDefault();\r\n    if (lock) return;\r\n\r\n    if (event.keyCode === 37 || event.keyCode === 38) {\r\n      rendition.prev();\r\n      lock = true;\r\n      setTimeout(function () {\r\n        lock = false;\r\n      }, 100);\r\n      return false;\r\n    }\r\n    if (event.keyCode === 39 || event.keyCode === 40) {\r\n      rendition.next();\r\n      lock = true;\r\n      setTimeout(function () {\r\n        lock = false;\r\n      }, 100);\r\n      return false;\r\n    }\r\n  };\r\n  const mouseFirefox = (event: any) => {\r\n    event.preventDefault();\r\n    if (lock) return;\r\n    if (event.detail < 0) {\r\n      rendition.prev();\r\n      lock = true;\r\n      setTimeout(function () {\r\n        lock = false;\r\n      }, 100);\r\n      return false;\r\n    }\r\n    if (event.detail > 0) {\r\n      rendition.next();\r\n      lock = true;\r\n      setTimeout(function () {\r\n        lock = false;\r\n      }, 100);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const mouseChrome = (event: any) => {\r\n    if (lock) return;\r\n    if (event.wheelDelta > 0) {\r\n      rendition.prev();\r\n      lock = true;\r\n      setTimeout(function () {\r\n        lock = false;\r\n      }, 100);\r\n      return false;\r\n    }\r\n    if (event.wheelDelta < 0) {\r\n      rendition.next();\r\n      lock = true;\r\n      setTimeout(function () {\r\n        lock = false;\r\n      }, 100);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const gesture = (event: any) => {\r\n    if (lock) return;\r\n    if (event.type === \"panleft\" || event.type === \"panup\") {\r\n      rendition.next();\r\n      lock = true;\r\n      setTimeout(function () {\r\n        lock = false;\r\n      }, 100);\r\n      return false;\r\n    }\r\n    if (event.type === \"panright\" || event.type === \"pandown\") {\r\n      rendition.prev();\r\n      lock = true;\r\n      setTimeout(function () {\r\n        lock = false;\r\n      }, 100);\r\n      return false;\r\n    }\r\n  };\r\n  const bindEvent = (doc: any) => {\r\n    doc.addEventListener(\"keydown\", arrowKeys); // 箭头按键翻页\r\n    // 鼠标滚轮翻页\r\n    if (isFirefox) {\r\n      doc.addEventListener(\"DOMMouseScroll\", mouseFirefox, false);\r\n    } else {\r\n      doc.addEventListener(\"mousewheel\", mouseChrome, false);\r\n    }\r\n  };\r\n\r\n  rendition.on(\"rendered\", () => {\r\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) {\r\n      return;\r\n    }\r\n    if (OtherUtil.getReaderConfig(\"isTouch\") === \"yes\") {\r\n      const mc = new Hammer(doc);\r\n      mc.on(\"panleft panright panup pandown\", (event: any) => {\r\n        gesture(event);\r\n      });\r\n    }\r\n\r\n    // 鼠标滚轮翻页\r\n    window.addEventListener(\"keydown\", arrowKeys);\r\n    bindEvent(doc);\r\n  });\r\n};\r\n","import React from \"react\";\r\nimport ViewArea from \"../viewArea\";\r\nimport Background from \"../background\";\r\nimport SettingPanel from \"../settingPanel\";\r\nimport NavigationPanel from \"../navigationPanel\";\r\nimport OperationPanel from \"../operationPanel\";\r\nimport MessageBox from \"../messageBox\";\r\nimport ProgressPanel from \"../progressPanel\";\r\nimport { ReaderProps, ReaderState } from \"./interface\";\r\nimport { MouseEvent } from \"../../utils/mouseEvent\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport ReadingTime from \"../../utils/readUtils/readingTime\";\r\nimport { isMobile } from \"react-device-detect\";\r\n\r\nclass Reader extends React.Component<ReaderProps, ReaderState> {\r\n  messageTimer!: NodeJS.Timeout;\r\n  tickTimer!: NodeJS.Timeout;\r\n  rendition: any;\r\n\r\n  constructor(props: ReaderProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOpenSettingPanel:\r\n        OtherUtil.getReaderConfig(\"isSettingLocked\") === \"yes\" ? true : false,\r\n      isOpenOperationPanel: false,\r\n      isOpenProgressPanel: false,\r\n      isOpenNavPanel:\r\n        OtherUtil.getReaderConfig(\"isNavLocked\") === \"yes\" ? true : false,\r\n      isMessage: false,\r\n      rendition: null,\r\n      scale: OtherUtil.getReaderConfig(\"scale\") || 1,\r\n      margin: OtherUtil.getReaderConfig(\"margin\") || 30,\r\n      time: ReadingTime.getTime(this.props.currentBook.key),\r\n      isTouch: OtherUtil.getReaderConfig(\"isTouch\") === \"yes\",\r\n      readerMode: OtherUtil.getReaderConfig(\"readerMode\") || \"double\",\r\n    };\r\n  }\r\n  componentWillMount() {\r\n    this.props.handleFetchBookmarks();\r\n    this.props.handleFetchPercentage(this.props.currentBook);\r\n    this.props.handleFetchNotes();\r\n    this.props.handleFetchBooks();\r\n    this.props.handleFetchChapters(this.props.currentEpub);\r\n  }\r\n  UNSAFE_componentWillReceiveProps(nextProps: ReaderProps) {\r\n    this.setState({\r\n      isMessage: nextProps.isMessage,\r\n    });\r\n\r\n    //控制消息提示两秒之后消失\r\n    if (nextProps.isMessage) {\r\n      this.messageTimer = setTimeout(() => {\r\n        this.props.handleMessageBox(false);\r\n        this.setState({ isMessage: false });\r\n      }, 2000);\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    let page = document.querySelector(\"#page-area\");\r\n    let epub = this.props.currentEpub;\r\n    (window as any).rangy.init(); // 初始化\r\n    this.rendition = epub.renderTo(page, {\r\n      manager:\r\n        this.state.readerMode === \"continuous\" || isMobile\r\n          ? \"continuous\"\r\n          : \"default\",\r\n      flow:\r\n        this.state.readerMode === \"continuous\" || isMobile\r\n          ? \"scrolled\"\r\n          : \"auto\",\r\n      width: \"100%\",\r\n      height: \"100%\",\r\n      snap: true,\r\n      spread:\r\n        OtherUtil.getReaderConfig(\"readerMode\") === \"single\" ? \"none\" : \"\",\r\n    });\r\n    this.setState({ rendition: this.rendition });\r\n    this.state.readerMode !== \"continuous\" && MouseEvent(this.rendition); // 绑定事件\r\n    this.tickTimer = setInterval(() => {\r\n      let time = this.state.time;\r\n      time += 1;\r\n      this.setState({ time });\r\n    }, 1000);\r\n    if (OtherUtil.getReaderConfig(\"isFirst\") !== \"no\") {\r\n      this.handleEnterReader(\"left\");\r\n      this.handleEnterReader(\"right\");\r\n      this.handleEnterReader(\"bottom\");\r\n      this.handleEnterReader(\"top\");\r\n      OtherUtil.setReaderConfig(\"isFirst\", \"no\");\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    //清除上面的计时器\r\n    clearTimeout(this.messageTimer);\r\n    clearInterval(this.tickTimer);\r\n  }\r\n  //进入阅读器\r\n  handleEnterReader = (position: string) => {\r\n    if (\r\n      isMobile &&\r\n      (this.state.isOpenNavPanel ||\r\n        this.state.isOpenOperationPanel ||\r\n        this.state.isOpenProgressPanel ||\r\n        this.state.isOpenSettingPanel)\r\n    ) {\r\n      this.handleLeaveReader(\"left\");\r\n      this.handleLeaveReader(\"right\");\r\n      this.handleLeaveReader(\"bottom\");\r\n      this.handleLeaveReader(\"top\");\r\n      return;\r\n    }\r\n\r\n    //控制上下左右的菜单的显示\r\n    switch (position) {\r\n      case \"right\":\r\n        this.setState({\r\n          isOpenSettingPanel: this.state.isOpenSettingPanel ? false : true,\r\n        });\r\n        break;\r\n      case \"left\":\r\n        this.setState({\r\n          isOpenNavPanel: this.state.isOpenNavPanel ? false : true,\r\n        });\r\n        break;\r\n      case \"top\":\r\n        this.setState({\r\n          isOpenOperationPanel: this.state.isOpenOperationPanel ? false : true,\r\n        });\r\n        break;\r\n      case \"bottom\":\r\n        this.setState({\r\n          isOpenProgressPanel: this.state.isOpenProgressPanel ? false : true,\r\n        });\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n  //退出阅读器\r\n  handleLeaveReader = (position: string) => {\r\n    //控制上下左右的菜单的显示\r\n    switch (position) {\r\n      case \"right\":\r\n        if (OtherUtil.getReaderConfig(\"isSettingLocked\") === \"yes\") {\r\n          break;\r\n        } else {\r\n          this.setState({ isOpenSettingPanel: false });\r\n          break;\r\n        }\r\n\r\n      case \"left\":\r\n        if (OtherUtil.getReaderConfig(\"isNavLocked\") === \"yes\") {\r\n          break;\r\n        } else {\r\n          this.setState({ isOpenNavPanel: false });\r\n          break;\r\n        }\r\n      case \"top\":\r\n        this.setState({ isOpenOperationPanel: false });\r\n        break;\r\n      case \"bottom\":\r\n        this.setState({ isOpenProgressPanel: false });\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n  nextPage = () => {\r\n    this.state.rendition.next();\r\n  };\r\n  prevPage = () => {\r\n    this.state.rendition.prev();\r\n  };\r\n  render() {\r\n    const renditionProps = {\r\n      rendition: this.state.rendition,\r\n      handleLeaveReader: this.handleLeaveReader,\r\n      handleEnterReader: this.handleEnterReader,\r\n      isShow:\r\n        this.state.isOpenNavPanel ||\r\n        this.state.isOpenOperationPanel ||\r\n        this.state.isOpenProgressPanel ||\r\n        this.state.isOpenSettingPanel,\r\n    };\r\n    return (\r\n      <div className=\"viewer\">\r\n        <div\r\n          className=\"previous-chapter-single-container\"\r\n          onClick={() => {\r\n            this.prevPage();\r\n          }}\r\n          style={isMobile ? { display: \"none\" } : {}}\r\n        >\r\n          <span className=\"icon-dropdown previous-chapter-single\"></span>\r\n        </div>\r\n        <div\r\n          className=\"next-chapter-single-container\"\r\n          onClick={() => {\r\n            this.nextPage();\r\n          }}\r\n          style={isMobile ? { display: \"none\" } : {}}\r\n        >\r\n          <span className=\"icon-dropdown next-chapter-single\"></span>\r\n        </div>\r\n        <div\r\n          className=\"reader-setting-icon-container\"\r\n          onClick={() => {\r\n            this.handleEnterReader(\"left\");\r\n            this.handleEnterReader(\"right\");\r\n            this.handleEnterReader(\"bottom\");\r\n            this.handleEnterReader(\"top\");\r\n          }}\r\n          style={isMobile ? { display: \"none\" } : {}}\r\n        >\r\n          <span className=\"icon-grid reader-setting-icon\"></span>\r\n        </div>\r\n        {this.state.isMessage ? <MessageBox /> : null}\r\n        <div\r\n          className=\"left-panel\"\r\n          onMouseEnter={() => {\r\n            if (this.state.isTouch || this.state.isOpenNavPanel || isMobile) {\r\n              return;\r\n            }\r\n            this.handleEnterReader(\"left\");\r\n          }}\r\n          onClick={() => {\r\n            this.handleEnterReader(\"left\");\r\n          }}\r\n        ></div>\r\n        <div\r\n          className=\"right-panel\"\r\n          onMouseEnter={() => {\r\n            if (\r\n              this.state.isTouch ||\r\n              this.state.isOpenSettingPanel ||\r\n              isMobile\r\n            ) {\r\n              return;\r\n            }\r\n            this.handleEnterReader(\"right\");\r\n          }}\r\n          onClick={() => {\r\n            this.handleEnterReader(\"right\");\r\n          }}\r\n        ></div>\r\n        <div\r\n          className=\"top-panel\"\r\n          onMouseEnter={() => {\r\n            if (\r\n              this.state.isTouch ||\r\n              this.state.isOpenOperationPanel ||\r\n              isMobile\r\n            ) {\r\n              return;\r\n            }\r\n            this.handleEnterReader(\"top\");\r\n          }}\r\n          onClick={() => {\r\n            this.handleEnterReader(\"top\");\r\n          }}\r\n        ></div>\r\n        <div\r\n          className=\"bottom-panel\"\r\n          onMouseEnter={() => {\r\n            if (\r\n              this.state.isTouch ||\r\n              this.state.isOpenProgressPanel ||\r\n              isMobile\r\n            ) {\r\n              return;\r\n            }\r\n            this.handleEnterReader(\"bottom\");\r\n          }}\r\n          onClick={() => {\r\n            this.handleEnterReader(\"bottom\");\r\n          }}\r\n        ></div>\r\n\r\n        {this.state.rendition && this.props.currentEpub.rendition && (\r\n          <ViewArea {...renditionProps} />\r\n        )}\r\n        <div\r\n          className=\"setting-panel-container\"\r\n          onMouseLeave={(event) => {\r\n            this.handleLeaveReader(\"right\");\r\n          }}\r\n          style={\r\n            this.state.isOpenSettingPanel\r\n              ? {}\r\n              : {\r\n                  transform: \"translateX(309px)\",\r\n                  transition: \"transform 1s ease\",\r\n                  display: \"none\",\r\n                }\r\n          }\r\n        >\r\n          <SettingPanel />\r\n        </div>\r\n        <div\r\n          className=\"navigation-panel-container\"\r\n          onMouseLeave={(event) => {\r\n            this.handleLeaveReader(\"left\");\r\n          }}\r\n          style={\r\n            this.state.isOpenNavPanel\r\n              ? {}\r\n              : {\r\n                  transform: \"translateX(-309px)\",\r\n                  transition: \"transform 1s ease\",\r\n                  display: \"none\",\r\n                }\r\n          }\r\n        >\r\n          <NavigationPanel {...{ time: this.state.time }} />\r\n        </div>\r\n        <div\r\n          className=\"progress-panel-container\"\r\n          onMouseLeave={(event) => {\r\n            this.handleLeaveReader(\"bottom\");\r\n          }}\r\n          style={\r\n            this.state.isOpenProgressPanel\r\n              ? {}\r\n              : {\r\n                  transform: \"translateY(110px)\",\r\n                  transition: \"transform 0.5s ease\",\r\n                  display: \"none\",\r\n                }\r\n          }\r\n        >\r\n          <ProgressPanel {...{ time: this.state.time }} />\r\n        </div>\r\n        <div\r\n          className=\"operation-panel-container\"\r\n          onMouseLeave={(event) => {\r\n            this.handleLeaveReader(\"top\");\r\n          }}\r\n          style={\r\n            this.state.isOpenOperationPanel\r\n              ? {}\r\n              : {\r\n                  transform: \"translateY(-110px)\",\r\n                  transition: \"transform 0.5s ease\",\r\n                  display: \"none\",\r\n                }\r\n          }\r\n        >\r\n          <OperationPanel {...{ time: this.state.time }} />\r\n        </div>\r\n\r\n        <div\r\n          className=\"view-area-page\"\r\n          id=\"page-area\"\r\n          style={\r\n            document.body.clientWidth < 570\r\n              ? { left: 0, right: 0 }\r\n              : this.state.readerMode === \"continuous\"\r\n              ? {\r\n                  left: `calc(50vw - ${270 * parseFloat(this.state.scale)}px)`,\r\n                  right: `calc(50vw - ${270 * parseFloat(this.state.scale)}px)`,\r\n                  top: \"75px\",\r\n                  bottom: \"75px\",\r\n                }\r\n              : this.state.readerMode === \"single\"\r\n              ? {\r\n                  left: `calc(50vw - ${270 * parseFloat(this.state.scale)}px)`,\r\n                  right: `calc(50vw - ${270 * parseFloat(this.state.scale)}px)`,\r\n                }\r\n              : this.state.readerMode === \"double\"\r\n              ? {\r\n                  left: this.state.margin + \"px\",\r\n                  right: this.state.margin + \"px\",\r\n                }\r\n              : {}\r\n          }\r\n        ></div>\r\n\r\n        <Background {...{ time: this.state.time }} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Reader;\r\n","import {\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleFetchChapters,\r\n} from \"../../store/actions/reader\";\r\nimport { handleFetchPercentage } from \"../../store/actions/progressPanel\";\r\nimport {\r\n  handleMessageBox,\r\n  handleFetchBooks,\r\n} from \"../../store/actions/manager\";\r\nimport \"./epubViewer.css\";\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport Reader from \"./component\";\r\nimport { withNamespaces } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentEpub: state.book.currentEpub,\r\n    currentBook: state.book.currentBook,\r\n    isMessage: state.manager.isMessage,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleFetchChapters,\r\n  handleMessageBox,\r\n  handleFetchPercentage,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withNamespaces()(Reader as any));\r\n","//卡片模式下的图书显示\r\nimport React from \"react\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\n// import \"./bookCardItem.css\";\r\nimport { EpubReaderProps, EpubReaderState } from \"./interface\";\r\nimport localforage from \"localforage\";\r\nimport Reader from \"../../containers/epubViewer\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport _ from \"underscore\";\r\nimport BookUtil from \"../../utils/bookUtil\";\r\n\r\ndeclare var window: any;\r\n\r\nclass EpubReader extends React.Component<EpubReaderProps, EpubReaderState> {\r\n  epub: any;\r\n  constructor(props: EpubReaderProps) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n\r\n  componentWillMount() {\r\n    let url = document.location.href.split(\"/\");\r\n    let key = url[url.length - 1];\r\n\r\n    localforage.getItem(\"books\").then((result: any) => {\r\n      let book = result[_.findIndex(result, { key })];\r\n      BookUtil.fetchBook(key).then((result) => {\r\n        this.props.handleReadingBook(book);\r\n        this.props.handleReadingEpub(window.ePub(result, {}));\r\n        this.props.handleReadingState(true);\r\n        RecentBooks.setRecent(key);\r\n      });\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (!this.props.isReading) {\r\n      return (\r\n        <div className=\"spinner\">\r\n          <div className=\"sk-chase\">\r\n            <div className=\"sk-chase-dot\"></div>\r\n            <div className=\"sk-chase-dot\"></div>\r\n            <div className=\"sk-chase-dot\"></div>\r\n            <div className=\"sk-chase-dot\"></div>\r\n            <div className=\"sk-chase-dot\"></div>\r\n            <div className=\"sk-chase-dot\"></div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    return <Reader />;\r\n  }\r\n}\r\nexport default withRouter(EpubReader);\r\n","//卡片模式下的图书显示\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  handleActionDialog,\r\n  handleReadingState,\r\n  handleReadingBook,\r\n  handleReadingEpub,\r\n} from \"../../store/actions/book\";\r\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\r\nimport Book from \"./component\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isOpenActionDialog: state.book.isOpenActionDialog,\r\n    currentBook: state.book.currentBook,\r\n    isReading: state.book.isReading,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingState,\r\n  handleReadingBook,\r\n  handleReadingEpub,\r\n  handleActionDialog,\r\n  handleMessageBox,\r\n  handleMessage,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(Book);\r\n","import React from \"react\";\r\nimport \"./manager.css\";\r\nimport { RedirectProps, RedirectState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { getParamsFromUrl } from \"../../utils/syncUtils/common\";\r\nimport copy from \"copy-text-to-clipboard\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { isMobile } from \"react-device-detect\";\r\nimport OtherUtil from \"../../utils/otherUtil\";\r\nimport DropboxUtil from \"../../utils/syncUtils/dropbox\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationSuccess from \"../../assets/success.json\";\r\n\r\nconst successOptions = {\r\n  loop: false,\r\n  autoplay: true,\r\n  animationData: animationSuccess,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\n\r\ndeclare var window: any;\r\n\r\nclass Redirect extends React.Component<RedirectProps, RedirectState> {\r\n  timer!: NodeJS.Timeout;\r\n  constructor(props: RedirectProps) {\r\n    super(props);\r\n    this.state = {\r\n      isAuthed: false,\r\n      isError: false,\r\n      isCopied: false,\r\n      token: \"\",\r\n    };\r\n  }\r\n  handleFinish = () => {\r\n    this.props.handleLoadingDialog(false);\r\n    alert(\"数据恢复成功\");\r\n  };\r\n  showMessage = (message: string) => {\r\n    this.props.handleMessage(message);\r\n    this.props.handleMessageBox(true);\r\n  };\r\n  componentDidMount() {\r\n    //判断是否是获取token后的回调页面\r\n    let url = document.location.href;\r\n    if (document.location.hash === \"#/\") {\r\n      this.props.history.push(\"/manager/home\");\r\n    }\r\n    if (url.indexOf(\"error\") > -1) {\r\n      this.setState({ isError: true });\r\n      return false;\r\n    }\r\n    if (url.indexOf(\"code\") > -1) {\r\n      let params: any = getParamsFromUrl();\r\n      this.setState({ token: params.code });\r\n      this.setState({ isAuthed: true });\r\n      return false;\r\n    }\r\n    if (url.indexOf(\"access_token\") > -1) {\r\n      let params: any = getParamsFromUrl();\r\n      this.setState({ token: params.access_token });\r\n      this.setState({ isAuthed: true });\r\n      if (isMobile) {\r\n        OtherUtil.setReaderConfig(`dropbox_token`, params.access_token);\r\n        DropboxUtil.DownloadFile(\r\n          (mobileData) => {\r\n            window.ReactNativeWebView.postMessage(mobileData);\r\n          },\r\n          () => {}\r\n        );\r\n      }\r\n      return false;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.isError || this.state.isAuthed) {\r\n      return (\r\n        <div className=\"backup-page-finish-container\">\r\n          <div className=\"backup-page-finish\">\r\n            {this.state.isAuthed ? (\r\n              <Lottie options={successOptions} height={80} width={80} />\r\n            ) : (\r\n              <span className=\"icon-close auth-page-close-icon\"></span>\r\n            )}\r\n\r\n            <div className=\"backup-page-finish-text\">\r\n              <Trans>\r\n                {this.state.isAuthed\r\n                  ? \"Authorize Successfully\"\r\n                  : \"Authorize Failed\"}\r\n              </Trans>\r\n            </div>\r\n            {this.state.isAuthed ? (\r\n              <div\r\n                className=\"token-dialog-token-text\"\r\n                onClick={() => {\r\n                  copy(this.state.token);\r\n                  this.setState({ isCopied: true });\r\n                }}\r\n              >\r\n                {this.state.isCopied ? (\r\n                  <Trans>Copied</Trans>\r\n                ) : (\r\n                  <Trans>Copy Token</Trans>\r\n                )}\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"manager\">\r\n        <img\r\n          src={\r\n            process.env.NODE_ENV === \"production\"\r\n              ? \"./assets/logo.png\"\r\n              : \"../../assets/logo.png\"\r\n          }\r\n          alt=\"\"\r\n          className=\"logo\"\r\n        />\r\n        <div className=\"empty-page-info-container\" style={{ margin: 100 }}>\r\n          <div className=\"empty-page-info-main\">\r\n            <Trans>It seems like you're lost</Trans>\r\n          </div>\r\n          <div\r\n            className=\"empty-page-info-sub\"\r\n            onClick={() => {\r\n              this.props.history.push(\"/manager/home\");\r\n            }}\r\n            style={{ marginTop: 10, cursor: \"pointer\" }}\r\n          >\r\n            <Trans>Return to home</Trans>\r\n          </div>\r\n        </div>\r\n        <img\r\n          src={\r\n            process.env.NODE_ENV === \"production\"\r\n              ? \"./assets/empty.svg\"\r\n              : \"../../assets/empty.svg\"\r\n          }\r\n          alt=\"\"\r\n          className=\"empty-page-illustration\"\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Redirect);\r\n","import { connect } from \"react-redux\";\r\nimport \"./manager.css\";\r\nimport { stateType } from \"../../store\";\r\nimport {\r\n  handleMessageBox,\r\n  handleMessage,\r\n  handleLoadingDialog,\r\n} from \"../../store/actions/manager\";\r\nimport Redirect from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {};\r\n};\r\nconst actionCreator = { handleMessageBox, handleMessage, handleLoadingDialog };\r\nexport default connect(mapStateToProps, actionCreator)(Redirect);\r\n","import { hot } from \"react-hot-loader/root\";\r\nimport React, { useEffect } from \"react\";\r\nimport { Route, Switch, HashRouter } from \"react-router-dom\";\r\nimport Manager from \"../pages/manager\";\r\nimport EpubReader from \"../pages/epubReader\";\r\nimport _Redirect from \"../pages/redirect\";\r\nimport i18n from \"../i18n\";\r\nimport OtherUtil from \"../utils/otherUtil\";\r\n\r\nconst Router = () => {\r\n  useEffect(() => {\r\n    const lng = OtherUtil.getReaderConfig(\"lang\");\r\n    if (lng) {\r\n      i18n.changeLanguage(lng);\r\n    } else {\r\n      if (navigator.language === \"zh-CN\" || navigator.language === \"zh-SG\") {\r\n        i18n.changeLanguage(\"zh\");\r\n      } else if (\r\n        navigator.language === \"zh-TW\" ||\r\n        navigator.language === \"zh-HK\"\r\n      ) {\r\n        i18n.changeLanguage(\"cht\");\r\n      } else {\r\n        i18n.changeLanguage(\"en\");\r\n      }\r\n    }\r\n  }, []);\r\n  return (\r\n    <HashRouter>\r\n      <Switch>\r\n        <Route component={Manager} path=\"/manager\" />\r\n        <Route component={EpubReader} path=\"/epub\" />\r\n        <Route component={_Redirect} path=\"/\" />\r\n      </Switch>\r\n    </HashRouter>\r\n  );\r\n};\r\n\r\nexport default hot(Router);\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n// import App from \"./App\";\r\nimport \"./assets/styles/reset.css\";\r\nimport \"./assets/styles/global.css\";\r\nimport \"./assets/styles/style.css\";\r\nimport { Provider } from \"react-redux\";\r\nimport \"./i18n\";\r\nimport store from \"./store\";\r\nimport Router from \"./router/index\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <Router />\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}